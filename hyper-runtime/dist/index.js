var aW=Object.defineProperty;var J0=(H,D)=>{for(var W in D)aW(H,W,{get:D[W],enumerable:!0,configurable:!0,set:(h)=>D[W]=()=>h})};var sW={};J0(sW,{studioTheme:()=>dH,injectThemeVariables:()=>vH,createControls:()=>cD,createControlPanel:()=>lD,HypertoolControls:()=>qH});/*! Tweakpane 4.0.5 (c) 2016 cocopon, licensed under the MIT license. */function N(H){return H}function L(H){return H===null||H===void 0}function jD(H){return H!==null&&typeof H==="object"}function LD(H){return H!==null&&typeof H==="object"}function eW(H,D){if(H.length!==D.length)return!1;for(let W=0;W<H.length;W++)if(H[W]!==D[W])return!1;return!0}function hH(H,D){return Array.from(new Set([...Object.keys(H),...Object.keys(D)])).reduce((h,U)=>{let q=H[U],X=D[U];return LD(q)&&LD(X)?Object.assign(Object.assign({},h),{[U]:hH(q,X)}):Object.assign(Object.assign({},h),{[U]:U in D?X:q})},{})}function SD(H){if(!jD(H))return!1;return"target"in H}var H5={alreadydisposed:()=>"View has been already disposed",invalidparams:(H)=>`Invalid parameters for '${H.name}'`,nomatchingcontroller:(H)=>`No matching controller for '${H.key}'`,nomatchingview:(H)=>`No matching view for '${JSON.stringify(H.params)}'`,notbindable:()=>"Value is not bindable",notcompatible:(H)=>`Not compatible with  plugin '${H.id}'`,propertynotfound:(H)=>`Property '${H.name}' not found`,shouldneverhappen:()=>"This error should never happen"};class ${static alreadyDisposed(){return new $({type:"alreadydisposed"})}static notBindable(){return new $({type:"notbindable"})}static notCompatible(H,D){return new $({type:"notcompatible",context:{id:`${H}.${D}`}})}static propertyNotFound(H){return new $({type:"propertynotfound",context:{name:H}})}static shouldNeverHappen(){return new $({type:"shouldneverhappen"})}constructor(H){var D;this.message=(D=H5[H.type](N(H.context)))!==null&&D!==void 0?D:"Unexpected error",this.name=this.constructor.name,this.stack=new Error(this.message).stack,this.type=H.type}toString(){return this.message}}class gH{constructor(H,D){this.obj_=H,this.key=D}static isBindable(H){if(H===null)return!1;if(typeof H!=="object"&&typeof H!=="function")return!1;return!0}read(){return this.obj_[this.key]}write(H){this.obj_[this.key]=H}writeProperty(H,D){let W=this.read();if(!gH.isBindable(W))throw $.notBindable();if(!(H in W))throw $.propertyNotFound(H);W[H]=D}}class M{constructor(){this.observers_={}}on(H,D,W){var h;let U=this.observers_[H];if(!U)U=this.observers_[H]=[];return U.push({handler:D,key:(h=W===null||W===void 0?void 0:W.key)!==null&&h!==void 0?h:D}),this}off(H,D){let W=this.observers_[H];if(W)this.observers_[H]=W.filter((h)=>{return h.key!==D});return this}emit(H,D){let W=this.observers_[H];if(!W)return;W.forEach((h)=>{h.handler(D)})}}class E0{constructor(H,D){var W;this.constraint_=D===null||D===void 0?void 0:D.constraint,this.equals_=(W=D===null||D===void 0?void 0:D.equals)!==null&&W!==void 0?W:(h,U)=>h===U,this.emitter=new M,this.rawValue_=H}get constraint(){return this.constraint_}get rawValue(){return this.rawValue_}set rawValue(H){this.setRawValue(H,{forceEmit:!1,last:!0})}setRawValue(H,D){let W=D!==null&&D!==void 0?D:{forceEmit:!1,last:!0},h=this.constraint_?this.constraint_.constrain(H):H,U=this.rawValue_;if(!!this.equals_(U,h)&&!W.forceEmit)return;this.emitter.emit("beforechange",{sender:this}),this.rawValue_=h,this.emitter.emit("change",{options:W,previousRawValue:U,rawValue:h,sender:this})}}class _0{constructor(H){this.emitter=new M,this.value_=H}get rawValue(){return this.value_}set rawValue(H){this.setRawValue(H,{forceEmit:!1,last:!0})}setRawValue(H,D){let W=D!==null&&D!==void 0?D:{forceEmit:!1,last:!0},h=this.value_;if(h===H&&!W.forceEmit)return;this.emitter.emit("beforechange",{sender:this}),this.value_=H,this.emitter.emit("change",{options:W,previousRawValue:h,rawValue:this.value_,sender:this})}}class C0{constructor(H){this.emitter=new M,this.onValueBeforeChange_=this.onValueBeforeChange_.bind(this),this.onValueChange_=this.onValueChange_.bind(this),this.value_=H,this.value_.emitter.on("beforechange",this.onValueBeforeChange_),this.value_.emitter.on("change",this.onValueChange_)}get rawValue(){return this.value_.rawValue}onValueBeforeChange_(H){this.emitter.emit("beforechange",Object.assign(Object.assign({},H),{sender:this}))}onValueChange_(H){this.emitter.emit("change",Object.assign(Object.assign({},H),{sender:this}))}}function w(H,D){let W=D===null||D===void 0?void 0:D.constraint,h=D===null||D===void 0?void 0:D.equals;if(!W&&!h)return new _0(H);return new E0(H,D)}function D5(H){return[new C0(H),(D,W)=>{H.setRawValue(D,W)}]}class z{constructor(H){this.emitter=new M,this.valMap_=H;for(let D in this.valMap_)this.valMap_[D].emitter.on("change",()=>{this.emitter.emit("change",{key:D,sender:this})})}static createCore(H){return Object.keys(H).reduce((W,h)=>{return Object.assign(W,{[h]:w(H[h])})},{})}static fromObject(H){let D=this.createCore(H);return new z(D)}get(H){return this.valMap_[H].rawValue}set(H,D){this.valMap_[H].rawValue=D}value(H){return this.valMap_[H]}}class OH{constructor(H){this.values=z.fromObject({max:H.max,min:H.min})}constrain(H){let D=this.values.get("max"),W=this.values.get("min");return Math.min(Math.max(H,W),D)}}class x0{constructor(H){this.values=z.fromObject({max:H.max,min:H.min})}constrain(H){let D=this.values.get("max"),W=this.values.get("min"),h=H;if(!L(W))h=Math.max(h,W);if(!L(D))h=Math.min(h,D);return h}}class b0{constructor(H,D=0){this.step=H,this.origin=D}constrain(H){let D=this.origin%this.step,W=Math.round((H-D)/this.step);return D+W*this.step}}class f0{constructor(H){this.text=H}evaluate(){return Number(this.text)}toString(){return this.text}}var W5={"**":(H,D)=>Math.pow(H,D),"*":(H,D)=>H*D,"/":(H,D)=>H/D,"%":(H,D)=>H%D,"+":(H,D)=>H+D,"-":(H,D)=>H-D,"<<":(H,D)=>H<<D,">>":(H,D)=>H>>D,">>>":(H,D)=>H>>>D,"&":(H,D)=>H&D,"^":(H,D)=>H^D,"|":(H,D)=>H|D};class d0{constructor(H,D,W){this.left=D,this.operator=H,this.right=W}evaluate(){let H=W5[this.operator];if(!H)throw new Error(`unexpected binary operator: '${this.operator}`);return H(this.left.evaluate(),this.right.evaluate())}toString(){return["b(",this.left.toString(),this.operator,this.right.toString(),")"].join(" ")}}var h5={"+":(H)=>H,"-":(H)=>-H,"~":(H)=>~H};class v0{constructor(H,D){this.operator=H,this.expression=D}evaluate(){let H=h5[this.operator];if(!H)throw new Error(`unexpected unary operator: '${this.operator}`);return H(this.expression.evaluate())}toString(){return["u(",this.operator,this.expression.toString(),")"].join(" ")}}function RD(H){return(D,W)=>{for(let h=0;h<H.length;h++){let U=H[h](D,W);if(U!=="")return U}return""}}function RH(H,D){var W;let h=H.substr(D).match(/^\s+/);return(W=h&&h[0])!==null&&W!==void 0?W:""}function U5(H,D){let W=H.substr(D,1);return W.match(/^[1-9]$/)?W:""}function NH(H,D){var W;let h=H.substr(D).match(/^[0-9]+/);return(W=h&&h[0])!==null&&W!==void 0?W:""}function q5(H,D){let W=NH(H,D);if(W!=="")return W;let h=H.substr(D,1);if(D+=1,h!=="-"&&h!=="+")return"";let U=NH(H,D);if(U==="")return"";return h+U}function ND(H,D){let W=H.substr(D,1);if(D+=1,W.toLowerCase()!=="e")return"";let h=q5(H,D);if(h==="")return"";return W+h}function u0(H,D){let W=H.substr(D,1);if(W==="0")return W;let h=U5(H,D);if(D+=h.length,h==="")return"";return h+NH(H,D)}function X5(H,D){let W=u0(H,D);if(D+=W.length,W==="")return"";let h=H.substr(D,1);if(D+=h.length,h!==".")return"";let U=NH(H,D);return D+=U.length,W+h+U+ND(H,D)}function J5(H,D){let W=H.substr(D,1);if(D+=W.length,W!==".")return"";let h=NH(H,D);if(D+=h.length,h==="")return"";return W+h+ND(H,D)}function Q5(H,D){let W=u0(H,D);if(D+=W.length,W==="")return"";return W+ND(H,D)}var Z5=RD([X5,J5,Q5]);function Y5(H,D){var W;let h=H.substr(D).match(/^[01]+/);return(W=h&&h[0])!==null&&W!==void 0?W:""}function z5(H,D){let W=H.substr(D,2);if(D+=W.length,W.toLowerCase()!=="0b")return"";let h=Y5(H,D);if(h==="")return"";return W+h}function O5(H,D){var W;let h=H.substr(D).match(/^[0-7]+/);return(W=h&&h[0])!==null&&W!==void 0?W:""}function G5(H,D){let W=H.substr(D,2);if(D+=W.length,W.toLowerCase()!=="0o")return"";let h=O5(H,D);if(h==="")return"";return W+h}function K5(H,D){var W;let h=H.substr(D).match(/^[0-9a-f]+/i);return(W=h&&h[0])!==null&&W!==void 0?W:""}function F5(H,D){let W=H.substr(D,2);if(D+=W.length,W.toLowerCase()!=="0x")return"";let h=K5(H,D);if(h==="")return"";return W+h}var L5=RD([z5,G5,F5]),w5=RD([L5,Z5]);function I5(H,D){let W=w5(H,D);if(D+=W.length,W==="")return null;return{evaluable:new f0(W),cursor:D}}function $5(H,D){let W=H.substr(D,1);if(D+=W.length,W!=="(")return null;let h=i0(H,D);if(!h)return null;D=h.cursor,D+=RH(H,D).length;let U=H.substr(D,1);if(D+=U.length,U!==")")return null;return{evaluable:h.evaluable,cursor:D}}function M5(H,D){var W;return(W=I5(H,D))!==null&&W!==void 0?W:$5(H,D)}function m0(H,D){let W=M5(H,D);if(W)return W;let h=H.substr(D,1);if(D+=h.length,h!=="+"&&h!=="-"&&h!=="~")return null;let U=m0(H,D);if(!U)return null;return D=U.cursor,{cursor:D,evaluable:new v0(h,U.evaluable)}}function A5(H,D,W){W+=RH(D,W).length;let h=H.filter((U)=>D.startsWith(U,W))[0];if(!h)return null;return W+=h.length,W+=RH(D,W).length,{cursor:W,operator:h}}function B5(H,D){return(W,h)=>{let U=H(W,h);if(!U)return null;h=U.cursor;let q=U.evaluable;for(;;){let X=A5(D,W,h);if(!X)break;h=X.cursor;let J=H(W,h);if(!J)return null;h=J.cursor,q=new d0(X.operator,q,J.evaluable)}return q?{cursor:h,evaluable:q}:null}}var y5=[["**"],["*","/","%"],["+","-"],["<<",">>>",">>"],["&"],["^"],["|"]].reduce((H,D)=>{return B5(H,D)},m0);function i0(H,D){return D+=RH(H,D).length,y5(H,D)}function j5(H){let D=i0(H,0);if(!D)return null;if(D.cursor+RH(H,D.cursor).length!==H.length)return null;return D.evaluable}function m(H){var D;let W=j5(H);return(D=W===null||W===void 0?void 0:W.evaluate())!==null&&D!==void 0?D:null}function g0(H){if(typeof H==="number")return H;if(typeof H==="string"){let D=m(H);if(!L(D))return D}return 0}function S5(H){return String(H)}function R(H){return(D)=>{return D.toFixed(Math.max(Math.min(H,20),0))}}function F(H,D,W,h,U){let q=(H-D)/(W-D);return h+q*(U-h)}function Q0(H){return String(H.toFixed(10)).split(".")[1].replace(/0+$/,"").length}function B(H,D,W){return Math.min(Math.max(H,D),W)}function t0(H,D){return(H%D+D)%D}function R5(H,D){return!L(H.step)?Q0(H.step):Math.max(Q0(D),2)}function p0(H){var D;return(D=H.step)!==null&&D!==void 0?D:1}function s0(H,D){var W;let h=Math.abs((W=H.step)!==null&&W!==void 0?W:D);return h===0?0.1:Math.pow(10,Math.floor(Math.log10(h))-1)}function n0(H,D){if(!L(H.step))return new b0(H.step,D);return null}function c0(H){if(!L(H.max)&&!L(H.min))return new OH({max:H.max,min:H.min});if(!L(H.max)||!L(H.min))return new x0({max:H.max,min:H.min});return null}function l0(H,D){var W,h,U;return{formatter:(W=H.format)!==null&&W!==void 0?W:R(R5(H,D)),keyScale:(h=H.keyScale)!==null&&h!==void 0?h:p0(H),pointerScale:(U=H.pointerScale)!==null&&U!==void 0?U:s0(H,D)}}function r0(H){return{format:H.optional.function,keyScale:H.optional.number,max:H.optional.number,min:H.optional.number,pointerScale:H.optional.number,step:H.optional.number}}function kD(H){return{constraint:H.constraint,textProps:z.fromObject(l0(H.params,H.initialValue))}}class r{constructor(H){this.controller=H}get element(){return this.controller.view.element}get disabled(){return this.controller.viewProps.get("disabled")}set disabled(H){this.controller.viewProps.set("disabled",H)}get hidden(){return this.controller.viewProps.get("hidden")}set hidden(H){this.controller.viewProps.set("hidden",H)}dispose(){this.controller.viewProps.set("disposed",!0)}importState(H){return this.controller.importState(H)}exportState(){return this.controller.exportState()}}class VH{constructor(H){this.target=H}}class GH extends VH{constructor(H,D,W){super(H);this.value=D,this.last=W!==null&&W!==void 0?W:!0}}class o0 extends VH{constructor(H,D){super(H);this.expanded=D}}class a0 extends VH{constructor(H,D){super(H);this.index=D}}class e0 extends VH{constructor(H,D){super(H);this.native=D}}class ZH extends r{constructor(H){super(H);this.onValueChange_=this.onValueChange_.bind(this),this.emitter_=new M,this.controller.value.emitter.on("change",this.onValueChange_)}get label(){return this.controller.labelController.props.get("label")}set label(H){this.controller.labelController.props.set("label",H)}get key(){return this.controller.value.binding.target.key}get tag(){return this.controller.tag}set tag(H){this.controller.tag=H}on(H,D){let W=D.bind(this);return this.emitter_.on(H,(h)=>{W(h)},{key:D}),this}off(H,D){return this.emitter_.off(H,D),this}refresh(){this.controller.value.fetch()}onValueChange_(H){let D=this.controller.value;this.emitter_.emit("change",new GH(this,N(D.binding.target.read()),H.options.last))}}class H1{constructor(H,D){this.onValueBeforeChange_=this.onValueBeforeChange_.bind(this),this.onValueChange_=this.onValueChange_.bind(this),this.binding=D,this.value_=H,this.value_.emitter.on("beforechange",this.onValueBeforeChange_),this.value_.emitter.on("change",this.onValueChange_),this.emitter=new M}get rawValue(){return this.value_.rawValue}set rawValue(H){this.value_.rawValue=H}setRawValue(H,D){this.value_.setRawValue(H,D)}fetch(){this.value_.rawValue=this.binding.read()}push(){this.binding.write(this.value_.rawValue)}onValueBeforeChange_(H){this.emitter.emit("beforechange",Object.assign(Object.assign({},H),{sender:this}))}onValueChange_(H){this.push(),this.emitter.emit("change",Object.assign(Object.assign({},H),{sender:this}))}}function N5(H){if(!("binding"in H))return!1;let D=H.binding;return SD(D)&&"read"in D&&"write"in D}function k5(H,D){let h=Object.keys(D).reduce((U,q)=>{if(U===void 0)return;let X=D[q],J=X(H[q]);return J.succeeded?Object.assign(Object.assign({},U),{[q]:J.value}):void 0},{});return N(h)}function T5(H,D){return H.reduce((W,h)=>{if(W===void 0)return;let U=D(h);if(!U.succeeded||U.value===void 0)return;return[...W,U.value]},[])}function P5(H){if(H===null)return!1;return typeof H==="object"}function f(H){return(D)=>(W)=>{if(!D&&W===void 0)return{succeeded:!1,value:void 0};if(D&&W===void 0)return{succeeded:!0,value:void 0};let h=H(W);return h!==void 0?{succeeded:!0,value:h}:{succeeded:!1,value:void 0}}}function Z0(H){return{custom:(D)=>f(D)(H),boolean:f((D)=>typeof D==="boolean"?D:void 0)(H),number:f((D)=>typeof D==="number"?D:void 0)(H),string:f((D)=>typeof D==="string"?D:void 0)(H),function:f((D)=>typeof D==="function"?D:void 0)(H),constant:(D)=>f((W)=>W===D?D:void 0)(H),raw:f((D)=>D)(H),object:(D)=>f((W)=>{if(!P5(W))return;return k5(W,D)})(H),array:(D)=>f((W)=>{if(!Array.isArray(W))return;return T5(W,D)})(H)}}var wD={optional:Z0(!0),required:Z0(!1)};function I(H,D){let W=D(wD),h=wD.required.object(W)(H);return h.succeeded?h.value:void 0}function k(H,D,W,h){if(D&&!D(H))return!1;let U=I(H,W);return U?h(U):!1}function T(H,D){var W;return hH((W=H===null||H===void 0?void 0:H())!==null&&W!==void 0?W:{},D)}function HH(H){return"value"in H}function D1(H){if(!jD(H)||!("binding"in H))return!1;let D=H.binding;return SD(D)}var _="http://www.w3.org/2000/svg";function tH(H){H.offsetHeight}function V5(H,D){let W=H.style.transition;H.style.transition="none",D(),H.style.transition=W}function TD(H){return H.ontouchstart!==void 0}function E5(){return globalThis}function _5(){return N(E5()).document}function C5(H){let D=H.ownerDocument.defaultView;if(!D)return null;return"document"in D?H.getContext("2d",{willReadFrequently:!0}):null}var x5={check:'<path d="M2 8l4 4l8 -8"/>',dropdown:'<path d="M5 7h6l-3 3 z"/>',p2dpad:'<path d="M8 4v8"/><path d="M4 8h8"/><circle cx="12" cy="12" r="1.2"/>'};function lH(H,D){let W=H.createElementNS(_,"svg");return W.innerHTML=x5[D],W}function W1(H,D,W){H.insertBefore(D,H.children[W])}function PD(H){if(H.parentElement)H.parentElement.removeChild(H)}function h1(H){while(H.children.length>0)H.removeChild(H.children[0])}function b5(H){while(H.childNodes.length>0)H.removeChild(H.childNodes[0])}function U1(H){if(H.relatedTarget)return N(H.relatedTarget);if("explicitOriginalTarget"in H)return H.explicitOriginalTarget;return null}function v(H,D){H.emitter.on("change",(W)=>{D(W.rawValue)}),D(H.rawValue)}function C(H,D,W){v(H.value(D),W)}var f5="tp";function G(H){return(W,h)=>{return[f5,"-",H,"v",W?`_${W}`:"",h?`-${h}`:""].join("")}}var BH=G("lbl");function d5(H,D){let W=H.createDocumentFragment();return D.split(`
`).map((U)=>{return H.createTextNode(U)}).forEach((U,q)=>{if(q>0)W.appendChild(H.createElement("br"));W.appendChild(U)}),W}class VD{constructor(H,D){this.element=H.createElement("div"),this.element.classList.add(BH()),D.viewProps.bindClassModifiers(this.element);let W=H.createElement("div");W.classList.add(BH("l")),C(D.props,"label",(U)=>{if(L(U))this.element.classList.add(BH(void 0,"nol"));else this.element.classList.remove(BH(void 0,"nol")),b5(W),W.appendChild(d5(H,U))}),this.element.appendChild(W),this.labelElement=W;let h=H.createElement("div");h.classList.add(BH("v")),this.element.appendChild(h),this.valueElement=h}}class ED{constructor(H,D){this.props=D.props,this.valueController=D.valueController,this.viewProps=D.valueController.viewProps,this.view=new VD(H,{props:D.props,viewProps:this.viewProps}),this.view.valueElement.appendChild(this.valueController.view.element)}importProps(H){return k(H,null,(D)=>({label:D.optional.string}),(D)=>{return this.props.set("label",D.label),!0})}exportProps(){return T(null,{label:this.props.get("label")})}}function v5(){return["veryfirst","first","last","verylast"]}var Y0=G(""),z0={veryfirst:"vfst",first:"fst",last:"lst",verylast:"vlst"};class EH{constructor(H){this.parent_=null,this.blade=H.blade,this.view=H.view,this.viewProps=H.viewProps;let D=this.view.element;this.blade.value("positions").emitter.on("change",()=>{v5().forEach((W)=>{D.classList.remove(Y0(void 0,z0[W]))}),this.blade.get("positions").forEach((W)=>{D.classList.add(Y0(void 0,z0[W]))})}),this.viewProps.handleDispose(()=>{PD(D)})}get parent(){return this.parent_}set parent(H){this.parent_=H,this.viewProps.set("parent",this.parent_?this.parent_.viewProps:null)}importState(H){return k(H,null,(D)=>({disabled:D.required.boolean,hidden:D.required.boolean}),(D)=>{return this.viewProps.importState(D),!0})}exportState(){return T(null,Object.assign({},this.viewProps.exportState()))}}class l extends EH{constructor(H,D){if(D.value!==D.valueController.value)throw $.shouldNeverHappen();let W=D.valueController.viewProps,h=new ED(H,{blade:D.blade,props:D.props,valueController:D.valueController});super(Object.assign(Object.assign({},D),{view:new VD(H,{props:D.props,viewProps:W}),viewProps:W}));this.labelController=h,this.value=D.value,this.valueController=D.valueController,this.view.valueElement.appendChild(this.valueController.view.element)}importState(H){return k(H,(D)=>{var W,h,U;return super.importState(D)&&this.labelController.importProps(D)&&((U=(h=(W=this.valueController).importProps)===null||h===void 0?void 0:h.call(W,H))!==null&&U!==void 0?U:!0)},(D)=>({value:D.optional.raw}),(D)=>{if(D.value)this.value.rawValue=D.value;return!0})}exportState(){var H,D,W;return T(()=>super.exportState(),Object.assign(Object.assign({value:this.value.rawValue},this.labelController.exportProps()),(W=(D=(H=this.valueController).exportProps)===null||D===void 0?void 0:D.call(H))!==null&&W!==void 0?W:{}))}}function O0(H){let D=Object.assign({},H);return delete D.value,D}class _D extends l{constructor(H,D){super(H,D);this.tag=D.tag}importState(H){return k(H,(D)=>super.importState(O0(H)),(D)=>({tag:D.optional.string}),(D)=>{return this.tag=D.tag,!0})}exportState(){return T(()=>O0(super.exportState()),{binding:{key:this.value.binding.target.key,value:this.value.binding.target.read()},tag:this.tag})}}function u5(H){return HH(H)&&D1(H.value)}class q1 extends _D{importState(H){return k(H,(D)=>super.importState(D),(D)=>({binding:D.required.object({value:D.required.raw})}),(D)=>{return this.value.binding.inject(D.binding.value),this.value.fetch(),!0})}}function m5(H){return HH(H)&&N5(H.value)}function X1(H,D){while(H.length<D)H.push(void 0)}function i5(H){let D=[];return X1(D,H),D}function g5(H){let D=H.indexOf(void 0);return N(D<0?H:H.slice(0,D))}function t5(H,D){let W=[...g5(H),D];if(W.length>H.length)W.splice(0,W.length-H.length);else X1(W,H.length);return W}class J1{constructor(H){this.emitter=new M,this.onTick_=this.onTick_.bind(this),this.onValueBeforeChange_=this.onValueBeforeChange_.bind(this),this.onValueChange_=this.onValueChange_.bind(this),this.binding=H.binding,this.value_=w(i5(H.bufferSize)),this.value_.emitter.on("beforechange",this.onValueBeforeChange_),this.value_.emitter.on("change",this.onValueChange_),this.ticker=H.ticker,this.ticker.emitter.on("tick",this.onTick_),this.fetch()}get rawValue(){return this.value_.rawValue}set rawValue(H){this.value_.rawValue=H}setRawValue(H,D){this.value_.setRawValue(H,D)}fetch(){this.value_.rawValue=t5(this.value_.rawValue,this.binding.read())}onTick_(){this.fetch()}onValueBeforeChange_(H){this.emitter.emit("beforechange",Object.assign(Object.assign({},H),{sender:this}))}onValueChange_(H){this.emitter.emit("change",Object.assign(Object.assign({},H),{sender:this}))}}function p5(H){if(!("binding"in H))return!1;let D=H.binding;return SD(D)&&"read"in D&&!("write"in D)}class Q1 extends _D{exportState(){return T(()=>super.exportState(),{binding:{readonly:!0}})}}function s5(H){return HH(H)&&p5(H.value)}class Z1 extends r{get label(){return this.controller.labelController.props.get("label")}set label(H){this.controller.labelController.props.set("label",H)}get title(){var H;return(H=this.controller.buttonController.props.get("title"))!==null&&H!==void 0?H:""}set title(H){this.controller.buttonController.props.set("title",H)}on(H,D){let W=D.bind(this);return this.controller.buttonController.emitter.on(H,(U)=>{W(new e0(this,U.nativeEvent))}),this}off(H,D){return this.controller.buttonController.emitter.off(H,D),this}}function n5(H,D,W){if(W)H.classList.add(D);else H.classList.remove(D)}function KH(H,D){return(W)=>{n5(H,D,W)}}function CD(H,D){v(H,(W)=>{D.textContent=W!==null&&W!==void 0?W:""})}var QD=G("btn");class Y1{constructor(H,D){this.element=H.createElement("div"),this.element.classList.add(QD()),D.viewProps.bindClassModifiers(this.element);let W=H.createElement("button");W.classList.add(QD("b")),D.viewProps.bindDisabled(W),this.element.appendChild(W),this.buttonElement=W;let h=H.createElement("div");h.classList.add(QD("t")),CD(D.props.value("title"),h),this.buttonElement.appendChild(h)}}class z1{constructor(H,D){this.emitter=new M,this.onClick_=this.onClick_.bind(this),this.props=D.props,this.viewProps=D.viewProps,this.view=new Y1(H,{props:this.props,viewProps:this.viewProps}),this.view.buttonElement.addEventListener("click",this.onClick_)}importProps(H){return k(H,null,(D)=>({title:D.optional.string}),(D)=>{return this.props.set("title",D.title),!0})}exportProps(){return T(null,{title:this.props.get("title")})}onClick_(H){this.emitter.emit("click",{nativeEvent:H,sender:this})}}class ID extends EH{constructor(H,D){let W=new z1(H,{props:D.buttonProps,viewProps:D.viewProps}),h=new ED(H,{blade:D.blade,props:D.labelProps,valueController:W});super({blade:D.blade,view:h.view,viewProps:D.viewProps});this.buttonController=W,this.labelController=h}importState(H){return k(H,(D)=>super.importState(D)&&this.buttonController.importProps(D)&&this.labelController.importProps(D),()=>({}),()=>!0)}exportState(){return T(()=>super.exportState(),Object.assign(Object.assign({},this.buttonController.exportProps()),this.labelController.exportProps()))}}class xD{constructor(H){let[D,W]=H.split("-"),h=D.split(".");this.major=parseInt(h[0],10),this.minor=parseInt(h[1],10),this.patch=parseInt(h[2],10),this.prerelease=W!==null&&W!==void 0?W:null}toString(){let H=[this.major,this.minor,this.patch].join(".");return this.prerelease!==null?[H,this.prerelease].join("-"):H}}var FH=new xD("2.0.5");function j(H){return Object.assign({core:FH},H)}var c5=j({id:"button",type:"blade",accept(H){let D=I(H,(W)=>({title:W.required.string,view:W.required.constant("button"),label:W.optional.string}));return D?{params:D}:null},controller(H){return new ID(H.document,{blade:H.blade,buttonProps:z.fromObject({title:H.params.title}),labelProps:z.fromObject({label:H.params.label}),viewProps:H.viewProps})},api(H){if(H.controller instanceof ID)return new Z1(H.controller);return null}});function l5(H,D){return H.addBlade(Object.assign(Object.assign({},D),{view:"button"}))}function r5(H,D){return H.addBlade(Object.assign(Object.assign({},D),{view:"folder"}))}function o5(H,D){return H.addBlade(Object.assign(Object.assign({},D),{view:"tab"}))}function a5(H){if(!jD(H))return!1;return"refresh"in H&&typeof H.refresh==="function"}function e5(H,D){if(!gH.isBindable(H))throw $.notBindable();return new gH(H,D)}class O1{constructor(H,D){this.onRackValueChange_=this.onRackValueChange_.bind(this),this.controller_=H,this.emitter_=new M,this.pool_=D,this.controller_.rack.emitter.on("valuechange",this.onRackValueChange_)}get children(){return this.controller_.rack.children.map((H)=>this.pool_.createApi(H))}addBinding(H,D,W){let h=W!==null&&W!==void 0?W:{},U=this.controller_.element.ownerDocument,q=this.pool_.createBinding(U,e5(H,D),h),X=this.pool_.createBindingApi(q);return this.add(X,h.index)}addFolder(H){return r5(this,H)}addButton(H){return l5(this,H)}addTab(H){return o5(this,H)}add(H,D){let W=H.controller;return this.controller_.rack.add(W,D),H}remove(H){this.controller_.rack.remove(H.controller)}addBlade(H){let D=this.controller_.element.ownerDocument,W=this.pool_.createBlade(D,H),h=this.pool_.createApi(W);return this.add(h,H.index)}on(H,D){let W=D.bind(this);return this.emitter_.on(H,(h)=>{W(h)},{key:D}),this}off(H,D){return this.emitter_.off(H,D),this}refresh(){this.children.forEach((H)=>{if(a5(H))H.refresh()})}onRackValueChange_(H){let D=H.bladeController,W=this.pool_.createApi(D),h=D1(D.value)?D.value.binding:null;this.emitter_.emit("change",new GH(W,h?h.target.read():D.value.rawValue,H.options.last))}}class rH extends r{constructor(H,D){super(H);this.rackApi_=new O1(H.rackController,D)}refresh(){this.rackApi_.refresh()}}class oH extends EH{constructor(H){super({blade:H.blade,view:H.view,viewProps:H.rackController.viewProps});this.rackController=H.rackController}importState(H){return k(H,(D)=>super.importState(D),(D)=>({children:D.required.array(D.required.raw)}),(D)=>{return this.rackController.rack.children.every((W,h)=>{return W.importState(D.children[h])})})}exportState(){return T(()=>super.exportState(),{children:this.rackController.rack.children.map((H)=>H.exportState())})}}function $D(H){return"rackController"in H}class G1{constructor(H){this.emitter=new M,this.items_=[],this.cache_=new Set,this.onSubListAdd_=this.onSubListAdd_.bind(this),this.onSubListRemove_=this.onSubListRemove_.bind(this),this.extract_=H}get items(){return this.items_}allItems(){return Array.from(this.cache_)}find(H){for(let D of this.allItems())if(H(D))return D;return null}includes(H){return this.cache_.has(H)}add(H,D){if(this.includes(H))throw $.shouldNeverHappen();let W=D!==void 0?D:this.items_.length;this.items_.splice(W,0,H),this.cache_.add(H);let h=this.extract_(H);if(h)h.emitter.on("add",this.onSubListAdd_),h.emitter.on("remove",this.onSubListRemove_),h.allItems().forEach((U)=>{this.cache_.add(U)});this.emitter.emit("add",{index:W,item:H,root:this,target:this})}remove(H){let D=this.items_.indexOf(H);if(D<0)return;this.items_.splice(D,1),this.cache_.delete(H);let W=this.extract_(H);if(W)W.allItems().forEach((h)=>{this.cache_.delete(h)}),W.emitter.off("add",this.onSubListAdd_),W.emitter.off("remove",this.onSubListRemove_);this.emitter.emit("remove",{index:D,item:H,root:this,target:this})}onSubListAdd_(H){this.cache_.add(H.item),this.emitter.emit("add",{index:H.index,item:H.item,root:this,target:H.target})}onSubListRemove_(H){this.cache_.delete(H.item),this.emitter.emit("remove",{index:H.index,item:H.item,root:this,target:H.target})}}function H6(H,D){for(let W=0;W<H.length;W++){let h=H[W];if(HH(h)&&h.value===D)return h}return null}function D6(H){return $D(H)?H.rackController.rack.bcSet_:null}class K1{constructor(H){var D,W;this.emitter=new M,this.onBladePositionsChange_=this.onBladePositionsChange_.bind(this),this.onSetAdd_=this.onSetAdd_.bind(this),this.onSetRemove_=this.onSetRemove_.bind(this),this.onChildDispose_=this.onChildDispose_.bind(this),this.onChildPositionsChange_=this.onChildPositionsChange_.bind(this),this.onChildValueChange_=this.onChildValueChange_.bind(this),this.onChildViewPropsChange_=this.onChildViewPropsChange_.bind(this),this.onRackLayout_=this.onRackLayout_.bind(this),this.onRackValueChange_=this.onRackValueChange_.bind(this),this.blade_=(D=H.blade)!==null&&D!==void 0?D:null,(W=this.blade_)===null||W===void 0||W.value("positions").emitter.on("change",this.onBladePositionsChange_),this.viewProps=H.viewProps,this.bcSet_=new G1(D6),this.bcSet_.emitter.on("add",this.onSetAdd_),this.bcSet_.emitter.on("remove",this.onSetRemove_)}get children(){return this.bcSet_.items}add(H,D){var W;(W=H.parent)===null||W===void 0||W.remove(H),H.parent=this,this.bcSet_.add(H,D)}remove(H){H.parent=null,this.bcSet_.remove(H)}find(H){return this.bcSet_.allItems().filter(H)}onSetAdd_(H){this.updatePositions_();let D=H.target===H.root;if(this.emitter.emit("add",{bladeController:H.item,index:H.index,root:D,sender:this}),!D)return;let W=H.item;if(W.viewProps.emitter.on("change",this.onChildViewPropsChange_),W.blade.value("positions").emitter.on("change",this.onChildPositionsChange_),W.viewProps.handleDispose(this.onChildDispose_),HH(W))W.value.emitter.on("change",this.onChildValueChange_);else if($D(W)){let h=W.rackController.rack;if(h){let U=h.emitter;U.on("layout",this.onRackLayout_),U.on("valuechange",this.onRackValueChange_)}}}onSetRemove_(H){this.updatePositions_();let D=H.target===H.root;if(this.emitter.emit("remove",{bladeController:H.item,root:D,sender:this}),!D)return;let W=H.item;if(HH(W))W.value.emitter.off("change",this.onChildValueChange_);else if($D(W)){let h=W.rackController.rack;if(h){let U=h.emitter;U.off("layout",this.onRackLayout_),U.off("valuechange",this.onRackValueChange_)}}}updatePositions_(){let H=this.bcSet_.items.filter((h)=>!h.viewProps.get("hidden")),D=H[0],W=H[H.length-1];this.bcSet_.items.forEach((h)=>{let U=[];if(h===D){if(U.push("first"),!this.blade_||this.blade_.get("positions").includes("veryfirst"))U.push("veryfirst")}if(h===W){if(U.push("last"),!this.blade_||this.blade_.get("positions").includes("verylast"))U.push("verylast")}h.blade.set("positions",U)})}onChildPositionsChange_(){this.updatePositions_(),this.emitter.emit("layout",{sender:this})}onChildViewPropsChange_(H){this.updatePositions_(),this.emitter.emit("layout",{sender:this})}onChildDispose_(){this.bcSet_.items.filter((D)=>{return D.viewProps.get("disposed")}).forEach((D)=>{this.bcSet_.remove(D)})}onChildValueChange_(H){let D=H6(this.find(HH),H.sender);if(!D)throw $.alreadyDisposed();this.emitter.emit("valuechange",{bladeController:D,options:H.options,sender:this})}onRackLayout_(H){this.updatePositions_(),this.emitter.emit("layout",{sender:this})}onRackValueChange_(H){this.emitter.emit("valuechange",{bladeController:H.bladeController,options:H.options,sender:this})}onBladePositionsChange_(){this.updatePositions_()}}class aH{constructor(H){this.onRackAdd_=this.onRackAdd_.bind(this),this.onRackRemove_=this.onRackRemove_.bind(this),this.element=H.element,this.viewProps=H.viewProps;let D=new K1({blade:H.root?void 0:H.blade,viewProps:H.viewProps});D.emitter.on("add",this.onRackAdd_),D.emitter.on("remove",this.onRackRemove_),this.rack=D,this.viewProps.handleDispose(()=>{for(let W=this.rack.children.length-1;W>=0;W--)this.rack.children[W].viewProps.set("disposed",!0)})}onRackAdd_(H){if(!H.root)return;W1(this.element,H.bladeController.view.element,H.index)}onRackRemove_(H){if(!H.root)return;PD(H.bladeController.view.element)}}function LH(){return new z({positions:w([],{equals:eW})})}class _H extends z{constructor(H){super(H)}static create(H){let D={completed:!0,expanded:H,expandedHeight:null,shouldFixHeight:!1,temporaryExpanded:null},W=z.createCore(D);return new _H(W)}get styleExpanded(){var H;return(H=this.get("temporaryExpanded"))!==null&&H!==void 0?H:this.get("expanded")}get styleHeight(){if(!this.styleExpanded)return"0";let H=this.get("expandedHeight");if(this.get("shouldFixHeight")&&!L(H))return`${H}px`;return"auto"}bindExpandedClass(H,D){let W=()=>{if(this.styleExpanded)H.classList.add(D);else H.classList.remove(D)};C(this,"expanded",W),C(this,"temporaryExpanded",W)}cleanUpTransition(){this.set("shouldFixHeight",!1),this.set("expandedHeight",null),this.set("completed",!0)}}function W6(H,D){let W=0;return V5(D,()=>{H.set("expandedHeight",null),H.set("temporaryExpanded",!0),tH(D),W=D.clientHeight,H.set("temporaryExpanded",null),tH(D)}),W}function G0(H,D){D.style.height=H.styleHeight}function bD(H,D){H.value("expanded").emitter.on("beforechange",()=>{if(H.set("completed",!1),L(H.get("expandedHeight"))){let W=W6(H,D);if(W>0)H.set("expandedHeight",W)}H.set("shouldFixHeight",!0),tH(D)}),H.emitter.on("change",()=>{G0(H,D)}),G0(H,D),D.addEventListener("transitionend",(W)=>{if(W.propertyName!=="height")return;H.cleanUpTransition()})}class fD extends rH{constructor(H,D){super(H,D);this.emitter_=new M,this.controller.foldable.value("expanded").emitter.on("change",(W)=>{this.emitter_.emit("fold",new o0(this,W.sender.rawValue))}),this.rackApi_.on("change",(W)=>{this.emitter_.emit("change",W)})}get expanded(){return this.controller.foldable.get("expanded")}set expanded(H){this.controller.foldable.set("expanded",H)}get title(){return this.controller.props.get("title")}set title(H){this.controller.props.set("title",H)}get children(){return this.rackApi_.children}addBinding(H,D,W){return this.rackApi_.addBinding(H,D,W)}addFolder(H){return this.rackApi_.addFolder(H)}addButton(H){return this.rackApi_.addButton(H)}addTab(H){return this.rackApi_.addTab(H)}add(H,D){return this.rackApi_.add(H,D)}remove(H){this.rackApi_.remove(H)}addBlade(H){return this.rackApi_.addBlade(H)}on(H,D){let W=D.bind(this);return this.emitter_.on(H,(h)=>{W(h)},{key:D}),this}off(H,D){return this.emitter_.off(H,D),this}}var F1=G("cnt");class L1{constructor(H,D){var W;this.className_=G((W=D.viewName)!==null&&W!==void 0?W:"fld"),this.element=H.createElement("div"),this.element.classList.add(this.className_(),F1()),D.viewProps.bindClassModifiers(this.element),this.foldable_=D.foldable,this.foldable_.bindExpandedClass(this.element,this.className_(void 0,"expanded")),C(this.foldable_,"completed",KH(this.element,this.className_(void 0,"cpl")));let h=H.createElement("button");h.classList.add(this.className_("b")),C(D.props,"title",(Z)=>{if(L(Z))this.element.classList.add(this.className_(void 0,"not"));else this.element.classList.remove(this.className_(void 0,"not"))}),D.viewProps.bindDisabled(h),this.element.appendChild(h),this.buttonElement=h;let U=H.createElement("div");U.classList.add(this.className_("i")),this.element.appendChild(U);let q=H.createElement("div");q.classList.add(this.className_("t")),CD(D.props.value("title"),q),this.buttonElement.appendChild(q),this.titleElement=q;let X=H.createElement("div");X.classList.add(this.className_("m")),this.buttonElement.appendChild(X);let J=H.createElement("div");J.classList.add(this.className_("c")),this.element.appendChild(J),this.containerElement=J}}class pH extends oH{constructor(H,D){var W;let h=_H.create((W=D.expanded)!==null&&W!==void 0?W:!0),U=new L1(H,{foldable:h,props:D.props,viewName:D.root?"rot":void 0,viewProps:D.viewProps});super(Object.assign(Object.assign({},D),{rackController:new aH({blade:D.blade,element:U.containerElement,root:D.root,viewProps:D.viewProps}),view:U}));this.onTitleClick_=this.onTitleClick_.bind(this),this.props=D.props,this.foldable=h,bD(this.foldable,this.view.containerElement),this.rackController.rack.emitter.on("add",()=>{this.foldable.cleanUpTransition()}),this.rackController.rack.emitter.on("remove",()=>{this.foldable.cleanUpTransition()}),this.view.buttonElement.addEventListener("click",this.onTitleClick_)}get document(){return this.view.element.ownerDocument}importState(H){return k(H,(D)=>super.importState(D),(D)=>({expanded:D.required.boolean,title:D.optional.string}),(D)=>{return this.foldable.set("expanded",D.expanded),this.props.set("title",D.title),!0})}exportState(){return T(()=>super.exportState(),{expanded:this.foldable.get("expanded"),title:this.props.get("title")})}onTitleClick_(){this.foldable.set("expanded",!this.foldable.get("expanded"))}}var h6=j({id:"folder",type:"blade",accept(H){let D=I(H,(W)=>({title:W.required.string,view:W.required.constant("folder"),expanded:W.optional.boolean}));return D?{params:D}:null},controller(H){return new pH(H.document,{blade:H.blade,expanded:H.params.expanded,props:z.fromObject({title:H.params.title}),viewProps:H.viewProps})},api(H){if(!(H.controller instanceof pH))return null;return new fD(H.controller,H.pool)}}),U6=G("");function K0(H,D){return KH(H,U6(void 0,D))}class t extends z{constructor(H){var D;super(H);this.onDisabledChange_=this.onDisabledChange_.bind(this),this.onParentChange_=this.onParentChange_.bind(this),this.onParentGlobalDisabledChange_=this.onParentGlobalDisabledChange_.bind(this),[this.globalDisabled_,this.setGlobalDisabled_]=D5(w(this.getGlobalDisabled_())),this.value("disabled").emitter.on("change",this.onDisabledChange_),this.value("parent").emitter.on("change",this.onParentChange_),(D=this.get("parent"))===null||D===void 0||D.globalDisabled.emitter.on("change",this.onParentGlobalDisabledChange_)}static create(H){var D,W,h;let U=H!==null&&H!==void 0?H:{};return new t(z.createCore({disabled:(D=U.disabled)!==null&&D!==void 0?D:!1,disposed:!1,hidden:(W=U.hidden)!==null&&W!==void 0?W:!1,parent:(h=U.parent)!==null&&h!==void 0?h:null}))}get globalDisabled(){return this.globalDisabled_}bindClassModifiers(H){v(this.globalDisabled_,K0(H,"disabled")),C(this,"hidden",K0(H,"hidden"))}bindDisabled(H){v(this.globalDisabled_,(D)=>{H.disabled=D})}bindTabIndex(H){v(this.globalDisabled_,(D)=>{H.tabIndex=D?-1:0})}handleDispose(H){this.value("disposed").emitter.on("change",(D)=>{if(D)H()})}importState(H){this.set("disabled",H.disabled),this.set("hidden",H.hidden)}exportState(){return{disabled:this.get("disabled"),hidden:this.get("hidden")}}getGlobalDisabled_(){let H=this.get("parent");return(H?H.globalDisabled.rawValue:!1)||this.get("disabled")}updateGlobalDisabled_(){this.setGlobalDisabled_(this.getGlobalDisabled_())}onDisabledChange_(){this.updateGlobalDisabled_()}onParentGlobalDisabledChange_(){this.updateGlobalDisabled_()}onParentChange_(H){var D;let W=H.previousRawValue;W===null||W===void 0||W.globalDisabled.emitter.off("change",this.onParentGlobalDisabledChange_),(D=this.get("parent"))===null||D===void 0||D.globalDisabled.emitter.on("change",this.onParentGlobalDisabledChange_),this.updateGlobalDisabled_()}}var F0=G("tbp");class w1{constructor(H,D){this.element=H.createElement("div"),this.element.classList.add(F0()),D.viewProps.bindClassModifiers(this.element);let W=H.createElement("div");W.classList.add(F0("c")),this.element.appendChild(W),this.containerElement=W}}var yH=G("tbi");class I1{constructor(H,D){this.element=H.createElement("div"),this.element.classList.add(yH()),D.viewProps.bindClassModifiers(this.element),C(D.props,"selected",(U)=>{if(U)this.element.classList.add(yH(void 0,"sel"));else this.element.classList.remove(yH(void 0,"sel"))});let W=H.createElement("button");W.classList.add(yH("b")),D.viewProps.bindDisabled(W),this.element.appendChild(W),this.buttonElement=W;let h=H.createElement("div");h.classList.add(yH("t")),CD(D.props.value("title"),h),this.buttonElement.appendChild(h),this.titleElement=h}}class $1{constructor(H,D){this.emitter=new M,this.onClick_=this.onClick_.bind(this),this.props=D.props,this.viewProps=D.viewProps,this.view=new I1(H,{props:D.props,viewProps:D.viewProps}),this.view.buttonElement.addEventListener("click",this.onClick_)}onClick_(){this.emitter.emit("click",{sender:this})}}class sH extends oH{constructor(H,D){let W=new w1(H,{viewProps:D.viewProps});super(Object.assign(Object.assign({},D),{rackController:new aH({blade:D.blade,element:W.containerElement,viewProps:D.viewProps}),view:W}));this.onItemClick_=this.onItemClick_.bind(this),this.ic_=new $1(H,{props:D.itemProps,viewProps:t.create()}),this.ic_.emitter.on("click",this.onItemClick_),this.props=D.props,C(this.props,"selected",(h)=>{this.itemController.props.set("selected",h),this.viewProps.set("hidden",!h)})}get itemController(){return this.ic_}importState(H){return k(H,(D)=>super.importState(D),(D)=>({selected:D.required.boolean,title:D.required.string}),(D)=>{return this.ic_.props.set("selected",D.selected),this.ic_.props.set("title",D.title),!0})}exportState(){return T(()=>super.exportState(),{selected:this.ic_.props.get("selected"),title:this.ic_.props.get("title")})}onItemClick_(){this.props.set("selected",!0)}}class M1 extends rH{constructor(H,D){super(H,D);this.emitter_=new M,this.onSelect_=this.onSelect_.bind(this),this.pool_=D,this.rackApi_.on("change",(W)=>{this.emitter_.emit("change",W)}),this.controller.tab.selectedIndex.emitter.on("change",this.onSelect_)}get pages(){return this.rackApi_.children}addPage(H){let D=this.controller.view.element.ownerDocument,W=new sH(D,{blade:LH(),itemProps:z.fromObject({selected:!1,title:H.title}),props:z.fromObject({selected:!1}),viewProps:t.create()}),h=this.pool_.createApi(W);return this.rackApi_.add(h,H.index)}removePage(H){this.rackApi_.remove(this.rackApi_.children[H])}on(H,D){let W=D.bind(this);return this.emitter_.on(H,(h)=>{W(h)},{key:D}),this}off(H,D){return this.emitter_.off(H,D),this}onSelect_(H){this.emitter_.emit("select",new a0(this,H.rawValue))}}class A1 extends rH{get title(){var H;return(H=this.controller.itemController.props.get("title"))!==null&&H!==void 0?H:""}set title(H){this.controller.itemController.props.set("title",H)}get selected(){return this.controller.props.get("selected")}set selected(H){this.controller.props.set("selected",H)}get children(){return this.rackApi_.children}addButton(H){return this.rackApi_.addButton(H)}addFolder(H){return this.rackApi_.addFolder(H)}addTab(H){return this.rackApi_.addTab(H)}add(H,D){this.rackApi_.add(H,D)}remove(H){this.rackApi_.remove(H)}addBinding(H,D,W){return this.rackApi_.addBinding(H,D,W)}addBlade(H){return this.rackApi_.addBlade(H)}}var L0=-1;class B1{constructor(){this.onItemSelectedChange_=this.onItemSelectedChange_.bind(this),this.empty=w(!0),this.selectedIndex=w(L0),this.items_=[]}add(H,D){let W=D!==null&&D!==void 0?D:this.items_.length;this.items_.splice(W,0,H),H.emitter.on("change",this.onItemSelectedChange_),this.keepSelection_()}remove(H){let D=this.items_.indexOf(H);if(D<0)return;this.items_.splice(D,1),H.emitter.off("change",this.onItemSelectedChange_),this.keepSelection_()}keepSelection_(){if(this.items_.length===0){this.selectedIndex.rawValue=L0,this.empty.rawValue=!0;return}let H=this.items_.findIndex((D)=>D.rawValue);if(H<0)this.items_.forEach((D,W)=>{D.rawValue=W===0}),this.selectedIndex.rawValue=0;else this.items_.forEach((D,W)=>{D.rawValue=W===H}),this.selectedIndex.rawValue=H;this.empty.rawValue=!1}onItemSelectedChange_(H){if(H.rawValue){let D=this.items_.findIndex((W)=>W===H.sender);this.items_.forEach((W,h)=>{W.rawValue=h===D}),this.selectedIndex.rawValue=D}else this.keepSelection_()}}var jH=G("tab");class y1{constructor(H,D){this.element=H.createElement("div"),this.element.classList.add(jH(),F1()),D.viewProps.bindClassModifiers(this.element),v(D.empty,KH(this.element,jH(void 0,"nop")));let W=H.createElement("div");W.classList.add(jH("t")),this.element.appendChild(W),this.itemsElement=W;let h=H.createElement("div");h.classList.add(jH("i")),this.element.appendChild(h);let U=H.createElement("div");U.classList.add(jH("c")),this.element.appendChild(U),this.contentsElement=U}}class MD extends oH{constructor(H,D){let W=new B1,h=new y1(H,{empty:W.empty,viewProps:D.viewProps});super({blade:D.blade,rackController:new aH({blade:D.blade,element:h.contentsElement,viewProps:D.viewProps}),view:h});this.onRackAdd_=this.onRackAdd_.bind(this),this.onRackRemove_=this.onRackRemove_.bind(this);let U=this.rackController.rack;U.emitter.on("add",this.onRackAdd_),U.emitter.on("remove",this.onRackRemove_),this.tab=W}add(H,D){this.rackController.rack.add(H,D)}remove(H){this.rackController.rack.remove(this.rackController.rack.children[H])}onRackAdd_(H){if(!H.root)return;let D=H.bladeController;W1(this.view.itemsElement,D.itemController.view.element,H.index),D.itemController.viewProps.set("parent",this.viewProps),this.tab.add(D.props.value("selected"))}onRackRemove_(H){if(!H.root)return;let D=H.bladeController;PD(D.itemController.view.element),D.itemController.viewProps.set("parent",null),this.tab.remove(D.props.value("selected"))}}var j1=j({id:"tab",type:"blade",accept(H){let D=I(H,(W)=>({pages:W.required.array(W.required.object({title:W.required.string})),view:W.required.constant("tab")}));if(!D||D.pages.length===0)return null;return{params:D}},controller(H){let D=new MD(H.document,{blade:H.blade,viewProps:H.viewProps});return H.params.pages.forEach((W)=>{let h=new sH(H.document,{blade:LH(),itemProps:z.fromObject({selected:!1,title:W.title}),props:z.fromObject({selected:!1}),viewProps:t.create()});D.add(h)}),D},api(H){if(H.controller instanceof MD)return new M1(H.controller,H.pool);if(H.controller instanceof sH)return new A1(H.controller,H.pool);return null}});function q6(H,D){let W=H.accept(D.params);if(!W)return null;let h=I(D.params,(U)=>({disabled:U.optional.boolean,hidden:U.optional.boolean}));return H.controller({blade:LH(),document:D.document,params:N(Object.assign(Object.assign({},W.params),{disabled:h===null||h===void 0?void 0:h.disabled,hidden:h===null||h===void 0?void 0:h.hidden})),viewProps:t.create({disabled:h===null||h===void 0?void 0:h.disabled,hidden:h===null||h===void 0?void 0:h.hidden})})}class eH extends ZH{get options(){return this.controller.valueController.props.get("options")}set options(H){this.controller.valueController.props.set("options",H)}}class S1{constructor(){this.disabled=!1,this.emitter=new M}dispose(){}tick(){if(this.disabled)return;this.emitter.emit("tick",{sender:this})}}class R1{constructor(H,D){this.disabled_=!1,this.timerId_=null,this.onTick_=this.onTick_.bind(this),this.doc_=H,this.emitter=new M,this.interval_=D,this.setTimer_()}get disabled(){return this.disabled_}set disabled(H){if(this.disabled_=H,this.disabled_)this.clearTimer_();else this.setTimer_()}dispose(){this.clearTimer_()}clearTimer_(){if(this.timerId_===null)return;let H=this.doc_.defaultView;if(H)H.clearInterval(this.timerId_);this.timerId_=null}setTimer_(){if(this.clearTimer_(),this.interval_<=0)return;let H=this.doc_.defaultView;if(H)this.timerId_=H.setInterval(this.onTick_,this.interval_)}onTick_(){if(this.disabled_)return;this.emitter.emit("tick",{sender:this})}}class wH{constructor(H){this.constraints=H}constrain(H){return this.constraints.reduce((D,W)=>{return W.constrain(D)},H)}}function nH(H,D){if(H instanceof D)return H;if(H instanceof wH){let W=H.constraints.reduce((h,U)=>{if(h)return h;return U instanceof D?U:null},null);if(W)return W}return null}class IH{constructor(H){this.values=z.fromObject({options:H})}constrain(H){let D=this.values.get("options");if(D.length===0)return H;return D.filter((h)=>{return h.value===H}).length>0?H:D[0].value}}function CH(H){var D;let W=wD;if(Array.isArray(H))return(D=I({items:H},(h)=>({items:h.required.array(h.required.object({text:h.required.string,value:h.required.raw}))})))===null||D===void 0?void 0:D.items;if(typeof H==="object")return W.required.raw(H).value;return}function dD(H){if(Array.isArray(H))return H;let D=[];return Object.keys(H).forEach((W)=>{D.push({text:W,value:H[W]})}),D}function vD(H){return!L(H)?new IH(dD(N(H))):null}var ZD=G("lst");class N1{constructor(H,D){this.onValueChange_=this.onValueChange_.bind(this),this.props_=D.props,this.element=H.createElement("div"),this.element.classList.add(ZD()),D.viewProps.bindClassModifiers(this.element);let W=H.createElement("select");W.classList.add(ZD("s")),D.viewProps.bindDisabled(W),this.element.appendChild(W),this.selectElement=W;let h=H.createElement("div");h.classList.add(ZD("m")),h.appendChild(lH(H,"dropdown")),this.element.appendChild(h),D.value.emitter.on("change",this.onValueChange_),this.value_=D.value,C(this.props_,"options",(U)=>{h1(this.selectElement),U.forEach((q)=>{let X=H.createElement("option");X.textContent=q.text,this.selectElement.appendChild(X)}),this.update_()})}update_(){let H=this.props_.get("options").map((D)=>D.value);this.selectElement.selectedIndex=H.indexOf(this.value_.rawValue)}onValueChange_(){this.update_()}}class i{constructor(H,D){this.onSelectChange_=this.onSelectChange_.bind(this),this.props=D.props,this.value=D.value,this.viewProps=D.viewProps,this.view=new N1(H,{props:this.props,value:this.value,viewProps:this.viewProps}),this.view.selectElement.addEventListener("change",this.onSelectChange_)}onSelectChange_(H){let D=N(H.currentTarget);this.value.rawValue=this.props.get("options")[D.selectedIndex].value}importProps(H){return k(H,null,(D)=>({options:D.required.custom(CH)}),(D)=>{return this.props.set("options",dD(D.options)),!0})}exportProps(){return T(null,{options:this.props.get("options")})}}var w0=G("pop");class k1{constructor(H,D){this.element=H.createElement("div"),this.element.classList.add(w0()),D.viewProps.bindClassModifiers(this.element),v(D.shows,KH(this.element,w0(void 0,"v")))}}class uD{constructor(H,D){this.shows=w(!1),this.viewProps=D.viewProps,this.view=new k1(H,{shows:this.shows,viewProps:this.viewProps})}}var I0=G("txt");class T1{constructor(H,D){this.onChange_=this.onChange_.bind(this),this.element=H.createElement("div"),this.element.classList.add(I0()),D.viewProps.bindClassModifiers(this.element),this.props_=D.props,this.props_.emitter.on("change",this.onChange_);let W=H.createElement("input");W.classList.add(I0("i")),W.type="text",D.viewProps.bindDisabled(W),this.element.appendChild(W),this.inputElement=W,D.value.emitter.on("change",this.onChange_),this.value_=D.value,this.refresh()}refresh(){let H=this.props_.get("formatter");this.inputElement.value=H(this.value_.rawValue)}onChange_(){this.refresh()}}class YH{constructor(H,D){this.onInputChange_=this.onInputChange_.bind(this),this.parser_=D.parser,this.props=D.props,this.value=D.value,this.viewProps=D.viewProps,this.view=new T1(H,{props:D.props,value:this.value,viewProps:this.viewProps}),this.view.inputElement.addEventListener("change",this.onInputChange_)}onInputChange_(H){let W=N(H.currentTarget).value,h=this.parser_(W);if(!L(h))this.value.rawValue=h;this.view.refresh()}}function X6(H){return String(H)}function P1(H){if(H==="false")return!1;return!!H}function $0(H){return X6(H)}function J6(H){return(D)=>{return H.reduce((W,h)=>{if(W!==null)return W;return h(D)},null)}}var Q6=R(0);function cH(H){return Q6(H)+"%"}function V1(H){return String(H)}function AD(H){return H}function $H({primary:H,secondary:D,forward:W,backward:h}){let U=!1;function q(X){if(U)return;U=!0,X(),U=!1}H.emitter.on("change",(X)=>{q(()=>{D.setRawValue(W(H.rawValue,D.rawValue),X.options)})}),D.emitter.on("change",(X)=>{q(()=>{H.setRawValue(h(H.rawValue,D.rawValue),X.options)}),q(()=>{D.setRawValue(W(H.rawValue,D.rawValue),X.options)})}),q(()=>{D.setRawValue(W(H.rawValue,D.rawValue),{forceEmit:!1,last:!0})})}function S(H,D){let W=H*(D.altKey?0.1:1)*(D.shiftKey?10:1);if(D.upKey)return+W;else if(D.downKey)return-W;return 0}function kH(H){return{altKey:H.altKey,downKey:H.key==="ArrowDown",shiftKey:H.shiftKey,upKey:H.key==="ArrowUp"}}function g(H){return{altKey:H.altKey,downKey:H.key==="ArrowLeft",shiftKey:H.shiftKey,upKey:H.key==="ArrowRight"}}function Z6(H){return H==="ArrowUp"||H==="ArrowDown"}function E1(H){return Z6(H)||H==="ArrowLeft"||H==="ArrowRight"}function YD(H,D){var W,h;let U=D.ownerDocument.defaultView,q=D.getBoundingClientRect();return{x:H.pageX-(((W=U&&U.scrollX)!==null&&W!==void 0?W:0)+q.left),y:H.pageY-(((h=U&&U.scrollY)!==null&&h!==void 0?h:0)+q.top)}}class o{constructor(H){this.lastTouch_=null,this.onDocumentMouseMove_=this.onDocumentMouseMove_.bind(this),this.onDocumentMouseUp_=this.onDocumentMouseUp_.bind(this),this.onMouseDown_=this.onMouseDown_.bind(this),this.onTouchEnd_=this.onTouchEnd_.bind(this),this.onTouchMove_=this.onTouchMove_.bind(this),this.onTouchStart_=this.onTouchStart_.bind(this),this.elem_=H,this.emitter=new M,H.addEventListener("touchstart",this.onTouchStart_,{passive:!1}),H.addEventListener("touchmove",this.onTouchMove_,{passive:!0}),H.addEventListener("touchend",this.onTouchEnd_),H.addEventListener("mousedown",this.onMouseDown_)}computePosition_(H){let D=this.elem_.getBoundingClientRect();return{bounds:{width:D.width,height:D.height},point:H?{x:H.x,y:H.y}:null}}onMouseDown_(H){var D;H.preventDefault(),(D=H.currentTarget)===null||D===void 0||D.focus();let W=this.elem_.ownerDocument;W.addEventListener("mousemove",this.onDocumentMouseMove_),W.addEventListener("mouseup",this.onDocumentMouseUp_),this.emitter.emit("down",{altKey:H.altKey,data:this.computePosition_(YD(H,this.elem_)),sender:this,shiftKey:H.shiftKey})}onDocumentMouseMove_(H){this.emitter.emit("move",{altKey:H.altKey,data:this.computePosition_(YD(H,this.elem_)),sender:this,shiftKey:H.shiftKey})}onDocumentMouseUp_(H){let D=this.elem_.ownerDocument;D.removeEventListener("mousemove",this.onDocumentMouseMove_),D.removeEventListener("mouseup",this.onDocumentMouseUp_),this.emitter.emit("up",{altKey:H.altKey,data:this.computePosition_(YD(H,this.elem_)),sender:this,shiftKey:H.shiftKey})}onTouchStart_(H){H.preventDefault();let D=H.targetTouches.item(0),W=this.elem_.getBoundingClientRect();this.emitter.emit("down",{altKey:H.altKey,data:this.computePosition_(D?{x:D.clientX-W.left,y:D.clientY-W.top}:void 0),sender:this,shiftKey:H.shiftKey}),this.lastTouch_=D}onTouchMove_(H){let D=H.targetTouches.item(0),W=this.elem_.getBoundingClientRect();this.emitter.emit("move",{altKey:H.altKey,data:this.computePosition_(D?{x:D.clientX-W.left,y:D.clientY-W.top}:void 0),sender:this,shiftKey:H.shiftKey}),this.lastTouch_=D}onTouchEnd_(H){var D;let W=(D=H.targetTouches.item(0))!==null&&D!==void 0?D:this.lastTouch_,h=this.elem_.getBoundingClientRect();this.emitter.emit("up",{altKey:H.altKey,data:this.computePosition_(W?{x:W.clientX-h.left,y:W.clientY-h.top}:void 0),sender:this,shiftKey:H.shiftKey})}}var P=G("txt");class _1{constructor(H,D){if(this.onChange_=this.onChange_.bind(this),this.props_=D.props,this.props_.emitter.on("change",this.onChange_),this.element=H.createElement("div"),this.element.classList.add(P(),P(void 0,"num")),D.arrayPosition)this.element.classList.add(P(void 0,D.arrayPosition));D.viewProps.bindClassModifiers(this.element);let W=H.createElement("input");W.classList.add(P("i")),W.type="text",D.viewProps.bindDisabled(W),this.element.appendChild(W),this.inputElement=W,this.onDraggingChange_=this.onDraggingChange_.bind(this),this.dragging_=D.dragging,this.dragging_.emitter.on("change",this.onDraggingChange_),this.element.classList.add(P()),this.inputElement.classList.add(P("i"));let h=H.createElement("div");h.classList.add(P("k")),this.element.appendChild(h),this.knobElement=h;let U=H.createElementNS(_,"svg");U.classList.add(P("g")),this.knobElement.appendChild(U);let q=H.createElementNS(_,"path");q.classList.add(P("gb")),U.appendChild(q),this.guideBodyElem_=q;let X=H.createElementNS(_,"path");X.classList.add(P("gh")),U.appendChild(X),this.guideHeadElem_=X;let J=H.createElement("div");J.classList.add(G("tt")()),this.knobElement.appendChild(J),this.tooltipElem_=J,D.value.emitter.on("change",this.onChange_),this.value=D.value,this.refresh()}onDraggingChange_(H){if(H.rawValue===null){this.element.classList.remove(P(void 0,"drg"));return}this.element.classList.add(P(void 0,"drg"));let D=H.rawValue/this.props_.get("pointerScale"),W=D+(D>0?-1:D<0?1:0),h=B(-W,-4,4);this.guideHeadElem_.setAttributeNS(null,"d",[`M ${W+h},0 L${W},4 L${W+h},8`,`M ${D},-1 L${D},9`].join(" ")),this.guideBodyElem_.setAttributeNS(null,"d",`M 0,4 L${D},4`);let U=this.props_.get("formatter");this.tooltipElem_.textContent=U(this.value.rawValue),this.tooltipElem_.style.left=`${D}px`}refresh(){let H=this.props_.get("formatter");this.inputElement.value=H(this.value.rawValue)}onChange_(){this.refresh()}}class MH{constructor(H,D){var W;this.originRawValue_=0,this.onInputChange_=this.onInputChange_.bind(this),this.onInputKeyDown_=this.onInputKeyDown_.bind(this),this.onInputKeyUp_=this.onInputKeyUp_.bind(this),this.onPointerDown_=this.onPointerDown_.bind(this),this.onPointerMove_=this.onPointerMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.parser_=D.parser,this.props=D.props,this.sliderProps_=(W=D.sliderProps)!==null&&W!==void 0?W:null,this.value=D.value,this.viewProps=D.viewProps,this.dragging_=w(null),this.view=new _1(H,{arrayPosition:D.arrayPosition,dragging:this.dragging_,props:this.props,value:this.value,viewProps:this.viewProps}),this.view.inputElement.addEventListener("change",this.onInputChange_),this.view.inputElement.addEventListener("keydown",this.onInputKeyDown_),this.view.inputElement.addEventListener("keyup",this.onInputKeyUp_);let h=new o(this.view.knobElement);h.emitter.on("down",this.onPointerDown_),h.emitter.on("move",this.onPointerMove_),h.emitter.on("up",this.onPointerUp_)}constrainValue_(H){var D,W;let h=(D=this.sliderProps_)===null||D===void 0?void 0:D.get("min"),U=(W=this.sliderProps_)===null||W===void 0?void 0:W.get("max"),q=H;if(h!==void 0)q=Math.max(q,h);if(U!==void 0)q=Math.min(q,U);return q}onInputChange_(H){let W=N(H.currentTarget).value,h=this.parser_(W);if(!L(h))this.value.rawValue=this.constrainValue_(h);this.view.refresh()}onInputKeyDown_(H){let D=S(this.props.get("keyScale"),kH(H));if(D===0)return;this.value.setRawValue(this.constrainValue_(this.value.rawValue+D),{forceEmit:!1,last:!1})}onInputKeyUp_(H){if(S(this.props.get("keyScale"),kH(H))===0)return;this.value.setRawValue(this.value.rawValue,{forceEmit:!0,last:!0})}onPointerDown_(){this.originRawValue_=this.value.rawValue,this.dragging_.rawValue=0}computeDraggingValue_(H){if(!H.point)return null;let D=H.point.x-H.bounds.width/2;return this.constrainValue_(this.originRawValue_+D*this.props.get("pointerScale"))}onPointerMove_(H){let D=this.computeDraggingValue_(H.data);if(D===null)return;this.value.setRawValue(D,{forceEmit:!1,last:!1}),this.dragging_.rawValue=this.value.rawValue-this.originRawValue_}onPointerUp_(H){let D=this.computeDraggingValue_(H.data);if(D===null)return;this.value.setRawValue(D,{forceEmit:!0,last:!0}),this.dragging_.rawValue=null}}var zD=G("sld");class C1{constructor(H,D){this.onChange_=this.onChange_.bind(this),this.props_=D.props,this.props_.emitter.on("change",this.onChange_),this.element=H.createElement("div"),this.element.classList.add(zD()),D.viewProps.bindClassModifiers(this.element);let W=H.createElement("div");W.classList.add(zD("t")),D.viewProps.bindTabIndex(W),this.element.appendChild(W),this.trackElement=W;let h=H.createElement("div");h.classList.add(zD("k")),this.trackElement.appendChild(h),this.knobElement=h,D.value.emitter.on("change",this.onChange_),this.value=D.value,this.update_()}update_(){let H=B(F(this.value.rawValue,this.props_.get("min"),this.props_.get("max"),0,100),0,100);this.knobElement.style.width=`${H}%`}onChange_(){this.update_()}}class x1{constructor(H,D){this.onKeyDown_=this.onKeyDown_.bind(this),this.onKeyUp_=this.onKeyUp_.bind(this),this.onPointerDownOrMove_=this.onPointerDownOrMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.value=D.value,this.viewProps=D.viewProps,this.props=D.props,this.view=new C1(H,{props:this.props,value:this.value,viewProps:this.viewProps}),this.ptHandler_=new o(this.view.trackElement),this.ptHandler_.emitter.on("down",this.onPointerDownOrMove_),this.ptHandler_.emitter.on("move",this.onPointerDownOrMove_),this.ptHandler_.emitter.on("up",this.onPointerUp_),this.view.trackElement.addEventListener("keydown",this.onKeyDown_),this.view.trackElement.addEventListener("keyup",this.onKeyUp_)}handlePointerEvent_(H,D){if(!H.point)return;this.value.setRawValue(F(B(H.point.x,0,H.bounds.width),0,H.bounds.width,this.props.get("min"),this.props.get("max")),D)}onPointerDownOrMove_(H){this.handlePointerEvent_(H.data,{forceEmit:!1,last:!1})}onPointerUp_(H){this.handlePointerEvent_(H.data,{forceEmit:!0,last:!0})}onKeyDown_(H){let D=S(this.props.get("keyScale"),g(H));if(D===0)return;this.value.setRawValue(this.value.rawValue+D,{forceEmit:!1,last:!1})}onKeyUp_(H){if(S(this.props.get("keyScale"),g(H))===0)return;this.value.setRawValue(this.value.rawValue,{forceEmit:!0,last:!0})}}var OD=G("sldtxt");class b1{constructor(H,D){this.element=H.createElement("div"),this.element.classList.add(OD());let W=H.createElement("div");W.classList.add(OD("s")),this.sliderView_=D.sliderView,W.appendChild(this.sliderView_.element),this.element.appendChild(W);let h=H.createElement("div");h.classList.add(OD("t")),this.textView_=D.textView,h.appendChild(this.textView_.element),this.element.appendChild(h)}}class TH{constructor(H,D){this.value=D.value,this.viewProps=D.viewProps,this.sliderC_=new x1(H,{props:D.sliderProps,value:D.value,viewProps:this.viewProps}),this.textC_=new MH(H,{parser:D.parser,props:D.textProps,sliderProps:D.sliderProps,value:D.value,viewProps:D.viewProps}),this.view=new b1(H,{sliderView:this.sliderC_.view,textView:this.textC_.view})}get sliderController(){return this.sliderC_}get textController(){return this.textC_}importProps(H){return k(H,null,(D)=>({max:D.required.number,min:D.required.number}),(D)=>{let W=this.sliderC_.props;return W.set("max",D.max),W.set("min",D.min),!0})}exportProps(){let H=this.sliderC_.props;return T(null,{max:H.get("max"),min:H.get("min")})}}function f1(H){return{sliderProps:new z({keyScale:H.keyScale,max:H.max,min:H.min}),textProps:new z({formatter:w(H.formatter),keyScale:H.keyScale,pointerScale:w(H.pointerScale)})}}var Y6={containerUnitSize:"cnt-usz"};function d1(H){return`--${Y6[H]}`}function PH(H){return r0(H)}function c(H){if(!LD(H))return;return I(H,PH)}function d(H,D){if(!H)return;let W=[],h=n0(H,D);if(h)W.push(h);let U=c0(H);if(U)W.push(U);return new wH(W)}function z6(H){if(!H)return!1;return H.major===FH.major}function v1(H){if(H==="inline"||H==="popup")return H;return}function xH(H,D){H.write(D)}var uH=G("ckb");class u1{constructor(H,D){this.onValueChange_=this.onValueChange_.bind(this),this.element=H.createElement("div"),this.element.classList.add(uH()),D.viewProps.bindClassModifiers(this.element);let W=H.createElement("label");W.classList.add(uH("l")),this.element.appendChild(W),this.labelElement=W;let h=H.createElement("input");h.classList.add(uH("i")),h.type="checkbox",this.labelElement.appendChild(h),this.inputElement=h,D.viewProps.bindDisabled(this.inputElement);let U=H.createElement("div");U.classList.add(uH("w")),this.labelElement.appendChild(U);let q=lH(H,"check");U.appendChild(q),D.value.emitter.on("change",this.onValueChange_),this.value=D.value,this.update_()}update_(){this.inputElement.checked=this.value.rawValue}onValueChange_(){this.update_()}}class m1{constructor(H,D){this.onInputChange_=this.onInputChange_.bind(this),this.onLabelMouseDown_=this.onLabelMouseDown_.bind(this),this.value=D.value,this.viewProps=D.viewProps,this.view=new u1(H,{value:this.value,viewProps:this.viewProps}),this.view.inputElement.addEventListener("change",this.onInputChange_),this.view.labelElement.addEventListener("mousedown",this.onLabelMouseDown_)}onInputChange_(H){let D=N(H.currentTarget);this.value.rawValue=D.checked,H.preventDefault(),H.stopPropagation()}onLabelMouseDown_(H){H.preventDefault()}}function O6(H){let D=[],W=vD(H.options);if(W)D.push(W);return new wH(D)}var G6=j({id:"input-bool",type:"input",accept:(H,D)=>{if(typeof H!=="boolean")return null;let W=I(D,(h)=>({options:h.optional.custom(CH),readonly:h.optional.constant(!1)}));return W?{initialValue:H,params:W}:null},binding:{reader:(H)=>P1,constraint:(H)=>O6(H.params),writer:(H)=>xH},controller:(H)=>{let{document:D,value:W,constraint:h}=H,U=h&&nH(h,IH);if(U)return new i(D,{props:new z({options:U.values.value("options")}),value:W,viewProps:H.viewProps});return new m1(D,{value:W,viewProps:H.viewProps})},api(H){if(typeof H.controller.value.rawValue!=="boolean")return null;if(H.controller.valueController instanceof i)return new eH(H.controller);return null}}),e=G("col");class i1{constructor(H,D){this.element=H.createElement("div"),this.element.classList.add(e()),D.foldable.bindExpandedClass(this.element,e(void 0,"expanded")),C(D.foldable,"completed",KH(this.element,e(void 0,"cpl")));let W=H.createElement("div");W.classList.add(e("h")),this.element.appendChild(W);let h=H.createElement("div");h.classList.add(e("s")),W.appendChild(h),this.swatchElement=h;let U=H.createElement("div");if(U.classList.add(e("t")),W.appendChild(U),this.textElement=U,D.pickerLayout==="inline"){let q=H.createElement("div");q.classList.add(e("p")),this.element.appendChild(q),this.pickerElement=q}else this.pickerElement=null}}function K6(H,D,W){let h=B(H/255,0,1),U=B(D/255,0,1),q=B(W/255,0,1),X=Math.max(h,U,q),J=Math.min(h,U,q),Z=X-J,Q=0,Y=0,O=(J+X)/2;if(Z!==0){if(Y=Z/(1-Math.abs(X+J-1)),h===X)Q=(U-q)/Z;else if(U===X)Q=2+(q-h)/Z;else Q=4+(h-U)/Z;Q=Q/6+(Q<0?1:0)}return[Q*360,Y*100,O*100]}function F6(H,D,W){let h=(H%360+360)%360,U=B(D/100,0,1),q=B(W/100,0,1),X=(1-Math.abs(2*q-1))*U,J=X*(1-Math.abs(h/60%2-1)),Z=q-X/2,Q,Y,O;if(h>=0&&h<60)[Q,Y,O]=[X,J,0];else if(h>=60&&h<120)[Q,Y,O]=[J,X,0];else if(h>=120&&h<180)[Q,Y,O]=[0,X,J];else if(h>=180&&h<240)[Q,Y,O]=[0,J,X];else if(h>=240&&h<300)[Q,Y,O]=[J,0,X];else[Q,Y,O]=[X,0,J];return[(Q+Z)*255,(Y+Z)*255,(O+Z)*255]}function L6(H,D,W){let h=B(H/255,0,1),U=B(D/255,0,1),q=B(W/255,0,1),X=Math.max(h,U,q),J=Math.min(h,U,q),Z=X-J,Q;if(Z===0)Q=0;else if(X===h)Q=60*(((U-q)/Z%6+6)%6);else if(X===U)Q=60*((q-h)/Z+2);else Q=60*((h-U)/Z+4);let Y=X===0?0:Z/X,O=X;return[Q,Y*100,O*100]}function g1(H,D,W){let h=t0(H,360),U=B(D/100,0,1),q=B(W/100,0,1),X=q*U,J=X*(1-Math.abs(h/60%2-1)),Z=q-X,Q,Y,O;if(h>=0&&h<60)[Q,Y,O]=[X,J,0];else if(h>=60&&h<120)[Q,Y,O]=[J,X,0];else if(h>=120&&h<180)[Q,Y,O]=[0,X,J];else if(h>=180&&h<240)[Q,Y,O]=[0,J,X];else if(h>=240&&h<300)[Q,Y,O]=[J,0,X];else[Q,Y,O]=[X,0,J];return[(Q+Z)*255,(Y+Z)*255,(O+Z)*255]}function w6(H,D,W){let h=W+D*(100-Math.abs(2*W-100))/200;return[H,h!==0?D*(100-Math.abs(2*W-100))/h:0,W+D*(100-Math.abs(2*W-100))/200]}function I6(H,D,W){let h=100-Math.abs(W*(200-D)/100-100);return[H,h!==0?D*W/h:0,W*(200-D)/200]}function x(H){return[H[0],H[1],H[2]]}function HD(H,D){return[H[0],H[1],H[2],D]}var $6={hsl:{hsl:(H,D,W)=>[H,D,W],hsv:w6,rgb:F6},hsv:{hsl:I6,hsv:(H,D,W)=>[H,D,W],rgb:g1},rgb:{hsl:K6,hsv:L6,rgb:(H,D,W)=>[H,D,W]}};function zH(H,D){return[D==="float"?1:H==="rgb"?255:360,D==="float"?1:H==="rgb"?255:100,D==="float"?1:H==="rgb"?255:100]}function M6(H,D){return H===D?D:t0(H,D)}function t1(H,D,W){var h;let U=zH(D,W);return[D==="rgb"?B(H[0],0,U[0]):M6(H[0],U[0]),B(H[1],0,U[1]),B(H[2],0,U[2]),B((h=H[3])!==null&&h!==void 0?h:1,0,1)]}function M0(H,D,W,h){let U=zH(D,W),q=zH(D,h);return H.map((X,J)=>X/U[J]*q[J])}function p1(H,D,W){let h=M0(H,D.mode,D.type,"int"),U=$6[D.mode][W.mode](...h);return M0(U,W.mode,"int",W.type)}class K{static black(){return new K([0,0,0],"rgb")}constructor(H,D){this.type="int",this.mode=D,this.comps_=t1(H,D,this.type)}getComponents(H){return HD(p1(x(this.comps_),{mode:this.mode,type:this.type},{mode:H!==null&&H!==void 0?H:this.mode,type:this.type}),this.comps_[3])}toRgbaObject(){let H=this.getComponents("rgb");return{r:H[0],g:H[1],b:H[2],a:H[3]}}}var p=G("colp");class s1{constructor(H,D){this.alphaViews_=null,this.element=H.createElement("div"),this.element.classList.add(p()),D.viewProps.bindClassModifiers(this.element);let W=H.createElement("div");W.classList.add(p("hsv"));let h=H.createElement("div");h.classList.add(p("sv")),this.svPaletteView_=D.svPaletteView,h.appendChild(this.svPaletteView_.element),W.appendChild(h);let U=H.createElement("div");U.classList.add(p("h")),this.hPaletteView_=D.hPaletteView,U.appendChild(this.hPaletteView_.element),W.appendChild(U),this.element.appendChild(W);let q=H.createElement("div");if(q.classList.add(p("rgb")),this.textsView_=D.textsView,q.appendChild(this.textsView_.element),this.element.appendChild(q),D.alphaViews){this.alphaViews_={palette:D.alphaViews.palette,text:D.alphaViews.text};let X=H.createElement("div");X.classList.add(p("a"));let J=H.createElement("div");J.classList.add(p("ap")),J.appendChild(this.alphaViews_.palette.element),X.appendChild(J);let Z=H.createElement("div");Z.classList.add(p("at")),Z.appendChild(this.alphaViews_.text.element),X.appendChild(Z),this.element.appendChild(X)}}get allFocusableElements(){let H=[this.svPaletteView_.element,this.hPaletteView_.element,this.textsView_.modeSelectElement,...this.textsView_.inputViews.map((D)=>D.inputElement)];if(this.alphaViews_)H.push(this.alphaViews_.palette.element,this.alphaViews_.text.inputElement);return H}}function A6(H){return H==="int"?"int":H==="float"?"float":void 0}function mD(H){return I(H,(D)=>({color:D.optional.object({alpha:D.optional.boolean,type:D.optional.custom(A6)}),expanded:D.optional.boolean,picker:D.optional.custom(v1),readonly:D.optional.constant(!1)}))}function UH(H){return H?0.1:1}function n1(H){var D;return(D=H.color)===null||D===void 0?void 0:D.type}class DD{constructor(H,D){this.type="float",this.mode=D,this.comps_=t1(H,D,this.type)}getComponents(H){return HD(p1(x(this.comps_),{mode:this.mode,type:this.type},{mode:H!==null&&H!==void 0?H:this.mode,type:this.type}),this.comps_[3])}toRgbaObject(){let H=this.getComponents("rgb");return{r:H[0],g:H[1],b:H[2],a:H[3]}}}var B6={int:(H,D)=>new K(H,D),float:(H,D)=>new DD(H,D)};function iD(H,D,W){return B6[W](H,D)}function y6(H){return H.type==="float"}function j6(H){return H.type==="int"}function S6(H){let D=H.getComponents(),W=zH(H.mode,"int");return new K([Math.round(F(D[0],0,1,0,W[0])),Math.round(F(D[1],0,1,0,W[1])),Math.round(F(D[2],0,1,0,W[2])),D[3]],H.mode)}function R6(H){let D=H.getComponents(),W=zH(H.mode,"int");return new DD([F(D[0],0,W[0],0,1),F(D[1],0,W[1],0,1),F(D[2],0,W[2],0,1),D[3]],H.mode)}function y(H,D){if(H.type===D)return H;if(j6(H)&&D==="float")return R6(H);if(y6(H)&&D==="int")return S6(H);throw $.shouldNeverHappen()}function N6(H,D){return H.alpha===D.alpha&&H.mode===D.mode&&H.notation===D.notation&&H.type===D.type}function V(H,D){let W=H.match(/^(.+)%$/);if(!W)return Math.min(parseFloat(H),D);return Math.min(parseFloat(W[1])*0.01*D,D)}var k6={deg:(H)=>H,grad:(H)=>H*360/400,rad:(H)=>H*360/(2*Math.PI),turn:(H)=>H*360};function c1(H){let D=H.match(/^([0-9.]+?)(deg|grad|rad|turn)$/);if(!D)return parseFloat(H);let W=parseFloat(D[1]),h=D[2];return k6[h](W)}function l1(H){let D=H.match(/^rgb\(\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*\)$/);if(!D)return null;let W=[V(D[1],255),V(D[2],255),V(D[3],255)];if(isNaN(W[0])||isNaN(W[1])||isNaN(W[2]))return null;return W}function T6(H){let D=l1(H);return D?new K(D,"rgb"):null}function r1(H){let D=H.match(/^rgba\(\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*\)$/);if(!D)return null;let W=[V(D[1],255),V(D[2],255),V(D[3],255),V(D[4],1)];if(isNaN(W[0])||isNaN(W[1])||isNaN(W[2])||isNaN(W[3]))return null;return W}function P6(H){let D=r1(H);return D?new K(D,"rgb"):null}function o1(H){let D=H.match(/^hsl\(\s*([0-9A-Fa-f.]+(?:deg|grad|rad|turn)?)\s*,\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*\)$/);if(!D)return null;let W=[c1(D[1]),V(D[2],100),V(D[3],100)];if(isNaN(W[0])||isNaN(W[1])||isNaN(W[2]))return null;return W}function V6(H){let D=o1(H);return D?new K(D,"hsl"):null}function a1(H){let D=H.match(/^hsla\(\s*([0-9A-Fa-f.]+(?:deg|grad|rad|turn)?)\s*,\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*\)$/);if(!D)return null;let W=[c1(D[1]),V(D[2],100),V(D[3],100),V(D[4],1)];if(isNaN(W[0])||isNaN(W[1])||isNaN(W[2])||isNaN(W[3]))return null;return W}function E6(H){let D=a1(H);return D?new K(D,"hsl"):null}function e1(H){let D=H.match(/^#([0-9A-Fa-f])([0-9A-Fa-f])([0-9A-Fa-f])$/);if(D)return[parseInt(D[1]+D[1],16),parseInt(D[2]+D[2],16),parseInt(D[3]+D[3],16)];let W=H.match(/^(?:#|0x)([0-9A-Fa-f]{2})([0-9A-Fa-f]{2})([0-9A-Fa-f]{2})$/);if(W)return[parseInt(W[1],16),parseInt(W[2],16),parseInt(W[3],16)];return null}function _6(H){let D=e1(H);return D?new K(D,"rgb"):null}function HW(H){let D=H.match(/^#([0-9A-Fa-f])([0-9A-Fa-f])([0-9A-Fa-f])([0-9A-Fa-f])$/);if(D)return[parseInt(D[1]+D[1],16),parseInt(D[2]+D[2],16),parseInt(D[3]+D[3],16),F(parseInt(D[4]+D[4],16),0,255,0,1)];let W=H.match(/^(?:#|0x)?([0-9A-Fa-f]{2})([0-9A-Fa-f]{2})([0-9A-Fa-f]{2})([0-9A-Fa-f]{2})$/);if(W)return[parseInt(W[1],16),parseInt(W[2],16),parseInt(W[3],16),F(parseInt(W[4],16),0,255,0,1)];return null}function C6(H){let D=HW(H);return D?new K(D,"rgb"):null}function DW(H){let D=H.match(/^\{\s*r\s*:\s*([0-9A-Fa-f.]+%?)\s*,\s*g\s*:\s*([0-9A-Fa-f.]+%?)\s*,\s*b\s*:\s*([0-9A-Fa-f.]+%?)\s*\}$/);if(!D)return null;let W=[parseFloat(D[1]),parseFloat(D[2]),parseFloat(D[3])];if(isNaN(W[0])||isNaN(W[1])||isNaN(W[2]))return null;return W}function A0(H){return(D)=>{let W=DW(D);return W?iD(W,"rgb",H):null}}function WW(H){let D=H.match(/^\{\s*r\s*:\s*([0-9A-Fa-f.]+%?)\s*,\s*g\s*:\s*([0-9A-Fa-f.]+%?)\s*,\s*b\s*:\s*([0-9A-Fa-f.]+%?)\s*,\s*a\s*:\s*([0-9A-Fa-f.]+%?)\s*\}$/);if(!D)return null;let W=[parseFloat(D[1]),parseFloat(D[2]),parseFloat(D[3]),parseFloat(D[4])];if(isNaN(W[0])||isNaN(W[1])||isNaN(W[2])||isNaN(W[3]))return null;return W}function B0(H){return(D)=>{let W=WW(D);return W?iD(W,"rgb",H):null}}var x6=[{parser:e1,result:{alpha:!1,mode:"rgb",notation:"hex"}},{parser:HW,result:{alpha:!0,mode:"rgb",notation:"hex"}},{parser:l1,result:{alpha:!1,mode:"rgb",notation:"func"}},{parser:r1,result:{alpha:!0,mode:"rgb",notation:"func"}},{parser:o1,result:{alpha:!1,mode:"hsl",notation:"func"}},{parser:a1,result:{alpha:!0,mode:"hsl",notation:"func"}},{parser:DW,result:{alpha:!1,mode:"rgb",notation:"object"}},{parser:WW,result:{alpha:!0,mode:"rgb",notation:"object"}}];function b6(H){return x6.reduce((D,{parser:W,result:h})=>{if(D)return D;return W(H)?h:null},null)}function f6(H,D="int"){let W=b6(H);if(!W)return null;if(W.notation==="hex"&&D!=="float")return Object.assign(Object.assign({},W),{type:"int"});if(W.notation==="func")return Object.assign(Object.assign({},W),{type:D});return null}function bH(H){let D=[_6,C6,T6,P6,V6,E6];if(H==="int")D.push(A0("int"),B0("int"));if(H==="float")D.push(A0("float"),B0("float"));let W=J6(D);return(h)=>{let U=W(h);return U?y(U,H):null}}function d6(H){let D=bH("int");if(typeof H!=="string")return K.black();let W=D(H);return W!==null&&W!==void 0?W:K.black()}function hW(H){let D=B(Math.floor(H),0,255).toString(16);return D.length===1?`0${D}`:D}function gD(H,D="#"){let W=x(H.getComponents("rgb")).map(hW).join("");return`${D}${W}`}function tD(H,D="#"){let W=H.getComponents("rgb"),h=[W[0],W[1],W[2],W[3]*255].map(hW).join("");return`${D}${h}`}function UW(H){let D=R(0),W=y(H,"int");return`rgb(${x(W.getComponents("rgb")).map((U)=>D(U)).join(", ")})`}function mH(H){let D=R(2),W=R(0);return`rgba(${y(H,"int").getComponents("rgb").map((q,X)=>{return(X===3?D:W)(q)}).join(", ")})`}function v6(H){let D=[R(0),cH,cH],W=y(H,"int");return`hsl(${x(W.getComponents("hsl")).map((U,q)=>D[q](U)).join(", ")})`}function u6(H){let D=[R(0),cH,cH,R(2)];return`hsla(${y(H,"int").getComponents("hsl").map((U,q)=>D[q](U)).join(", ")})`}function qW(H,D){let W=R(D==="float"?2:0),h=["r","g","b"],U=y(H,D);return`{${x(U.getComponents("rgb")).map((X,J)=>`${h[J]}: ${W(X)}`).join(", ")}}`}function m6(H){return(D)=>qW(D,H)}function XW(H,D){let W=R(2),h=R(D==="float"?2:0),U=["r","g","b","a"];return`{${y(H,D).getComponents("rgb").map((J,Z)=>{let Q=Z===3?W:h;return`${U[Z]}: ${Q(J)}`}).join(", ")}}`}function i6(H){return(D)=>XW(D,H)}var g6=[{format:{alpha:!1,mode:"rgb",notation:"hex",type:"int"},stringifier:gD},{format:{alpha:!0,mode:"rgb",notation:"hex",type:"int"},stringifier:tD},{format:{alpha:!1,mode:"rgb",notation:"func",type:"int"},stringifier:UW},{format:{alpha:!0,mode:"rgb",notation:"func",type:"int"},stringifier:mH},{format:{alpha:!1,mode:"hsl",notation:"func",type:"int"},stringifier:v6},{format:{alpha:!0,mode:"hsl",notation:"func",type:"int"},stringifier:u6},...["int","float"].reduce((H,D)=>{return[...H,{format:{alpha:!1,mode:"rgb",notation:"object",type:D},stringifier:m6(D)},{format:{alpha:!0,mode:"rgb",notation:"object",type:D},stringifier:i6(D)}]},[])];function JW(H){return g6.reduce((D,W)=>{if(D)return D;return N6(W.format,H)?W.stringifier:null},null)}var SH=G("apl");class QW{constructor(H,D){this.onValueChange_=this.onValueChange_.bind(this),this.value=D.value,this.value.emitter.on("change",this.onValueChange_),this.element=H.createElement("div"),this.element.classList.add(SH()),D.viewProps.bindClassModifiers(this.element),D.viewProps.bindTabIndex(this.element);let W=H.createElement("div");W.classList.add(SH("b")),this.element.appendChild(W);let h=H.createElement("div");h.classList.add(SH("c")),W.appendChild(h),this.colorElem_=h;let U=H.createElement("div");U.classList.add(SH("m")),this.element.appendChild(U),this.markerElem_=U;let q=H.createElement("div");q.classList.add(SH("p")),this.markerElem_.appendChild(q),this.previewElem_=q,this.update_()}update_(){let H=this.value.rawValue,D=H.getComponents("rgb"),W=new K([D[0],D[1],D[2],0],"rgb"),h=new K([D[0],D[1],D[2],255],"rgb"),U=["to right",mH(W),mH(h)];this.colorElem_.style.background=`linear-gradient(${U.join(",")})`,this.previewElem_.style.backgroundColor=mH(H);let q=F(D[3],0,1,0,100);this.markerElem_.style.left=`${q}%`}onValueChange_(){this.update_()}}class ZW{constructor(H,D){this.onKeyDown_=this.onKeyDown_.bind(this),this.onKeyUp_=this.onKeyUp_.bind(this),this.onPointerDown_=this.onPointerDown_.bind(this),this.onPointerMove_=this.onPointerMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.value=D.value,this.viewProps=D.viewProps,this.view=new QW(H,{value:this.value,viewProps:this.viewProps}),this.ptHandler_=new o(this.view.element),this.ptHandler_.emitter.on("down",this.onPointerDown_),this.ptHandler_.emitter.on("move",this.onPointerMove_),this.ptHandler_.emitter.on("up",this.onPointerUp_),this.view.element.addEventListener("keydown",this.onKeyDown_),this.view.element.addEventListener("keyup",this.onKeyUp_)}handlePointerEvent_(H,D){if(!H.point)return;let W=H.point.x/H.bounds.width,h=this.value.rawValue,[U,q,X]=h.getComponents("hsv");this.value.setRawValue(new K([U,q,X,W],"hsv"),D)}onPointerDown_(H){this.handlePointerEvent_(H.data,{forceEmit:!1,last:!1})}onPointerMove_(H){this.handlePointerEvent_(H.data,{forceEmit:!1,last:!1})}onPointerUp_(H){this.handlePointerEvent_(H.data,{forceEmit:!0,last:!0})}onKeyDown_(H){let D=S(UH(!0),g(H));if(D===0)return;let W=this.value.rawValue,[h,U,q,X]=W.getComponents("hsv");this.value.setRawValue(new K([h,U,q,X+D],"hsv"),{forceEmit:!1,last:!1})}onKeyUp_(H){if(S(UH(!0),g(H))===0)return;this.value.setRawValue(this.value.rawValue,{forceEmit:!0,last:!0})}}var JH=G("coltxt");function t6(H){let D=H.createElement("select"),W=[{text:"RGB",value:"rgb"},{text:"HSL",value:"hsl"},{text:"HSV",value:"hsv"},{text:"HEX",value:"hex"}];return D.appendChild(W.reduce((h,U)=>{let q=H.createElement("option");return q.textContent=U.text,q.value=U.value,h.appendChild(q),h},H.createDocumentFragment())),D}class YW{constructor(H,D){this.element=H.createElement("div"),this.element.classList.add(JH()),D.viewProps.bindClassModifiers(this.element);let W=H.createElement("div");W.classList.add(JH("m")),this.modeElem_=t6(H),this.modeElem_.classList.add(JH("ms")),W.appendChild(this.modeSelectElement),D.viewProps.bindDisabled(this.modeElem_);let h=H.createElement("div");h.classList.add(JH("mm")),h.appendChild(lH(H,"dropdown")),W.appendChild(h),this.element.appendChild(W);let U=H.createElement("div");U.classList.add(JH("w")),this.element.appendChild(U),this.inputsElem_=U,this.inputViews_=D.inputViews,this.applyInputViews_(),v(D.mode,(q)=>{this.modeElem_.value=q})}get modeSelectElement(){return this.modeElem_}get inputViews(){return this.inputViews_}set inputViews(H){this.inputViews_=H,this.applyInputViews_()}applyInputViews_(){h1(this.inputsElem_);let H=this.element.ownerDocument;this.inputViews_.forEach((D)=>{let W=H.createElement("div");W.classList.add(JH("c")),W.appendChild(D.element),this.inputsElem_.appendChild(W)})}}function p6(H){return R(H==="float"?2:0)}function s6(H,D,W){let h=zH(H,D)[W];return new OH({min:0,max:h})}function n6(H,D,W){return new MH(H,{arrayPosition:W===0?"fst":W===2?"lst":"mid",parser:D.parser,props:z.fromObject({formatter:p6(D.colorType),keyScale:UH(!1),pointerScale:D.colorType==="float"?0.01:1}),value:w(0,{constraint:s6(D.colorMode,D.colorType,W)}),viewProps:D.viewProps})}function c6(H,D){let W={colorMode:D.colorMode,colorType:D.colorType,parser:m,viewProps:D.viewProps};return[0,1,2].map((h)=>{let U=n6(H,W,h);return $H({primary:D.value,secondary:U.value,forward(q){return y(q,D.colorType).getComponents(D.colorMode)[h]},backward(q,X){let J=D.colorMode,Q=y(q,D.colorType).getComponents(J);Q[h]=X;let Y=iD(HD(x(Q),Q[3]),J,D.colorType);return y(Y,"int")}}),U})}function l6(H,D){let W=new YH(H,{parser:bH("int"),props:z.fromObject({formatter:gD}),value:w(K.black()),viewProps:D.viewProps});return $H({primary:D.value,secondary:W.value,forward:(h)=>new K(x(h.getComponents()),h.mode),backward:(h,U)=>new K(HD(x(U.getComponents(h.mode)),h.getComponents()[3]),h.mode)}),[W]}function r6(H){return H!=="hex"}class zW{constructor(H,D){this.onModeSelectChange_=this.onModeSelectChange_.bind(this),this.colorType_=D.colorType,this.value=D.value,this.viewProps=D.viewProps,this.colorMode=w(this.value.rawValue.mode),this.ccs_=this.createComponentControllers_(H),this.view=new YW(H,{mode:this.colorMode,inputViews:[this.ccs_[0].view,this.ccs_[1].view,this.ccs_[2].view],viewProps:this.viewProps}),this.view.modeSelectElement.addEventListener("change",this.onModeSelectChange_)}createComponentControllers_(H){let D=this.colorMode.rawValue;if(r6(D))return c6(H,{colorMode:D,colorType:this.colorType_,value:this.value,viewProps:this.viewProps});return l6(H,{value:this.value,viewProps:this.viewProps})}onModeSelectChange_(H){let D=H.currentTarget;this.colorMode.rawValue=D.value,this.ccs_=this.createComponentControllers_(this.view.element.ownerDocument),this.view.inputViews=this.ccs_.map((W)=>W.view)}}var GD=G("hpl");class OW{constructor(H,D){this.onValueChange_=this.onValueChange_.bind(this),this.value=D.value,this.value.emitter.on("change",this.onValueChange_),this.element=H.createElement("div"),this.element.classList.add(GD()),D.viewProps.bindClassModifiers(this.element),D.viewProps.bindTabIndex(this.element);let W=H.createElement("div");W.classList.add(GD("c")),this.element.appendChild(W);let h=H.createElement("div");h.classList.add(GD("m")),this.element.appendChild(h),this.markerElem_=h,this.update_()}update_(){let H=this.value.rawValue,[D]=H.getComponents("hsv");this.markerElem_.style.backgroundColor=UW(new K([D,100,100],"hsv"));let W=F(D,0,360,0,100);this.markerElem_.style.left=`${W}%`}onValueChange_(){this.update_()}}class GW{constructor(H,D){this.onKeyDown_=this.onKeyDown_.bind(this),this.onKeyUp_=this.onKeyUp_.bind(this),this.onPointerDown_=this.onPointerDown_.bind(this),this.onPointerMove_=this.onPointerMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.value=D.value,this.viewProps=D.viewProps,this.view=new OW(H,{value:this.value,viewProps:this.viewProps}),this.ptHandler_=new o(this.view.element),this.ptHandler_.emitter.on("down",this.onPointerDown_),this.ptHandler_.emitter.on("move",this.onPointerMove_),this.ptHandler_.emitter.on("up",this.onPointerUp_),this.view.element.addEventListener("keydown",this.onKeyDown_),this.view.element.addEventListener("keyup",this.onKeyUp_)}handlePointerEvent_(H,D){if(!H.point)return;let W=F(B(H.point.x,0,H.bounds.width),0,H.bounds.width,0,360),h=this.value.rawValue,[,U,q,X]=h.getComponents("hsv");this.value.setRawValue(new K([W,U,q,X],"hsv"),D)}onPointerDown_(H){this.handlePointerEvent_(H.data,{forceEmit:!1,last:!1})}onPointerMove_(H){this.handlePointerEvent_(H.data,{forceEmit:!1,last:!1})}onPointerUp_(H){this.handlePointerEvent_(H.data,{forceEmit:!0,last:!0})}onKeyDown_(H){let D=S(UH(!1),g(H));if(D===0)return;let W=this.value.rawValue,[h,U,q,X]=W.getComponents("hsv");this.value.setRawValue(new K([h+D,U,q,X],"hsv"),{forceEmit:!1,last:!1})}onKeyUp_(H){if(S(UH(!1),g(H))===0)return;this.value.setRawValue(this.value.rawValue,{forceEmit:!0,last:!0})}}var KD=G("svp"),y0=64;class KW{constructor(H,D){this.onValueChange_=this.onValueChange_.bind(this),this.value=D.value,this.value.emitter.on("change",this.onValueChange_),this.element=H.createElement("div"),this.element.classList.add(KD()),D.viewProps.bindClassModifiers(this.element),D.viewProps.bindTabIndex(this.element);let W=H.createElement("canvas");W.height=y0,W.width=y0,W.classList.add(KD("c")),this.element.appendChild(W),this.canvasElement=W;let h=H.createElement("div");h.classList.add(KD("m")),this.element.appendChild(h),this.markerElem_=h,this.update_()}update_(){let H=C5(this.canvasElement);if(!H)return;let W=this.value.rawValue.getComponents("hsv"),h=this.canvasElement.width,U=this.canvasElement.height,q=H.getImageData(0,0,h,U),X=q.data;for(let Q=0;Q<U;Q++)for(let Y=0;Y<h;Y++){let O=F(Y,0,h,0,100),A=F(Q,0,U,100,0),XH=g1(W[0],O,A),E=(Q*h+Y)*4;X[E]=XH[0],X[E+1]=XH[1],X[E+2]=XH[2],X[E+3]=255}H.putImageData(q,0,0);let J=F(W[1],0,100,0,100);this.markerElem_.style.left=`${J}%`;let Z=F(W[2],0,100,100,0);this.markerElem_.style.top=`${Z}%`}onValueChange_(){this.update_()}}class FW{constructor(H,D){this.onKeyDown_=this.onKeyDown_.bind(this),this.onKeyUp_=this.onKeyUp_.bind(this),this.onPointerDown_=this.onPointerDown_.bind(this),this.onPointerMove_=this.onPointerMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.value=D.value,this.viewProps=D.viewProps,this.view=new KW(H,{value:this.value,viewProps:this.viewProps}),this.ptHandler_=new o(this.view.element),this.ptHandler_.emitter.on("down",this.onPointerDown_),this.ptHandler_.emitter.on("move",this.onPointerMove_),this.ptHandler_.emitter.on("up",this.onPointerUp_),this.view.element.addEventListener("keydown",this.onKeyDown_),this.view.element.addEventListener("keyup",this.onKeyUp_)}handlePointerEvent_(H,D){if(!H.point)return;let W=F(H.point.x,0,H.bounds.width,0,100),h=F(H.point.y,0,H.bounds.height,100,0),[U,,,q]=this.value.rawValue.getComponents("hsv");this.value.setRawValue(new K([U,W,h,q],"hsv"),D)}onPointerDown_(H){this.handlePointerEvent_(H.data,{forceEmit:!1,last:!1})}onPointerMove_(H){this.handlePointerEvent_(H.data,{forceEmit:!1,last:!1})}onPointerUp_(H){this.handlePointerEvent_(H.data,{forceEmit:!0,last:!0})}onKeyDown_(H){if(E1(H.key))H.preventDefault();let[D,W,h,U]=this.value.rawValue.getComponents("hsv"),q=UH(!1),X=S(q,g(H)),J=S(q,kH(H));if(X===0&&J===0)return;this.value.setRawValue(new K([D,W+X,h+J,U],"hsv"),{forceEmit:!1,last:!1})}onKeyUp_(H){let D=UH(!1),W=S(D,g(H)),h=S(D,kH(H));if(W===0&&h===0)return;this.value.setRawValue(this.value.rawValue,{forceEmit:!0,last:!0})}}class LW{constructor(H,D){if(this.value=D.value,this.viewProps=D.viewProps,this.hPaletteC_=new GW(H,{value:this.value,viewProps:this.viewProps}),this.svPaletteC_=new FW(H,{value:this.value,viewProps:this.viewProps}),this.alphaIcs_=D.supportsAlpha?{palette:new ZW(H,{value:this.value,viewProps:this.viewProps}),text:new MH(H,{parser:m,props:z.fromObject({pointerScale:0.01,keyScale:0.1,formatter:R(2)}),value:w(0,{constraint:new OH({min:0,max:1})}),viewProps:this.viewProps})}:null,this.alphaIcs_)$H({primary:this.value,secondary:this.alphaIcs_.text.value,forward:(W)=>W.getComponents()[3],backward:(W,h)=>{let U=W.getComponents();return U[3]=h,new K(U,W.mode)}});this.textsC_=new zW(H,{colorType:D.colorType,value:this.value,viewProps:this.viewProps}),this.view=new s1(H,{alphaViews:this.alphaIcs_?{palette:this.alphaIcs_.palette.view,text:this.alphaIcs_.text.view}:null,hPaletteView:this.hPaletteC_.view,supportsAlpha:D.supportsAlpha,svPaletteView:this.svPaletteC_.view,textsView:this.textsC_.view,viewProps:this.viewProps})}get textsController(){return this.textsC_}}var FD=G("colsw");class wW{constructor(H,D){this.onValueChange_=this.onValueChange_.bind(this),D.value.emitter.on("change",this.onValueChange_),this.value=D.value,this.element=H.createElement("div"),this.element.classList.add(FD()),D.viewProps.bindClassModifiers(this.element);let W=H.createElement("div");W.classList.add(FD("sw")),this.element.appendChild(W),this.swatchElem_=W;let h=H.createElement("button");h.classList.add(FD("b")),D.viewProps.bindDisabled(h),this.element.appendChild(h),this.buttonElement=h,this.update_()}update_(){let H=this.value.rawValue;this.swatchElem_.style.backgroundColor=tD(H)}onValueChange_(){this.update_()}}class IW{constructor(H,D){this.value=D.value,this.viewProps=D.viewProps,this.view=new wW(H,{value:this.value,viewProps:this.viewProps})}}class WD{constructor(H,D){this.onButtonBlur_=this.onButtonBlur_.bind(this),this.onButtonClick_=this.onButtonClick_.bind(this),this.onPopupChildBlur_=this.onPopupChildBlur_.bind(this),this.onPopupChildKeydown_=this.onPopupChildKeydown_.bind(this),this.value=D.value,this.viewProps=D.viewProps,this.foldable_=_H.create(D.expanded),this.swatchC_=new IW(H,{value:this.value,viewProps:this.viewProps});let W=this.swatchC_.view.buttonElement;W.addEventListener("blur",this.onButtonBlur_),W.addEventListener("click",this.onButtonClick_),this.textC_=new YH(H,{parser:D.parser,props:z.fromObject({formatter:D.formatter}),value:this.value,viewProps:this.viewProps}),this.view=new i1(H,{foldable:this.foldable_,pickerLayout:D.pickerLayout}),this.view.swatchElement.appendChild(this.swatchC_.view.element),this.view.textElement.appendChild(this.textC_.view.element),this.popC_=D.pickerLayout==="popup"?new uD(H,{viewProps:this.viewProps}):null;let h=new LW(H,{colorType:D.colorType,supportsAlpha:D.supportsAlpha,value:this.value,viewProps:this.viewProps});if(h.view.allFocusableElements.forEach((U)=>{U.addEventListener("blur",this.onPopupChildBlur_),U.addEventListener("keydown",this.onPopupChildKeydown_)}),this.pickerC_=h,this.popC_)this.view.element.appendChild(this.popC_.view.element),this.popC_.view.element.appendChild(h.view.element),$H({primary:this.foldable_.value("expanded"),secondary:this.popC_.shows,forward:(U)=>U,backward:(U,q)=>q});else if(this.view.pickerElement)this.view.pickerElement.appendChild(this.pickerC_.view.element),bD(this.foldable_,this.view.pickerElement)}get textController(){return this.textC_}onButtonBlur_(H){if(!this.popC_)return;let D=this.view.element,W=N(H.relatedTarget);if(!W||!D.contains(W))this.popC_.shows.rawValue=!1}onButtonClick_(){if(this.foldable_.set("expanded",!this.foldable_.get("expanded")),this.foldable_.get("expanded"))this.pickerC_.view.allFocusableElements[0].focus()}onPopupChildBlur_(H){if(!this.popC_)return;let D=this.popC_.view.element,W=U1(H);if(W&&D.contains(W))return;if(W&&W===this.swatchC_.view.buttonElement&&!TD(D.ownerDocument))return;this.popC_.shows.rawValue=!1}onPopupChildKeydown_(H){if(this.popC_){if(H.key==="Escape")this.popC_.shows.rawValue=!1}else if(this.view.pickerElement){if(H.key==="Escape")this.swatchC_.view.buttonElement.focus()}}}function o6(H){return x(H.getComponents("rgb")).reduce((D,W)=>{return D<<8|Math.floor(W)&255},0)}function a6(H){return H.getComponents("rgb").reduce((D,W,h)=>{let U=Math.floor(h===3?W*255:W)&255;return D<<8|U},0)>>>0}function e6(H){return new K([H>>16&255,H>>8&255,H&255],"rgb")}function Hh(H){return new K([H>>24&255,H>>16&255,H>>8&255,F(H&255,0,255,0,1)],"rgb")}function Dh(H){if(typeof H!=="number")return K.black();return e6(H)}function Wh(H){if(typeof H!=="number")return K.black();return Hh(H)}function iH(H,D){if(typeof H!=="object"||L(H))return!1;return D in H&&typeof H[D]==="number"}function $W(H){return iH(H,"r")&&iH(H,"g")&&iH(H,"b")}function MW(H){return $W(H)&&iH(H,"a")}function AW(H){return $W(H)}function pD(H,D){if(H.mode!==D.mode)return!1;if(H.type!==D.type)return!1;let W=H.getComponents(),h=D.getComponents();for(let U=0;U<W.length;U++)if(W[U]!==h[U])return!1;return!0}function j0(H){return"a"in H?[H.r,H.g,H.b,H.a]:[H.r,H.g,H.b]}function hh(H){let D=JW(H);return D?(W,h)=>{xH(W,D(h))}:null}function Uh(H){let D=H?a6:o6;return(W,h)=>{xH(W,D(h))}}function qh(H,D,W){let U=y(D,W).toRgbaObject();H.writeProperty("r",U.r),H.writeProperty("g",U.g),H.writeProperty("b",U.b),H.writeProperty("a",U.a)}function Xh(H,D,W){let U=y(D,W).toRgbaObject();H.writeProperty("r",U.r),H.writeProperty("g",U.g),H.writeProperty("b",U.b)}function Jh(H,D){return(W,h)=>{if(H)qh(W,h,D);else Xh(W,h,D)}}function Qh(H){var D;if((D=H===null||H===void 0?void 0:H.color)===null||D===void 0?void 0:D.alpha)return!0;return!1}function Zh(H){return H?(D)=>tD(D,"0x"):(D)=>gD(D,"0x")}function Yh(H){if("color"in H)return!0;if(H.view==="color")return!0;return!1}var zh=j({id:"input-color-number",type:"input",accept:(H,D)=>{if(typeof H!=="number")return null;if(!Yh(D))return null;let W=mD(D);return W?{initialValue:H,params:Object.assign(Object.assign({},W),{supportsAlpha:Qh(D)})}:null},binding:{reader:(H)=>{return H.params.supportsAlpha?Wh:Dh},equals:pD,writer:(H)=>{return Uh(H.params.supportsAlpha)}},controller:(H)=>{var D,W;return new WD(H.document,{colorType:"int",expanded:(D=H.params.expanded)!==null&&D!==void 0?D:!1,formatter:Zh(H.params.supportsAlpha),parser:bH("int"),pickerLayout:(W=H.params.picker)!==null&&W!==void 0?W:"popup",supportsAlpha:H.params.supportsAlpha,value:H.value,viewProps:H.viewProps})}});function Oh(H,D){if(!AW(H))return y(K.black(),D);if(D==="int"){let W=j0(H);return new K(W,"rgb")}if(D==="float"){let W=j0(H);return new DD(W,"rgb")}return y(K.black(),"int")}function Gh(H){return MW(H)}function Kh(H){return(D)=>{let W=Oh(D,H);return y(W,"int")}}function Fh(H,D){return(W)=>{if(H)return XW(W,D);return qW(W,D)}}var Lh=j({id:"input-color-object",type:"input",accept:(H,D)=>{var W;if(!AW(H))return null;let h=mD(D);return h?{initialValue:H,params:Object.assign(Object.assign({},h),{colorType:(W=n1(D))!==null&&W!==void 0?W:"int"})}:null},binding:{reader:(H)=>Kh(H.params.colorType),equals:pD,writer:(H)=>Jh(Gh(H.initialValue),H.params.colorType)},controller:(H)=>{var D,W;let h=MW(H.initialValue);return new WD(H.document,{colorType:H.params.colorType,expanded:(D=H.params.expanded)!==null&&D!==void 0?D:!1,formatter:Fh(h,H.params.colorType),parser:bH("int"),pickerLayout:(W=H.params.picker)!==null&&W!==void 0?W:"popup",supportsAlpha:h,value:H.value,viewProps:H.viewProps})}}),wh=j({id:"input-color-string",type:"input",accept:(H,D)=>{if(typeof H!=="string")return null;if(D.view==="text")return null;let W=f6(H,n1(D));if(!W)return null;let h=JW(W);if(!h)return null;let U=mD(D);return U?{initialValue:H,params:Object.assign(Object.assign({},U),{format:W,stringifier:h})}:null},binding:{reader:()=>d6,equals:pD,writer:(H)=>{let D=hh(H.params.format);if(!D)throw $.notBindable();return D}},controller:(H)=>{var D,W;return new WD(H.document,{colorType:H.params.format.type,expanded:(D=H.params.expanded)!==null&&D!==void 0?D:!1,formatter:H.params.stringifier,parser:bH("int"),pickerLayout:(W=H.params.picker)!==null&&W!==void 0?W:"popup",supportsAlpha:H.params.format.alpha,value:H.value,viewProps:H.viewProps})}});class hD{constructor(H){this.components=H.components,this.asm_=H.assembly}constrain(H){let D=this.asm_.toComponents(H).map((W,h)=>{var U,q;return(q=(U=this.components[h])===null||U===void 0?void 0:U.constrain(W))!==null&&q!==void 0?q:W});return this.asm_.fromComponents(D)}}var S0=G("pndtxt");class BW{constructor(H,D){this.textViews=D.textViews,this.element=H.createElement("div"),this.element.classList.add(S0()),this.textViews.forEach((W)=>{let h=H.createElement("div");h.classList.add(S0("a")),h.appendChild(W.element),this.element.appendChild(h)})}}function Ih(H,D,W){return new MH(H,{arrayPosition:W===0?"fst":W===D.axes.length-1?"lst":"mid",parser:D.parser,props:D.axes[W].textProps,value:w(0,{constraint:D.axes[W].constraint}),viewProps:D.viewProps})}class UD{constructor(H,D){this.value=D.value,this.viewProps=D.viewProps,this.acs_=D.axes.map((W,h)=>Ih(H,D,h)),this.acs_.forEach((W,h)=>{$H({primary:this.value,secondary:W.value,forward:(U)=>D.assembly.toComponents(U)[h],backward:(U,q)=>{let X=D.assembly.toComponents(U);return X[h]=q,D.assembly.fromComponents(X)}})}),this.view=new BW(H,{textViews:this.acs_.map((W)=>W.view)})}get textControllers(){return this.acs_}}class yW extends ZH{get max(){return this.controller.valueController.sliderController.props.get("max")}set max(H){this.controller.valueController.sliderController.props.set("max",H)}get min(){return this.controller.valueController.sliderController.props.get("min")}set min(H){this.controller.valueController.sliderController.props.set("min",H)}}function $h(H,D){let W=[],h=n0(H,D);if(h)W.push(h);let U=c0(H);if(U)W.push(U);let q=vD(H.options);if(q)W.push(q);return new wH(W)}var Mh=j({id:"input-number",type:"input",accept:(H,D)=>{if(typeof H!=="number")return null;let W=I(D,(h)=>Object.assign(Object.assign({},r0(h)),{options:h.optional.custom(CH),readonly:h.optional.constant(!1)}));return W?{initialValue:H,params:W}:null},binding:{reader:(H)=>g0,constraint:(H)=>$h(H.params,H.initialValue),writer:(H)=>xH},controller:(H)=>{let{value:D,constraint:W}=H,h=W&&nH(W,IH);if(h)return new i(H.document,{props:new z({options:h.values.value("options")}),value:D,viewProps:H.viewProps});let U=l0(H.params,D.rawValue),q=W&&nH(W,OH);if(q)return new TH(H.document,Object.assign(Object.assign({},f1(Object.assign(Object.assign({},U),{keyScale:w(U.keyScale),max:q.values.value("max"),min:q.values.value("min")}))),{parser:m,value:D,viewProps:H.viewProps}));return new MH(H.document,{parser:m,props:z.fromObject(U),value:D,viewProps:H.viewProps})},api(H){if(typeof H.controller.value.rawValue!=="number")return null;if(H.controller.valueController instanceof TH)return new yW(H.controller);if(H.controller.valueController instanceof i)return new eH(H.controller);return null}});class u{constructor(H=0,D=0){this.x=H,this.y=D}getComponents(){return[this.x,this.y]}static isObject(H){if(L(H))return!1;let{x:D,y:W}=H;if(typeof D!=="number"||typeof W!=="number")return!1;return!0}static equals(H,D){return H.x===D.x&&H.y===D.y}toObject(){return{x:this.x,y:this.y}}}var jW={toComponents:(H)=>H.getComponents(),fromComponents:(H)=>new u(...H)},QH=G("p2d");class SW{constructor(H,D){this.element=H.createElement("div"),this.element.classList.add(QH()),D.viewProps.bindClassModifiers(this.element),v(D.expanded,KH(this.element,QH(void 0,"expanded")));let W=H.createElement("div");W.classList.add(QH("h")),this.element.appendChild(W);let h=H.createElement("button");h.classList.add(QH("b")),h.appendChild(lH(H,"p2dpad")),D.viewProps.bindDisabled(h),W.appendChild(h),this.buttonElement=h;let U=H.createElement("div");if(U.classList.add(QH("t")),W.appendChild(U),this.textElement=U,D.pickerLayout==="inline"){let q=H.createElement("div");q.classList.add(QH("p")),this.element.appendChild(q),this.pickerElement=q}else this.pickerElement=null}}var s=G("p2dp");class RW{constructor(H,D){if(this.onFoldableChange_=this.onFoldableChange_.bind(this),this.onPropsChange_=this.onPropsChange_.bind(this),this.onValueChange_=this.onValueChange_.bind(this),this.props_=D.props,this.props_.emitter.on("change",this.onPropsChange_),this.element=H.createElement("div"),this.element.classList.add(s()),D.layout==="popup")this.element.classList.add(s(void 0,"p"));D.viewProps.bindClassModifiers(this.element);let W=H.createElement("div");W.classList.add(s("p")),D.viewProps.bindTabIndex(W),this.element.appendChild(W),this.padElement=W;let h=H.createElementNS(_,"svg");h.classList.add(s("g")),this.padElement.appendChild(h),this.svgElem_=h;let U=H.createElementNS(_,"line");U.classList.add(s("ax")),U.setAttributeNS(null,"x1","0"),U.setAttributeNS(null,"y1","50%"),U.setAttributeNS(null,"x2","100%"),U.setAttributeNS(null,"y2","50%"),this.svgElem_.appendChild(U);let q=H.createElementNS(_,"line");q.classList.add(s("ax")),q.setAttributeNS(null,"x1","50%"),q.setAttributeNS(null,"y1","0"),q.setAttributeNS(null,"x2","50%"),q.setAttributeNS(null,"y2","100%"),this.svgElem_.appendChild(q);let X=H.createElementNS(_,"line");X.classList.add(s("l")),X.setAttributeNS(null,"x1","50%"),X.setAttributeNS(null,"y1","50%"),this.svgElem_.appendChild(X),this.lineElem_=X;let J=H.createElement("div");J.classList.add(s("m")),this.padElement.appendChild(J),this.markerElem_=J,D.value.emitter.on("change",this.onValueChange_),this.value=D.value,this.update_()}get allFocusableElements(){return[this.padElement]}update_(){let[H,D]=this.value.rawValue.getComponents(),W=this.props_.get("max"),h=F(H,-W,+W,0,100),U=F(D,-W,+W,0,100),q=this.props_.get("invertsY")?100-U:U;this.lineElem_.setAttributeNS(null,"x2",`${h}%`),this.lineElem_.setAttributeNS(null,"y2",`${q}%`),this.markerElem_.style.left=`${h}%`,this.markerElem_.style.top=`${q}%`}onValueChange_(){this.update_()}onPropsChange_(){this.update_()}onFoldableChange_(){this.update_()}}function R0(H,D,W){return[S(D[0],g(H)),S(D[1],kH(H))*(W?1:-1)]}class NW{constructor(H,D){this.onPadKeyDown_=this.onPadKeyDown_.bind(this),this.onPadKeyUp_=this.onPadKeyUp_.bind(this),this.onPointerDown_=this.onPointerDown_.bind(this),this.onPointerMove_=this.onPointerMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.props=D.props,this.value=D.value,this.viewProps=D.viewProps,this.view=new RW(H,{layout:D.layout,props:this.props,value:this.value,viewProps:this.viewProps}),this.ptHandler_=new o(this.view.padElement),this.ptHandler_.emitter.on("down",this.onPointerDown_),this.ptHandler_.emitter.on("move",this.onPointerMove_),this.ptHandler_.emitter.on("up",this.onPointerUp_),this.view.padElement.addEventListener("keydown",this.onPadKeyDown_),this.view.padElement.addEventListener("keyup",this.onPadKeyUp_)}handlePointerEvent_(H,D){if(!H.point)return;let W=this.props.get("max"),h=F(H.point.x,0,H.bounds.width,-W,+W),U=F(this.props.get("invertsY")?H.bounds.height-H.point.y:H.point.y,0,H.bounds.height,-W,+W);this.value.setRawValue(new u(h,U),D)}onPointerDown_(H){this.handlePointerEvent_(H.data,{forceEmit:!1,last:!1})}onPointerMove_(H){this.handlePointerEvent_(H.data,{forceEmit:!1,last:!1})}onPointerUp_(H){this.handlePointerEvent_(H.data,{forceEmit:!0,last:!0})}onPadKeyDown_(H){if(E1(H.key))H.preventDefault();let[D,W]=R0(H,[this.props.get("xKeyScale"),this.props.get("yKeyScale")],this.props.get("invertsY"));if(D===0&&W===0)return;this.value.setRawValue(new u(this.value.rawValue.x+D,this.value.rawValue.y+W),{forceEmit:!1,last:!1})}onPadKeyUp_(H){let[D,W]=R0(H,[this.props.get("xKeyScale"),this.props.get("yKeyScale")],this.props.get("invertsY"));if(D===0&&W===0)return;this.value.setRawValue(this.value.rawValue,{forceEmit:!0,last:!0})}}class kW{constructor(H,D){var W,h;this.onPopupChildBlur_=this.onPopupChildBlur_.bind(this),this.onPopupChildKeydown_=this.onPopupChildKeydown_.bind(this),this.onPadButtonBlur_=this.onPadButtonBlur_.bind(this),this.onPadButtonClick_=this.onPadButtonClick_.bind(this),this.value=D.value,this.viewProps=D.viewProps,this.foldable_=_H.create(D.expanded),this.popC_=D.pickerLayout==="popup"?new uD(H,{viewProps:this.viewProps}):null;let U=new NW(H,{layout:D.pickerLayout,props:new z({invertsY:w(D.invertsY),max:w(D.max),xKeyScale:D.axes[0].textProps.value("keyScale"),yKeyScale:D.axes[1].textProps.value("keyScale")}),value:this.value,viewProps:this.viewProps});if(U.view.allFocusableElements.forEach((q)=>{q.addEventListener("blur",this.onPopupChildBlur_),q.addEventListener("keydown",this.onPopupChildKeydown_)}),this.pickerC_=U,this.textC_=new UD(H,{assembly:jW,axes:D.axes,parser:D.parser,value:this.value,viewProps:this.viewProps}),this.view=new SW(H,{expanded:this.foldable_.value("expanded"),pickerLayout:D.pickerLayout,viewProps:this.viewProps}),this.view.textElement.appendChild(this.textC_.view.element),(W=this.view.buttonElement)===null||W===void 0||W.addEventListener("blur",this.onPadButtonBlur_),(h=this.view.buttonElement)===null||h===void 0||h.addEventListener("click",this.onPadButtonClick_),this.popC_)this.view.element.appendChild(this.popC_.view.element),this.popC_.view.element.appendChild(this.pickerC_.view.element),$H({primary:this.foldable_.value("expanded"),secondary:this.popC_.shows,forward:(q)=>q,backward:(q,X)=>X});else if(this.view.pickerElement)this.view.pickerElement.appendChild(this.pickerC_.view.element),bD(this.foldable_,this.view.pickerElement)}get textController(){return this.textC_}onPadButtonBlur_(H){if(!this.popC_)return;let D=this.view.element,W=N(H.relatedTarget);if(!W||!D.contains(W))this.popC_.shows.rawValue=!1}onPadButtonClick_(){if(this.foldable_.set("expanded",!this.foldable_.get("expanded")),this.foldable_.get("expanded"))this.pickerC_.view.allFocusableElements[0].focus()}onPopupChildBlur_(H){if(!this.popC_)return;let D=this.popC_.view.element,W=U1(H);if(W&&D.contains(W))return;if(W&&W===this.view.buttonElement&&!TD(D.ownerDocument))return;this.popC_.shows.rawValue=!1}onPopupChildKeydown_(H){if(this.popC_){if(H.key==="Escape")this.popC_.shows.rawValue=!1}else if(this.view.pickerElement){if(H.key==="Escape")this.view.buttonElement.focus()}}}function Ah(H){return u.isObject(H)?new u(H.x,H.y):new u}function Bh(H,D){H.writeProperty("x",D.x),H.writeProperty("y",D.y)}function yh(H,D){return new hD({assembly:jW,components:[d(Object.assign(Object.assign({},H),H.x),D.x),d(Object.assign(Object.assign({},H),H.y),D.y)]})}function N0(H,D){var W,h;if(!L(H.min)||!L(H.max))return Math.max(Math.abs((W=H.min)!==null&&W!==void 0?W:0),Math.abs((h=H.max)!==null&&h!==void 0?h:0));let U=p0(H);return Math.max(Math.abs(U)*10,Math.abs(D)*10)}function jh(H,D){var W,h;let U=N0(hH(H,(W=H.x)!==null&&W!==void 0?W:{}),D.x),q=N0(hH(H,(h=H.y)!==null&&h!==void 0?h:{}),D.y);return Math.max(U,q)}function Sh(H){if(!("y"in H))return!1;let D=H.y;if(!D)return!1;return"inverted"in D?!!D.inverted:!1}var Rh=j({id:"input-point2d",type:"input",accept:(H,D)=>{if(!u.isObject(H))return null;let W=I(D,(h)=>Object.assign(Object.assign({},PH(h)),{expanded:h.optional.boolean,picker:h.optional.custom(v1),readonly:h.optional.constant(!1),x:h.optional.custom(c),y:h.optional.object(Object.assign(Object.assign({},PH(h)),{inverted:h.optional.boolean}))}));return W?{initialValue:H,params:W}:null},binding:{reader:()=>Ah,constraint:(H)=>yh(H.params,H.initialValue),equals:u.equals,writer:()=>Bh},controller:(H)=>{var D,W;let{document:h,value:U,constraint:q}=H,X=[H.params.x,H.params.y];return new kW(h,{axes:U.rawValue.getComponents().map((J,Z)=>{var Q;return kD({constraint:q.components[Z],initialValue:J,params:hH(H.params,(Q=X[Z])!==null&&Q!==void 0?Q:{})})}),expanded:(D=H.params.expanded)!==null&&D!==void 0?D:!1,invertsY:Sh(H.params),max:jh(H.params,U.rawValue),parser:m,pickerLayout:(W=H.params.picker)!==null&&W!==void 0?W:"popup",value:U,viewProps:H.viewProps})}});class DH{constructor(H=0,D=0,W=0){this.x=H,this.y=D,this.z=W}getComponents(){return[this.x,this.y,this.z]}static isObject(H){if(L(H))return!1;let{x:D,y:W,z:h}=H;if(typeof D!=="number"||typeof W!=="number"||typeof h!=="number")return!1;return!0}static equals(H,D){return H.x===D.x&&H.y===D.y&&H.z===D.z}toObject(){return{x:this.x,y:this.y,z:this.z}}}var TW={toComponents:(H)=>H.getComponents(),fromComponents:(H)=>new DH(...H)};function Nh(H){return DH.isObject(H)?new DH(H.x,H.y,H.z):new DH}function kh(H,D){H.writeProperty("x",D.x),H.writeProperty("y",D.y),H.writeProperty("z",D.z)}function Th(H,D){return new hD({assembly:TW,components:[d(Object.assign(Object.assign({},H),H.x),D.x),d(Object.assign(Object.assign({},H),H.y),D.y),d(Object.assign(Object.assign({},H),H.z),D.z)]})}var Ph=j({id:"input-point3d",type:"input",accept:(H,D)=>{if(!DH.isObject(H))return null;let W=I(D,(h)=>Object.assign(Object.assign({},PH(h)),{readonly:h.optional.constant(!1),x:h.optional.custom(c),y:h.optional.custom(c),z:h.optional.custom(c)}));return W?{initialValue:H,params:W}:null},binding:{reader:(H)=>Nh,constraint:(H)=>Th(H.params,H.initialValue),equals:DH.equals,writer:(H)=>kh},controller:(H)=>{let{value:D,constraint:W}=H,h=[H.params.x,H.params.y,H.params.z];return new UD(H.document,{assembly:TW,axes:D.rawValue.getComponents().map((U,q)=>{var X;return kD({constraint:W.components[q],initialValue:U,params:hH(H.params,(X=h[q])!==null&&X!==void 0?X:{})})}),parser:m,value:D,viewProps:H.viewProps})}});class WH{constructor(H=0,D=0,W=0,h=0){this.x=H,this.y=D,this.z=W,this.w=h}getComponents(){return[this.x,this.y,this.z,this.w]}static isObject(H){if(L(H))return!1;let{x:D,y:W,z:h,w:U}=H;if(typeof D!=="number"||typeof W!=="number"||typeof h!=="number"||typeof U!=="number")return!1;return!0}static equals(H,D){return H.x===D.x&&H.y===D.y&&H.z===D.z&&H.w===D.w}toObject(){return{x:this.x,y:this.y,z:this.z,w:this.w}}}var PW={toComponents:(H)=>H.getComponents(),fromComponents:(H)=>new WH(...H)};function Vh(H){return WH.isObject(H)?new WH(H.x,H.y,H.z,H.w):new WH}function Eh(H,D){H.writeProperty("x",D.x),H.writeProperty("y",D.y),H.writeProperty("z",D.z),H.writeProperty("w",D.w)}function _h(H,D){return new hD({assembly:PW,components:[d(Object.assign(Object.assign({},H),H.x),D.x),d(Object.assign(Object.assign({},H),H.y),D.y),d(Object.assign(Object.assign({},H),H.z),D.z),d(Object.assign(Object.assign({},H),H.w),D.w)]})}var Ch=j({id:"input-point4d",type:"input",accept:(H,D)=>{if(!WH.isObject(H))return null;let W=I(D,(h)=>Object.assign(Object.assign({},PH(h)),{readonly:h.optional.constant(!1),w:h.optional.custom(c),x:h.optional.custom(c),y:h.optional.custom(c),z:h.optional.custom(c)}));return W?{initialValue:H,params:W}:null},binding:{reader:(H)=>Vh,constraint:(H)=>_h(H.params,H.initialValue),equals:WH.equals,writer:(H)=>Eh},controller:(H)=>{let{value:D,constraint:W}=H,h=[H.params.x,H.params.y,H.params.z,H.params.w];return new UD(H.document,{assembly:PW,axes:D.rawValue.getComponents().map((U,q)=>{var X;return kD({constraint:W.components[q],initialValue:U,params:hH(H.params,(X=h[q])!==null&&X!==void 0?X:{})})}),parser:m,value:D,viewProps:H.viewProps})}});function xh(H){let D=[],W=vD(H.options);if(W)D.push(W);return new wH(D)}var bh=j({id:"input-string",type:"input",accept:(H,D)=>{if(typeof H!=="string")return null;let W=I(D,(h)=>({readonly:h.optional.constant(!1),options:h.optional.custom(CH)}));return W?{initialValue:H,params:W}:null},binding:{reader:(H)=>V1,constraint:(H)=>xh(H.params),writer:(H)=>xH},controller:(H)=>{let{document:D,value:W,constraint:h}=H,U=h&&nH(h,IH);if(U)return new i(D,{props:new z({options:U.values.value("options")}),value:W,viewProps:H.viewProps});return new YH(D,{parser:(q)=>q,props:z.fromObject({formatter:AD}),value:W,viewProps:H.viewProps})},api(H){if(typeof H.controller.value.rawValue!=="string")return null;if(H.controller.valueController instanceof i)return new eH(H.controller);return null}}),fH={monitor:{defaultInterval:200,defaultRows:3}},k0=G("mll");class VW{constructor(H,D){this.onValueUpdate_=this.onValueUpdate_.bind(this),this.formatter_=D.formatter,this.element=H.createElement("div"),this.element.classList.add(k0()),D.viewProps.bindClassModifiers(this.element);let W=H.createElement("textarea");W.classList.add(k0("i")),W.style.height=`calc(var(${d1("containerUnitSize")}) * ${D.rows})`,W.readOnly=!0,D.viewProps.bindDisabled(W),this.element.appendChild(W),this.textareaElem_=W,D.value.emitter.on("change",this.onValueUpdate_),this.value=D.value,this.update_()}update_(){let H=this.textareaElem_,D=H.scrollTop===H.scrollHeight-H.clientHeight,W=[];if(this.value.rawValue.forEach((h)=>{if(h!==void 0)W.push(this.formatter_(h))}),H.textContent=W.join(`
`),D)H.scrollTop=H.scrollHeight}onValueUpdate_(){this.update_()}}class qD{constructor(H,D){this.value=D.value,this.viewProps=D.viewProps,this.view=new VW(H,{formatter:D.formatter,rows:D.rows,value:this.value,viewProps:this.viewProps})}}var T0=G("sgl");class EW{constructor(H,D){this.onValueUpdate_=this.onValueUpdate_.bind(this),this.formatter_=D.formatter,this.element=H.createElement("div"),this.element.classList.add(T0()),D.viewProps.bindClassModifiers(this.element);let W=H.createElement("input");W.classList.add(T0("i")),W.readOnly=!0,W.type="text",D.viewProps.bindDisabled(W),this.element.appendChild(W),this.inputElement=W,D.value.emitter.on("change",this.onValueUpdate_),this.value=D.value,this.update_()}update_(){let H=this.value.rawValue,D=H[H.length-1];this.inputElement.value=D!==void 0?this.formatter_(D):""}onValueUpdate_(){this.update_()}}class XD{constructor(H,D){this.value=D.value,this.viewProps=D.viewProps,this.view=new EW(H,{formatter:D.formatter,value:this.value,viewProps:this.viewProps})}}var fh=j({id:"monitor-bool",type:"monitor",accept:(H,D)=>{if(typeof H!=="boolean")return null;let W=I(D,(h)=>({readonly:h.required.constant(!0),rows:h.optional.number}));return W?{initialValue:H,params:W}:null},binding:{reader:(H)=>P1},controller:(H)=>{var D;if(H.value.rawValue.length===1)return new XD(H.document,{formatter:$0,value:H.value,viewProps:H.viewProps});return new qD(H.document,{formatter:$0,rows:(D=H.params.rows)!==null&&D!==void 0?D:fH.monitor.defaultRows,value:H.value,viewProps:H.viewProps})}});class _W extends ZH{get max(){return this.controller.valueController.props.get("max")}set max(H){this.controller.valueController.props.set("max",H)}get min(){return this.controller.valueController.props.get("min")}set min(H){this.controller.valueController.props.set("min",H)}}var n=G("grl");class CW{constructor(H,D){this.onCursorChange_=this.onCursorChange_.bind(this),this.onValueUpdate_=this.onValueUpdate_.bind(this),this.element=H.createElement("div"),this.element.classList.add(n()),D.viewProps.bindClassModifiers(this.element),this.formatter_=D.formatter,this.props_=D.props,this.cursor_=D.cursor,this.cursor_.emitter.on("change",this.onCursorChange_);let W=H.createElementNS(_,"svg");W.classList.add(n("g")),W.style.height=`calc(var(${d1("containerUnitSize")}) * ${D.rows})`,this.element.appendChild(W),this.svgElem_=W;let h=H.createElementNS(_,"polyline");this.svgElem_.appendChild(h),this.lineElem_=h;let U=H.createElement("div");U.classList.add(n("t"),G("tt")()),this.element.appendChild(U),this.tooltipElem_=U,D.value.emitter.on("change",this.onValueUpdate_),this.value=D.value,this.update_()}get graphElement(){return this.svgElem_}update_(){let{clientWidth:H,clientHeight:D}=this.element,W=this.value.rawValue.length-1,h=this.props_.get("min"),U=this.props_.get("max"),q=[];this.value.rawValue.forEach((Y,O)=>{if(Y===void 0)return;let A=F(O,0,W,0,H),XH=F(Y,h,U,D,0);q.push([A,XH].join(","))}),this.lineElem_.setAttributeNS(null,"points",q.join(" "));let X=this.tooltipElem_,J=this.value.rawValue[this.cursor_.rawValue];if(J===void 0){X.classList.remove(n("t","a"));return}let Z=F(this.cursor_.rawValue,0,W,0,H),Q=F(J,h,U,D,0);if(X.style.left=`${Z}px`,X.style.top=`${Q}px`,X.textContent=`${this.formatter_(J)}`,!X.classList.contains(n("t","a")))X.classList.add(n("t","a"),n("t","in")),tH(X),X.classList.remove(n("t","in"))}onValueUpdate_(){this.update_()}onCursorChange_(){this.update_()}}class sD{constructor(H,D){if(this.onGraphMouseMove_=this.onGraphMouseMove_.bind(this),this.onGraphMouseLeave_=this.onGraphMouseLeave_.bind(this),this.onGraphPointerDown_=this.onGraphPointerDown_.bind(this),this.onGraphPointerMove_=this.onGraphPointerMove_.bind(this),this.onGraphPointerUp_=this.onGraphPointerUp_.bind(this),this.props=D.props,this.value=D.value,this.viewProps=D.viewProps,this.cursor_=w(-1),this.view=new CW(H,{cursor:this.cursor_,formatter:D.formatter,rows:D.rows,props:this.props,value:this.value,viewProps:this.viewProps}),!TD(H))this.view.element.addEventListener("mousemove",this.onGraphMouseMove_),this.view.element.addEventListener("mouseleave",this.onGraphMouseLeave_);else{let W=new o(this.view.element);W.emitter.on("down",this.onGraphPointerDown_),W.emitter.on("move",this.onGraphPointerMove_),W.emitter.on("up",this.onGraphPointerUp_)}}importProps(H){return k(H,null,(D)=>({max:D.required.number,min:D.required.number}),(D)=>{return this.props.set("max",D.max),this.props.set("min",D.min),!0})}exportProps(){return T(null,{max:this.props.get("max"),min:this.props.get("min")})}onGraphMouseLeave_(){this.cursor_.rawValue=-1}onGraphMouseMove_(H){let{clientWidth:D}=this.view.element;this.cursor_.rawValue=Math.floor(F(H.offsetX,0,D,0,this.value.rawValue.length))}onGraphPointerDown_(H){this.onGraphPointerMove_(H)}onGraphPointerMove_(H){if(!H.data.point){this.cursor_.rawValue=-1;return}this.cursor_.rawValue=Math.floor(F(H.data.point.x,0,H.data.bounds.width,0,this.value.rawValue.length))}onGraphPointerUp_(){this.cursor_.rawValue=-1}}function BD(H){return!L(H.format)?H.format:R(2)}function dh(H){var D;if(H.value.rawValue.length===1)return new XD(H.document,{formatter:BD(H.params),value:H.value,viewProps:H.viewProps});return new qD(H.document,{formatter:BD(H.params),rows:(D=H.params.rows)!==null&&D!==void 0?D:fH.monitor.defaultRows,value:H.value,viewProps:H.viewProps})}function vh(H){var D,W,h;return new sD(H.document,{formatter:BD(H.params),rows:(D=H.params.rows)!==null&&D!==void 0?D:fH.monitor.defaultRows,props:z.fromObject({max:(W=H.params.max)!==null&&W!==void 0?W:100,min:(h=H.params.min)!==null&&h!==void 0?h:0}),value:H.value,viewProps:H.viewProps})}function P0(H){return H.view==="graph"}var uh=j({id:"monitor-number",type:"monitor",accept:(H,D)=>{if(typeof H!=="number")return null;let W=I(D,(h)=>({format:h.optional.function,max:h.optional.number,min:h.optional.number,readonly:h.required.constant(!0),rows:h.optional.number,view:h.optional.string}));return W?{initialValue:H,params:W}:null},binding:{defaultBufferSize:(H)=>P0(H)?64:1,reader:(H)=>g0},controller:(H)=>{if(P0(H.params))return vh(H);return dh(H)},api:(H)=>{if(H.controller.valueController instanceof sD)return new _W(H.controller);return null}}),mh=j({id:"monitor-string",type:"monitor",accept:(H,D)=>{if(typeof H!=="string")return null;let W=I(D,(h)=>({multiline:h.optional.boolean,readonly:h.required.constant(!0),rows:h.optional.number}));return W?{initialValue:H,params:W}:null},binding:{reader:(H)=>V1},controller:(H)=>{var D;let W=H.value;if(W.rawValue.length>1||H.params.multiline)return new qD(H.document,{formatter:AD,rows:(D=H.params.rows)!==null&&D!==void 0?D:fH.monitor.defaultRows,value:W,viewProps:H.viewProps});return new XD(H.document,{formatter:AD,value:W,viewProps:H.viewProps})}});class xW{constructor(){this.map_=new Map}get(H){var D;return(D=this.map_.get(H))!==null&&D!==void 0?D:null}has(H){return this.map_.has(H)}add(H,D){return this.map_.set(H,D),H.viewProps.handleDispose(()=>{this.map_.delete(H)}),D}}class bW{constructor(H){this.target=H.target,this.reader_=H.reader,this.writer_=H.writer}read(){return this.reader_(this.target.read())}write(H){this.writer_(this.target,H)}inject(H){this.write(this.reader_(H))}}function ih(H,D){var W;let h=H.accept(D.target.read(),D.params);if(L(h))return null;let U={target:D.target,initialValue:h.initialValue,params:h.params},q=I(D.params,(O)=>({disabled:O.optional.boolean,hidden:O.optional.boolean,label:O.optional.string,tag:O.optional.string})),X=H.binding.reader(U),J=H.binding.constraint?H.binding.constraint(U):void 0,Z=new bW({reader:X,target:D.target,writer:H.binding.writer(U)}),Q=new H1(w(X(h.initialValue),{constraint:J,equals:H.binding.equals}),Z),Y=H.controller({constraint:J,document:D.document,initialValue:h.initialValue,params:h.params,value:Q,viewProps:t.create({disabled:q===null||q===void 0?void 0:q.disabled,hidden:q===null||q===void 0?void 0:q.hidden})});return new q1(D.document,{blade:LH(),props:z.fromObject({label:"label"in D.params?(W=q===null||q===void 0?void 0:q.label)!==null&&W!==void 0?W:null:D.target.key}),tag:q===null||q===void 0?void 0:q.tag,value:Q,valueController:Y})}class fW{constructor(H){this.target=H.target,this.reader_=H.reader}read(){return this.reader_(this.target.read())}}function gh(H,D){return D===0?new S1:new R1(H,D!==null&&D!==void 0?D:fH.monitor.defaultInterval)}function th(H,D){var W,h,U;let q=H.accept(D.target.read(),D.params);if(L(q))return null;let X={target:D.target,initialValue:q.initialValue,params:q.params},J=I(D.params,(A)=>({bufferSize:A.optional.number,disabled:A.optional.boolean,hidden:A.optional.boolean,interval:A.optional.number,label:A.optional.string})),Z=H.binding.reader(X),Q=(h=(W=J===null||J===void 0?void 0:J.bufferSize)!==null&&W!==void 0?W:H.binding.defaultBufferSize&&H.binding.defaultBufferSize(q.params))!==null&&h!==void 0?h:1,Y=new J1({binding:new fW({reader:Z,target:D.target}),bufferSize:Q,ticker:gh(D.document,J===null||J===void 0?void 0:J.interval)}),O=H.controller({document:D.document,params:q.params,value:Y,viewProps:t.create({disabled:J===null||J===void 0?void 0:J.disabled,hidden:J===null||J===void 0?void 0:J.hidden})});return O.viewProps.bindDisabled(Y.ticker),O.viewProps.handleDispose(()=>{Y.ticker.dispose()}),new Q1(D.document,{blade:LH(),props:z.fromObject({label:"label"in D.params?(U=J===null||J===void 0?void 0:J.label)!==null&&U!==void 0?U:null:D.target.key}),value:Y,valueController:O})}class dW{constructor(H){this.pluginsMap_={blades:[],inputs:[],monitors:[]},this.apiCache_=H}getAll(){return[...this.pluginsMap_.blades,...this.pluginsMap_.inputs,...this.pluginsMap_.monitors]}register(H,D){if(!z6(D.core))throw $.notCompatible(H,D.id);if(D.type==="blade")this.pluginsMap_.blades.unshift(D);else if(D.type==="input")this.pluginsMap_.inputs.unshift(D);else if(D.type==="monitor")this.pluginsMap_.monitors.unshift(D)}createInput_(H,D,W){return this.pluginsMap_.inputs.reduce((h,U)=>h!==null&&h!==void 0?h:ih(U,{document:H,target:D,params:W}),null)}createMonitor_(H,D,W){return this.pluginsMap_.monitors.reduce((h,U)=>h!==null&&h!==void 0?h:th(U,{document:H,params:W,target:D}),null)}createBinding(H,D,W){let h=D.read();if(L(h))throw new $({context:{key:D.key},type:"nomatchingcontroller"});let U=this.createInput_(H,D,W);if(U)return U;let q=this.createMonitor_(H,D,W);if(q)return q;throw new $({context:{key:D.key},type:"nomatchingcontroller"})}createBlade(H,D){let W=this.pluginsMap_.blades.reduce((h,U)=>h!==null&&h!==void 0?h:q6(U,{document:H,params:D}),null);if(!W)throw new $({type:"nomatchingview",context:{params:D}});return W}createInputBindingApi_(H){let D=this.pluginsMap_.inputs.reduce((W,h)=>{var U,q;if(W)return W;return(q=(U=h.api)===null||U===void 0?void 0:U.call(h,{controller:H}))!==null&&q!==void 0?q:null},null);return this.apiCache_.add(H,D!==null&&D!==void 0?D:new ZH(H))}createMonitorBindingApi_(H){let D=this.pluginsMap_.monitors.reduce((W,h)=>{var U,q;if(W)return W;return(q=(U=h.api)===null||U===void 0?void 0:U.call(h,{controller:H}))!==null&&q!==void 0?q:null},null);return this.apiCache_.add(H,D!==null&&D!==void 0?D:new ZH(H))}createBindingApi(H){if(this.apiCache_.has(H))return this.apiCache_.get(H);if(m5(H))return this.createInputBindingApi_(H);if(s5(H))return this.createMonitorBindingApi_(H);throw $.shouldNeverHappen()}createApi(H){if(this.apiCache_.has(H))return this.apiCache_.get(H);if(u5(H))return this.createBindingApi(H);let D=this.pluginsMap_.blades.reduce((W,h)=>W!==null&&W!==void 0?W:h.api({controller:H,pool:this}),null);if(!D)throw $.shouldNeverHappen();return this.apiCache_.add(H,D)}}var ph=new xW;function sh(){let H=new dW(ph);return[Rh,Ph,Ch,bh,Mh,wh,Lh,zh,G6,fh,mh,uh,c5,h6,j1].forEach((D)=>{H.register("core",D)}),H}class vW extends r{constructor(H){super(H);this.emitter_=new M,this.controller.value.emitter.on("change",(D)=>{this.emitter_.emit("change",new GH(this,D.rawValue))})}get label(){return this.controller.labelController.props.get("label")}set label(H){this.controller.labelController.props.set("label",H)}get options(){return this.controller.valueController.props.get("options")}set options(H){this.controller.valueController.props.set("options",H)}get value(){return this.controller.value.rawValue}set value(H){this.controller.value.rawValue=H}on(H,D){let W=D.bind(this);return this.emitter_.on(H,(h)=>{W(h)},{key:D}),this}off(H,D){return this.emitter_.off(H,D),this}}class uW extends r{}class mW extends r{constructor(H){super(H);this.emitter_=new M,this.controller.value.emitter.on("change",(D)=>{this.emitter_.emit("change",new GH(this,D.rawValue))})}get label(){return this.controller.labelController.props.get("label")}set label(H){this.controller.labelController.props.set("label",H)}get max(){return this.controller.valueController.sliderController.props.get("max")}set max(H){this.controller.valueController.sliderController.props.set("max",H)}get min(){return this.controller.valueController.sliderController.props.get("min")}set min(H){this.controller.valueController.sliderController.props.set("min",H)}get value(){return this.controller.value.rawValue}set value(H){this.controller.value.rawValue=H}on(H,D){let W=D.bind(this);return this.emitter_.on(H,(h)=>{W(h)},{key:D}),this}off(H,D){return this.emitter_.off(H,D),this}}class iW extends r{constructor(H){super(H);this.emitter_=new M,this.controller.value.emitter.on("change",(D)=>{this.emitter_.emit("change",new GH(this,D.rawValue))})}get label(){return this.controller.labelController.props.get("label")}set label(H){this.controller.labelController.props.set("label",H)}get formatter(){return this.controller.valueController.props.get("formatter")}set formatter(H){this.controller.valueController.props.set("formatter",H)}get value(){return this.controller.value.rawValue}set value(H){this.controller.value.rawValue=H}on(H,D){let W=D.bind(this);return this.emitter_.on(H,(h)=>{W(h)},{key:D}),this}off(H,D){return this.emitter_.off(H,D),this}}var nh=function(){return{id:"list",type:"blade",core:FH,accept(H){let D=I(H,(W)=>({options:W.required.custom(CH),value:W.required.raw,view:W.required.constant("list"),label:W.optional.string}));return D?{params:D}:null},controller(H){let D=new IH(dD(H.params.options)),W=w(H.params.value,{constraint:D}),h=new i(H.document,{props:new z({options:D.values.value("options")}),value:W,viewProps:H.viewProps});return new l(H.document,{blade:H.blade,props:z.fromObject({label:H.params.label}),value:W,valueController:h})},api(H){if(!(H.controller instanceof l))return null;if(!(H.controller.valueController instanceof i))return null;return new vW(H.controller)}}}();class gW extends fD{constructor(H,D){super(H,D)}get element(){return this.controller.view.element}}class tW extends pH{constructor(H,D){super(H,{expanded:D.expanded,blade:D.blade,props:D.props,root:!0,viewProps:D.viewProps})}}var V0=G("spr");class pW{constructor(H,D){this.element=H.createElement("div"),this.element.classList.add(V0()),D.viewProps.bindClassModifiers(this.element);let W=H.createElement("hr");W.classList.add(V0("r")),this.element.appendChild(W)}}class yD extends EH{constructor(H,D){super(Object.assign(Object.assign({},D),{view:new pW(H,{viewProps:D.viewProps})}))}}var ch={id:"separator",type:"blade",core:FH,accept(H){let D=I(H,(W)=>({view:W.required.constant("separator")}));return D?{params:D}:null},controller(H){return new yD(H.document,{blade:H.blade,viewProps:H.viewProps})},api(H){if(!(H.controller instanceof yD))return null;return new uW(H.controller)}},lh={id:"slider",type:"blade",core:FH,accept(H){let D=I(H,(W)=>({max:W.required.number,min:W.required.number,view:W.required.constant("slider"),format:W.optional.function,label:W.optional.string,value:W.optional.number}));return D?{params:D}:null},controller(H){var D,W;let h=(D=H.params.value)!==null&&D!==void 0?D:0,U=new OH({max:H.params.max,min:H.params.min}),q=w(h,{constraint:U}),X=new TH(H.document,Object.assign(Object.assign({},f1({formatter:(W=H.params.format)!==null&&W!==void 0?W:S5,keyScale:w(1),max:U.values.value("max"),min:U.values.value("min"),pointerScale:s0(H.params,h)})),{parser:m,value:q,viewProps:H.viewProps}));return new l(H.document,{blade:H.blade,props:z.fromObject({label:H.params.label}),value:q,valueController:X})},api(H){if(!(H.controller instanceof l))return null;if(!(H.controller.valueController instanceof TH))return null;return new mW(H.controller)}},rh=function(){return{id:"text",type:"blade",core:FH,accept(H){let D=I(H,(W)=>({parse:W.required.function,value:W.required.raw,view:W.required.constant("text"),format:W.optional.function,label:W.optional.string}));return D?{params:D}:null},controller(H){var D;let W=w(H.params.value),h=new YH(H.document,{parser:H.params.parse,props:z.fromObject({formatter:(D=H.params.format)!==null&&D!==void 0?D:(U)=>String(U)}),value:W,viewProps:H.viewProps});return new l(H.document,{blade:H.blade,props:z.fromObject({label:H.params.label}),value:W,valueController:h})},api(H){if(!(H.controller instanceof l))return null;if(!(H.controller.valueController instanceof YH))return null;return new iW(H.controller)}}}();function oh(H){let D=H.createElement("div");if(D.classList.add(G("dfw")()),H.body)H.body.appendChild(D);return D}function ah(H,D,W){if(H.querySelector(`style[data-tp-style=${D}]`))return;let h=H.createElement("style");h.dataset.tpStyle=D,h.textContent=W,H.head.appendChild(h)}class nD extends gW{constructor(H){var D,W;let h=H!==null&&H!==void 0?H:{},U=(D=h.document)!==null&&D!==void 0?D:_5(),q=sh(),X=new tW(U,{expanded:h.expanded,blade:LH(),props:z.fromObject({title:h.title}),viewProps:t.create()});super(X,q);this.pool_=q,this.containerElem_=(W=h.container)!==null&&W!==void 0?W:oh(U),this.containerElem_.appendChild(this.element),this.doc_=U,this.usesDefaultWrapper_=!h.container,this.setUpDefaultPlugins_()}get document(){if(!this.doc_)throw $.alreadyDisposed();return this.doc_}dispose(){let H=this.containerElem_;if(!H)throw $.alreadyDisposed();if(this.usesDefaultWrapper_){let D=H.parentElement;if(D)D.removeChild(H)}this.containerElem_=null,this.doc_=null,super.dispose()}registerPlugin(H){if(H.css)ah(this.document,`plugin-${H.id}`,H.css);("plugin"in H?[H.plugin]:("plugins"in H)?H.plugins:[]).forEach((W)=>{this.pool_.register(H.id,W)})}setUpDefaultPlugins_(){this.registerPlugin({id:"default",css:".tp-tbiv_b,.tp-coltxtv_ms,.tp-colswv_b,.tp-ckbv_i,.tp-sglv_i,.tp-mllv_i,.tp-grlv_g,.tp-txtv_i,.tp-p2dpv_p,.tp-colswv_sw,.tp-rotv_b,.tp-fldv_b,.tp-p2dv_b,.tp-btnv_b,.tp-lstv_s{-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:rgba(0,0,0,0);border-width:0;font-family:inherit;font-size:inherit;font-weight:inherit;margin:0;outline:none;padding:0}.tp-p2dv_b,.tp-btnv_b,.tp-lstv_s{background-color:var(--btn-bg);border-radius:var(--bld-br);color:var(--btn-fg);cursor:pointer;display:block;font-weight:bold;height:var(--cnt-usz);line-height:var(--cnt-usz);overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.tp-p2dv_b:hover,.tp-btnv_b:hover,.tp-lstv_s:hover{background-color:var(--btn-bg-h)}.tp-p2dv_b:focus,.tp-btnv_b:focus,.tp-lstv_s:focus{background-color:var(--btn-bg-f)}.tp-p2dv_b:active,.tp-btnv_b:active,.tp-lstv_s:active{background-color:var(--btn-bg-a)}.tp-p2dv_b:disabled,.tp-btnv_b:disabled,.tp-lstv_s:disabled{opacity:.5}.tp-rotv_c>.tp-cntv.tp-v-lst,.tp-tbpv_c>.tp-cntv.tp-v-lst,.tp-fldv_c>.tp-cntv.tp-v-lst{margin-bottom:calc(-1*var(--cnt-vp))}.tp-rotv_c>.tp-fldv.tp-v-lst .tp-fldv_c,.tp-tbpv_c>.tp-fldv.tp-v-lst .tp-fldv_c,.tp-fldv_c>.tp-fldv.tp-v-lst .tp-fldv_c{border-bottom-left-radius:0}.tp-rotv_c>.tp-fldv.tp-v-lst .tp-fldv_b,.tp-tbpv_c>.tp-fldv.tp-v-lst .tp-fldv_b,.tp-fldv_c>.tp-fldv.tp-v-lst .tp-fldv_b{border-bottom-left-radius:0}.tp-rotv_c>*:not(.tp-v-fst),.tp-tbpv_c>*:not(.tp-v-fst),.tp-fldv_c>*:not(.tp-v-fst){margin-top:var(--cnt-usp)}.tp-rotv_c>.tp-sprv:not(.tp-v-fst),.tp-tbpv_c>.tp-sprv:not(.tp-v-fst),.tp-fldv_c>.tp-sprv:not(.tp-v-fst),.tp-rotv_c>.tp-cntv:not(.tp-v-fst),.tp-tbpv_c>.tp-cntv:not(.tp-v-fst),.tp-fldv_c>.tp-cntv:not(.tp-v-fst){margin-top:var(--cnt-vp)}.tp-rotv_c>.tp-sprv+*:not(.tp-v-hidden),.tp-tbpv_c>.tp-sprv+*:not(.tp-v-hidden),.tp-fldv_c>.tp-sprv+*:not(.tp-v-hidden),.tp-rotv_c>.tp-cntv+*:not(.tp-v-hidden),.tp-tbpv_c>.tp-cntv+*:not(.tp-v-hidden),.tp-fldv_c>.tp-cntv+*:not(.tp-v-hidden){margin-top:var(--cnt-vp)}.tp-rotv_c>.tp-sprv:not(.tp-v-hidden)+.tp-sprv,.tp-tbpv_c>.tp-sprv:not(.tp-v-hidden)+.tp-sprv,.tp-fldv_c>.tp-sprv:not(.tp-v-hidden)+.tp-sprv,.tp-rotv_c>.tp-cntv:not(.tp-v-hidden)+.tp-cntv,.tp-tbpv_c>.tp-cntv:not(.tp-v-hidden)+.tp-cntv,.tp-fldv_c>.tp-cntv:not(.tp-v-hidden)+.tp-cntv{margin-top:0}.tp-tbpv_c>.tp-cntv,.tp-fldv_c>.tp-cntv{margin-left:4px}.tp-tbpv_c>.tp-fldv>.tp-fldv_b,.tp-fldv_c>.tp-fldv>.tp-fldv_b{border-top-left-radius:var(--bld-br);border-bottom-left-radius:var(--bld-br)}.tp-tbpv_c>.tp-fldv.tp-fldv-expanded>.tp-fldv_b,.tp-fldv_c>.tp-fldv.tp-fldv-expanded>.tp-fldv_b{border-bottom-left-radius:0}.tp-tbpv_c .tp-fldv>.tp-fldv_c,.tp-fldv_c .tp-fldv>.tp-fldv_c{border-bottom-left-radius:var(--bld-br)}.tp-tbpv_c>.tp-cntv+.tp-fldv>.tp-fldv_b,.tp-fldv_c>.tp-cntv+.tp-fldv>.tp-fldv_b{border-top-left-radius:0}.tp-tbpv_c>.tp-cntv+.tp-tabv>.tp-tabv_t,.tp-fldv_c>.tp-cntv+.tp-tabv>.tp-tabv_t{border-top-left-radius:0}.tp-tbpv_c>.tp-tabv>.tp-tabv_t,.tp-fldv_c>.tp-tabv>.tp-tabv_t{border-top-left-radius:var(--bld-br)}.tp-tbpv_c .tp-tabv>.tp-tabv_c,.tp-fldv_c .tp-tabv>.tp-tabv_c{border-bottom-left-radius:var(--bld-br)}.tp-rotv_b,.tp-fldv_b{background-color:var(--cnt-bg);color:var(--cnt-fg);cursor:pointer;display:block;height:calc(var(--cnt-usz) + 4px);line-height:calc(var(--cnt-usz) + 4px);overflow:hidden;padding-left:var(--cnt-hp);padding-right:calc(4px + var(--cnt-usz) + var(--cnt-hp));position:relative;text-align:left;text-overflow:ellipsis;white-space:nowrap;width:100%;transition:border-radius .2s ease-in-out .2s}.tp-rotv_b:hover,.tp-fldv_b:hover{background-color:var(--cnt-bg-h)}.tp-rotv_b:focus,.tp-fldv_b:focus{background-color:var(--cnt-bg-f)}.tp-rotv_b:active,.tp-fldv_b:active{background-color:var(--cnt-bg-a)}.tp-rotv_b:disabled,.tp-fldv_b:disabled{opacity:.5}.tp-rotv_m,.tp-fldv_m{background:linear-gradient(to left, var(--cnt-fg), var(--cnt-fg) 2px, transparent 2px, transparent 4px, var(--cnt-fg) 4px);border-radius:2px;bottom:0;content:\"\";display:block;height:6px;right:calc(var(--cnt-hp) + (var(--cnt-usz) + 4px - 6px)/2 - 2px);margin:auto;opacity:.5;position:absolute;top:0;transform:rotate(90deg);transition:transform .2s ease-in-out;width:6px}.tp-rotv.tp-rotv-expanded .tp-rotv_m,.tp-fldv.tp-fldv-expanded>.tp-fldv_b>.tp-fldv_m{transform:none}.tp-rotv_c,.tp-fldv_c{box-sizing:border-box;height:0;opacity:0;overflow:hidden;padding-bottom:0;padding-top:0;position:relative;transition:height .2s ease-in-out,opacity .2s linear,padding .2s ease-in-out}.tp-rotv.tp-rotv-cpl:not(.tp-rotv-expanded) .tp-rotv_c,.tp-fldv.tp-fldv-cpl:not(.tp-fldv-expanded)>.tp-fldv_c{display:none}.tp-rotv.tp-rotv-expanded .tp-rotv_c,.tp-fldv.tp-fldv-expanded>.tp-fldv_c{opacity:1;padding-bottom:var(--cnt-vp);padding-top:var(--cnt-vp);transform:none;overflow:visible;transition:height .2s ease-in-out,opacity .2s linear .2s,padding .2s ease-in-out}.tp-txtv_i,.tp-p2dpv_p,.tp-colswv_sw{background-color:var(--in-bg);border-radius:var(--bld-br);box-sizing:border-box;color:var(--in-fg);font-family:inherit;height:var(--cnt-usz);line-height:var(--cnt-usz);min-width:0;width:100%}.tp-txtv_i:hover,.tp-p2dpv_p:hover,.tp-colswv_sw:hover{background-color:var(--in-bg-h)}.tp-txtv_i:focus,.tp-p2dpv_p:focus,.tp-colswv_sw:focus{background-color:var(--in-bg-f)}.tp-txtv_i:active,.tp-p2dpv_p:active,.tp-colswv_sw:active{background-color:var(--in-bg-a)}.tp-txtv_i:disabled,.tp-p2dpv_p:disabled,.tp-colswv_sw:disabled{opacity:.5}.tp-lstv,.tp-coltxtv_m{position:relative}.tp-lstv_s{padding:0 20px 0 4px;width:100%}.tp-lstv_m,.tp-coltxtv_mm{bottom:0;margin:auto;pointer-events:none;position:absolute;right:2px;top:0}.tp-lstv_m svg,.tp-coltxtv_mm svg{bottom:0;height:16px;margin:auto;position:absolute;right:0;top:0;width:16px}.tp-lstv_m svg path,.tp-coltxtv_mm svg path{fill:currentColor}.tp-sglv_i,.tp-mllv_i,.tp-grlv_g{background-color:var(--mo-bg);border-radius:var(--bld-br);box-sizing:border-box;color:var(--mo-fg);height:var(--cnt-usz);scrollbar-color:currentColor rgba(0,0,0,0);scrollbar-width:thin;width:100%}.tp-sglv_i::-webkit-scrollbar,.tp-mllv_i::-webkit-scrollbar,.tp-grlv_g::-webkit-scrollbar{height:8px;width:8px}.tp-sglv_i::-webkit-scrollbar-corner,.tp-mllv_i::-webkit-scrollbar-corner,.tp-grlv_g::-webkit-scrollbar-corner{background-color:rgba(0,0,0,0)}.tp-sglv_i::-webkit-scrollbar-thumb,.tp-mllv_i::-webkit-scrollbar-thumb,.tp-grlv_g::-webkit-scrollbar-thumb{background-clip:padding-box;background-color:currentColor;border:rgba(0,0,0,0) solid 2px;border-radius:4px}.tp-pndtxtv,.tp-coltxtv_w{display:flex}.tp-pndtxtv_a,.tp-coltxtv_c{width:100%}.tp-pndtxtv_a+.tp-pndtxtv_a,.tp-coltxtv_c+.tp-pndtxtv_a,.tp-pndtxtv_a+.tp-coltxtv_c,.tp-coltxtv_c+.tp-coltxtv_c{margin-left:2px}.tp-rotv{--bs-bg: var(--tp-base-background-color, hsl(230, 7%, 17%));--bs-br: var(--tp-base-border-radius, 6px);--bs-ff: var(--tp-base-font-family, Roboto Mono, Source Code Pro, Menlo, Courier, monospace);--bs-sh: var(--tp-base-shadow-color, rgba(0, 0, 0, 0.2));--bld-br: var(--tp-blade-border-radius, 2px);--bld-hp: var(--tp-blade-horizontal-padding, 4px);--bld-vw: var(--tp-blade-value-width, 160px);--btn-bg: var(--tp-button-background-color, hsl(230, 7%, 70%));--btn-bg-a: var(--tp-button-background-color-active, #d6d7db);--btn-bg-f: var(--tp-button-background-color-focus, #c8cad0);--btn-bg-h: var(--tp-button-background-color-hover, #bbbcc4);--btn-fg: var(--tp-button-foreground-color, hsl(230, 7%, 17%));--cnt-bg: var(--tp-container-background-color, rgba(187, 188, 196, 0.1));--cnt-bg-a: var(--tp-container-background-color-active, rgba(187, 188, 196, 0.25));--cnt-bg-f: var(--tp-container-background-color-focus, rgba(187, 188, 196, 0.2));--cnt-bg-h: var(--tp-container-background-color-hover, rgba(187, 188, 196, 0.15));--cnt-fg: var(--tp-container-foreground-color, hsl(230, 7%, 75%));--cnt-hp: var(--tp-container-horizontal-padding, 4px);--cnt-vp: var(--tp-container-vertical-padding, 4px);--cnt-usp: var(--tp-container-unit-spacing, 4px);--cnt-usz: var(--tp-container-unit-size, 20px);--in-bg: var(--tp-input-background-color, rgba(187, 188, 196, 0.1));--in-bg-a: var(--tp-input-background-color-active, rgba(187, 188, 196, 0.25));--in-bg-f: var(--tp-input-background-color-focus, rgba(187, 188, 196, 0.2));--in-bg-h: var(--tp-input-background-color-hover, rgba(187, 188, 196, 0.15));--in-fg: var(--tp-input-foreground-color, hsl(230, 7%, 75%));--lbl-fg: var(--tp-label-foreground-color, rgba(187, 188, 196, 0.7));--mo-bg: var(--tp-monitor-background-color, rgba(0, 0, 0, 0.2));--mo-fg: var(--tp-monitor-foreground-color, rgba(187, 188, 196, 0.7));--grv-fg: var(--tp-groove-foreground-color, rgba(187, 188, 196, 0.1))}.tp-btnv_b{width:100%}.tp-btnv_t{text-align:center}.tp-ckbv_l{display:block;position:relative}.tp-ckbv_i{left:0;opacity:0;position:absolute;top:0}.tp-ckbv_w{background-color:var(--in-bg);border-radius:var(--bld-br);cursor:pointer;display:block;height:var(--cnt-usz);position:relative;width:var(--cnt-usz)}.tp-ckbv_w svg{display:block;height:16px;inset:0;margin:auto;opacity:0;position:absolute;width:16px}.tp-ckbv_w svg path{fill:none;stroke:var(--in-fg);stroke-width:2}.tp-ckbv_i:hover+.tp-ckbv_w{background-color:var(--in-bg-h)}.tp-ckbv_i:focus+.tp-ckbv_w{background-color:var(--in-bg-f)}.tp-ckbv_i:active+.tp-ckbv_w{background-color:var(--in-bg-a)}.tp-ckbv_i:checked+.tp-ckbv_w svg{opacity:1}.tp-ckbv.tp-v-disabled .tp-ckbv_w{opacity:.5}.tp-colv{position:relative}.tp-colv_h{display:flex}.tp-colv_s{flex-grow:0;flex-shrink:0;width:var(--cnt-usz)}.tp-colv_t{flex:1;margin-left:4px}.tp-colv_p{height:0;margin-top:0;opacity:0;overflow:hidden;transition:height .2s ease-in-out,opacity .2s linear,margin .2s ease-in-out}.tp-colv.tp-colv-expanded.tp-colv-cpl .tp-colv_p{overflow:visible}.tp-colv.tp-colv-expanded .tp-colv_p{margin-top:var(--cnt-usp);opacity:1}.tp-colv .tp-popv{left:calc(-1*var(--cnt-hp));right:calc(-1*var(--cnt-hp));top:var(--cnt-usz)}.tp-colpv_h,.tp-colpv_ap{margin-left:6px;margin-right:6px}.tp-colpv_h{margin-top:var(--cnt-usp)}.tp-colpv_rgb{display:flex;margin-top:var(--cnt-usp);width:100%}.tp-colpv_a{display:flex;margin-top:var(--cnt-vp);padding-top:calc(var(--cnt-vp) + 2px);position:relative}.tp-colpv_a::before{background-color:var(--grv-fg);content:\"\";height:2px;left:calc(-1*var(--cnt-hp));position:absolute;right:calc(-1*var(--cnt-hp));top:0}.tp-colpv.tp-v-disabled .tp-colpv_a::before{opacity:.5}.tp-colpv_ap{align-items:center;display:flex;flex:3}.tp-colpv_at{flex:1;margin-left:4px}.tp-svpv{border-radius:var(--bld-br);outline:none;overflow:hidden;position:relative}.tp-svpv.tp-v-disabled{opacity:.5}.tp-svpv_c{cursor:crosshair;display:block;height:calc(var(--cnt-usz)*4);width:100%}.tp-svpv_m{border-radius:100%;border:rgba(255,255,255,.75) solid 2px;box-sizing:border-box;filter:drop-shadow(0 0 1px rgba(0, 0, 0, 0.3));height:12px;margin-left:-6px;margin-top:-6px;pointer-events:none;position:absolute;width:12px}.tp-svpv:focus .tp-svpv_m{border-color:#fff}.tp-hplv{cursor:pointer;height:var(--cnt-usz);outline:none;position:relative}.tp-hplv.tp-v-disabled{opacity:.5}.tp-hplv_c{background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAAABCAYAAABubagXAAAAQ0lEQVQoU2P8z8Dwn0GCgQEDi2OK/RBgYHjBgIpfovFh8j8YBIgzFGQxuqEgPhaDOT5gOhPkdCxOZeBg+IDFZZiGAgCaSSMYtcRHLgAAAABJRU5ErkJggg==);background-position:left top;background-repeat:no-repeat;background-size:100% 100%;border-radius:2px;display:block;height:4px;left:0;margin-top:-2px;position:absolute;top:50%;width:100%}.tp-hplv_m{border-radius:var(--bld-br);border:rgba(255,255,255,.75) solid 2px;box-shadow:0 0 2px rgba(0,0,0,.1);box-sizing:border-box;height:12px;left:50%;margin-left:-6px;margin-top:-6px;position:absolute;top:50%;width:12px}.tp-hplv:focus .tp-hplv_m{border-color:#fff}.tp-aplv{cursor:pointer;height:var(--cnt-usz);outline:none;position:relative;width:100%}.tp-aplv.tp-v-disabled{opacity:.5}.tp-aplv_b{background-color:#fff;background-image:linear-gradient(to top right, #ddd 25%, transparent 25%, transparent 75%, #ddd 75%),linear-gradient(to top right, #ddd 25%, transparent 25%, transparent 75%, #ddd 75%);background-size:4px 4px;background-position:0 0,2px 2px;border-radius:2px;display:block;height:4px;left:0;margin-top:-2px;overflow:hidden;position:absolute;top:50%;width:100%}.tp-aplv_c{inset:0;position:absolute}.tp-aplv_m{background-color:#fff;background-image:linear-gradient(to top right, #ddd 25%, transparent 25%, transparent 75%, #ddd 75%),linear-gradient(to top right, #ddd 25%, transparent 25%, transparent 75%, #ddd 75%);background-size:12px 12px;background-position:0 0,6px 6px;border-radius:var(--bld-br);box-shadow:0 0 2px rgba(0,0,0,.1);height:12px;left:50%;margin-left:-6px;margin-top:-6px;overflow:hidden;position:absolute;top:50%;width:12px}.tp-aplv_p{border-radius:var(--bld-br);border:rgba(255,255,255,.75) solid 2px;box-sizing:border-box;inset:0;position:absolute}.tp-aplv:focus .tp-aplv_p{border-color:#fff}.tp-colswv{background-color:#fff;background-image:linear-gradient(to top right, #ddd 25%, transparent 25%, transparent 75%, #ddd 75%),linear-gradient(to top right, #ddd 25%, transparent 25%, transparent 75%, #ddd 75%);background-size:10px 10px;background-position:0 0,5px 5px;border-radius:var(--bld-br);overflow:hidden}.tp-colswv.tp-v-disabled{opacity:.5}.tp-colswv_sw{border-radius:0}.tp-colswv_b{cursor:pointer;display:block;height:var(--cnt-usz);left:0;position:absolute;top:0;width:var(--cnt-usz)}.tp-colswv_b:focus::after{border:rgba(255,255,255,.75) solid 2px;border-radius:var(--bld-br);content:\"\";display:block;inset:0;position:absolute}.tp-coltxtv{display:flex;width:100%}.tp-coltxtv_m{margin-right:4px}.tp-coltxtv_ms{border-radius:var(--bld-br);color:var(--lbl-fg);cursor:pointer;height:var(--cnt-usz);line-height:var(--cnt-usz);padding:0 18px 0 4px}.tp-coltxtv_ms:hover{background-color:var(--in-bg-h)}.tp-coltxtv_ms:focus{background-color:var(--in-bg-f)}.tp-coltxtv_ms:active{background-color:var(--in-bg-a)}.tp-coltxtv_mm{color:var(--lbl-fg)}.tp-coltxtv.tp-v-disabled .tp-coltxtv_mm{opacity:.5}.tp-coltxtv_w{flex:1}.tp-dfwv{position:absolute;top:8px;right:8px;width:256px}.tp-fldv{position:relative}.tp-fldv_t{padding-left:4px}.tp-fldv_b:disabled .tp-fldv_m{display:none}.tp-fldv_c{padding-left:4px}.tp-fldv_i{bottom:0;color:var(--cnt-bg);left:0;overflow:hidden;position:absolute;top:calc(var(--cnt-usz) + 4px);width:max(var(--bs-br),4px)}.tp-fldv_i::before{background-color:currentColor;bottom:0;content:\"\";left:0;position:absolute;top:0;width:4px}.tp-fldv_b:hover+.tp-fldv_i{color:var(--cnt-bg-h)}.tp-fldv_b:focus+.tp-fldv_i{color:var(--cnt-bg-f)}.tp-fldv_b:active+.tp-fldv_i{color:var(--cnt-bg-a)}.tp-fldv.tp-v-disabled>.tp-fldv_i{opacity:.5}.tp-grlv{position:relative}.tp-grlv_g{display:block;height:calc(var(--cnt-usz)*3)}.tp-grlv_g polyline{fill:none;stroke:var(--mo-fg);stroke-linejoin:round}.tp-grlv_t{margin-top:-4px;transition:left .05s,top .05s;visibility:hidden}.tp-grlv_t.tp-grlv_t-a{visibility:visible}.tp-grlv_t.tp-grlv_t-in{transition:none}.tp-grlv.tp-v-disabled .tp-grlv_g{opacity:.5}.tp-grlv .tp-ttv{background-color:var(--mo-fg)}.tp-grlv .tp-ttv::before{border-top-color:var(--mo-fg)}.tp-lblv{align-items:center;display:flex;line-height:1.3;padding-left:var(--cnt-hp);padding-right:var(--cnt-hp)}.tp-lblv.tp-lblv-nol{display:block}.tp-lblv_l{color:var(--lbl-fg);flex:1;-webkit-hyphens:auto;hyphens:auto;overflow:hidden;padding-left:4px;padding-right:16px}.tp-lblv.tp-v-disabled .tp-lblv_l{opacity:.5}.tp-lblv.tp-lblv-nol .tp-lblv_l{display:none}.tp-lblv_v{align-self:flex-start;flex-grow:0;flex-shrink:0;width:var(--bld-vw)}.tp-lblv.tp-lblv-nol .tp-lblv_v{width:100%}.tp-lstv_s{padding:0 20px 0 var(--bld-hp);width:100%}.tp-lstv_m{color:var(--btn-fg)}.tp-sglv_i{padding-left:var(--bld-hp);padding-right:var(--bld-hp)}.tp-sglv.tp-v-disabled .tp-sglv_i{opacity:.5}.tp-mllv_i{display:block;height:calc(var(--cnt-usz)*3);line-height:var(--cnt-usz);padding-left:var(--bld-hp);padding-right:var(--bld-hp);resize:none;white-space:pre}.tp-mllv.tp-v-disabled .tp-mllv_i{opacity:.5}.tp-p2dv{position:relative}.tp-p2dv_h{display:flex}.tp-p2dv_b{height:var(--cnt-usz);margin-right:4px;position:relative;width:var(--cnt-usz)}.tp-p2dv_b svg{display:block;height:16px;left:50%;margin-left:-8px;margin-top:-8px;position:absolute;top:50%;width:16px}.tp-p2dv_b svg path{stroke:currentColor;stroke-width:2}.tp-p2dv_b svg circle{fill:currentColor}.tp-p2dv_t{flex:1}.tp-p2dv_p{height:0;margin-top:0;opacity:0;overflow:hidden;transition:height .2s ease-in-out,opacity .2s linear,margin .2s ease-in-out}.tp-p2dv.tp-p2dv-expanded .tp-p2dv_p{margin-top:var(--cnt-usp);opacity:1}.tp-p2dv .tp-popv{left:calc(-1*var(--cnt-hp));right:calc(-1*var(--cnt-hp));top:var(--cnt-usz)}.tp-p2dpv{padding-left:calc(var(--cnt-usz) + 4px)}.tp-p2dpv_p{cursor:crosshair;height:0;overflow:hidden;padding-bottom:100%;position:relative}.tp-p2dpv.tp-v-disabled .tp-p2dpv_p{opacity:.5}.tp-p2dpv_g{display:block;height:100%;left:0;pointer-events:none;position:absolute;top:0;width:100%}.tp-p2dpv_ax{opacity:.1;stroke:var(--in-fg);stroke-dasharray:1}.tp-p2dpv_l{opacity:.5;stroke:var(--in-fg);stroke-dasharray:1}.tp-p2dpv_m{border:var(--in-fg) solid 1px;border-radius:50%;box-sizing:border-box;height:4px;margin-left:-2px;margin-top:-2px;position:absolute;width:4px}.tp-p2dpv_p:focus .tp-p2dpv_m{background-color:var(--in-fg);border-width:0}.tp-popv{background-color:var(--bs-bg);border-radius:var(--bs-br);box-shadow:0 2px 4px var(--bs-sh);display:none;max-width:var(--bld-vw);padding:var(--cnt-vp) var(--cnt-hp);position:absolute;visibility:hidden;z-index:1000}.tp-popv.tp-popv-v{display:block;visibility:visible}.tp-sldv.tp-v-disabled{opacity:.5}.tp-sldv_t{box-sizing:border-box;cursor:pointer;height:var(--cnt-usz);margin:0 6px;outline:none;position:relative}.tp-sldv_t::before{background-color:var(--in-bg);border-radius:1px;content:\"\";display:block;height:2px;inset:0;margin:auto;position:absolute}.tp-sldv_k{height:100%;left:0;position:absolute;top:0}.tp-sldv_k::before{background-color:var(--in-fg);border-radius:1px;content:\"\";display:block;height:2px;inset:0;margin-bottom:auto;margin-top:auto;position:absolute}.tp-sldv_k::after{background-color:var(--btn-bg);border-radius:var(--bld-br);bottom:0;content:\"\";display:block;height:12px;margin-bottom:auto;margin-top:auto;position:absolute;right:-6px;top:0;width:12px}.tp-sldv_t:hover .tp-sldv_k::after{background-color:var(--btn-bg-h)}.tp-sldv_t:focus .tp-sldv_k::after{background-color:var(--btn-bg-f)}.tp-sldv_t:active .tp-sldv_k::after{background-color:var(--btn-bg-a)}.tp-sldtxtv{display:flex}.tp-sldtxtv_s{flex:2}.tp-sldtxtv_t{flex:1;margin-left:4px}.tp-tabv{position:relative}.tp-tabv_t{align-items:flex-end;color:var(--cnt-bg);display:flex;overflow:hidden;position:relative}.tp-tabv_t:hover{color:var(--cnt-bg-h)}.tp-tabv_t:has(*:focus){color:var(--cnt-bg-f)}.tp-tabv_t:has(*:active){color:var(--cnt-bg-a)}.tp-tabv_t::before{background-color:currentColor;bottom:0;content:\"\";height:2px;left:0;pointer-events:none;position:absolute;right:0}.tp-tabv.tp-v-disabled .tp-tabv_t::before{opacity:.5}.tp-tabv.tp-tabv-nop .tp-tabv_t{height:calc(var(--cnt-usz) + 4px);position:relative}.tp-tabv.tp-tabv-nop .tp-tabv_t::before{background-color:var(--cnt-bg);bottom:0;content:\"\";height:2px;left:0;position:absolute;right:0}.tp-tabv_i{bottom:0;color:var(--cnt-bg);left:0;overflow:hidden;position:absolute;top:calc(var(--cnt-usz) + 4px);width:max(var(--bs-br),4px)}.tp-tabv_i::before{background-color:currentColor;bottom:0;content:\"\";left:0;position:absolute;top:0;width:4px}.tp-tabv_t:hover+.tp-tabv_i{color:var(--cnt-bg-h)}.tp-tabv_t:has(*:focus)+.tp-tabv_i{color:var(--cnt-bg-f)}.tp-tabv_t:has(*:active)+.tp-tabv_i{color:var(--cnt-bg-a)}.tp-tabv.tp-v-disabled>.tp-tabv_i{opacity:.5}.tp-tbiv{flex:1;min-width:0;position:relative}.tp-tbiv+.tp-tbiv{margin-left:2px}.tp-tbiv+.tp-tbiv.tp-v-disabled::before{opacity:.5}.tp-tbiv_b{display:block;padding-left:calc(var(--cnt-hp) + 4px);padding-right:calc(var(--cnt-hp) + 4px);position:relative;width:100%}.tp-tbiv_b:disabled{opacity:.5}.tp-tbiv_b::before{background-color:var(--cnt-bg);content:\"\";inset:0 0 2px;pointer-events:none;position:absolute}.tp-tbiv_b:hover::before{background-color:var(--cnt-bg-h)}.tp-tbiv_b:focus::before{background-color:var(--cnt-bg-f)}.tp-tbiv_b:active::before{background-color:var(--cnt-bg-a)}.tp-tbiv_t{color:var(--cnt-fg);height:calc(var(--cnt-usz) + 4px);line-height:calc(var(--cnt-usz) + 4px);opacity:.5;overflow:hidden;position:relative;text-overflow:ellipsis}.tp-tbiv.tp-tbiv-sel .tp-tbiv_t{opacity:1}.tp-tbpv_c{padding-bottom:var(--cnt-vp);padding-left:4px;padding-top:var(--cnt-vp)}.tp-txtv{position:relative}.tp-txtv_i{padding-left:var(--bld-hp);padding-right:var(--bld-hp)}.tp-txtv.tp-txtv-fst .tp-txtv_i{border-bottom-right-radius:0;border-top-right-radius:0}.tp-txtv.tp-txtv-mid .tp-txtv_i{border-radius:0}.tp-txtv.tp-txtv-lst .tp-txtv_i{border-bottom-left-radius:0;border-top-left-radius:0}.tp-txtv.tp-txtv-num .tp-txtv_i{text-align:right}.tp-txtv.tp-txtv-drg .tp-txtv_i{opacity:.3}.tp-txtv_k{cursor:pointer;height:100%;left:calc(var(--bld-hp) - 5px);position:absolute;top:0;width:12px}.tp-txtv_k::before{background-color:var(--in-fg);border-radius:1px;bottom:0;content:\"\";height:calc(var(--cnt-usz) - 4px);left:50%;margin-bottom:auto;margin-left:-1px;margin-top:auto;opacity:.1;position:absolute;top:0;transition:border-radius .1s,height .1s,transform .1s,width .1s;width:2px}.tp-txtv_k:hover::before,.tp-txtv.tp-txtv-drg .tp-txtv_k::before{opacity:1}.tp-txtv.tp-txtv-drg .tp-txtv_k::before{border-radius:50%;height:4px;transform:translateX(-1px);width:4px}.tp-txtv_g{bottom:0;display:block;height:8px;left:50%;margin:auto;overflow:visible;pointer-events:none;position:absolute;top:0;visibility:hidden;width:100%}.tp-txtv.tp-txtv-drg .tp-txtv_g{visibility:visible}.tp-txtv_gb{fill:none;stroke:var(--in-fg);stroke-dasharray:1}.tp-txtv_gh{fill:none;stroke:var(--in-fg)}.tp-txtv .tp-ttv{margin-left:6px;visibility:hidden}.tp-txtv.tp-txtv-drg .tp-ttv{visibility:visible}.tp-ttv{background-color:var(--in-fg);border-radius:var(--bld-br);color:var(--bs-bg);padding:2px 4px;pointer-events:none;position:absolute;transform:translate(-50%, -100%)}.tp-ttv::before{border-color:var(--in-fg) rgba(0,0,0,0) rgba(0,0,0,0) rgba(0,0,0,0);border-style:solid;border-width:2px;box-sizing:border-box;content:\"\";font-size:.9em;height:4px;left:50%;margin-left:-2px;position:absolute;top:100%;width:4px}.tp-rotv{background-color:var(--bs-bg);border-radius:var(--bs-br);box-shadow:0 2px 4px var(--bs-sh);font-family:var(--bs-ff);font-size:11px;font-weight:500;line-height:1;text-align:left}.tp-rotv_b{border-bottom-left-radius:var(--bs-br);border-bottom-right-radius:var(--bs-br);border-top-left-radius:var(--bs-br);border-top-right-radius:var(--bs-br);padding-left:calc(4px + var(--cnt-usz) + var(--cnt-hp));text-align:center}.tp-rotv.tp-rotv-expanded .tp-rotv_b{border-bottom-left-radius:0;border-bottom-right-radius:0;transition-delay:0s;transition-duration:0s}.tp-rotv.tp-rotv-not>.tp-rotv_b{display:none}.tp-rotv_b:disabled .tp-rotv_m{display:none}.tp-rotv_c>.tp-fldv.tp-v-lst>.tp-fldv_c{border-bottom-left-radius:var(--bs-br);border-bottom-right-radius:var(--bs-br)}.tp-rotv_c>.tp-fldv.tp-v-lst>.tp-fldv_i{border-bottom-left-radius:var(--bs-br)}.tp-rotv_c>.tp-fldv.tp-v-lst:not(.tp-fldv-expanded)>.tp-fldv_b{border-bottom-left-radius:var(--bs-br);border-bottom-right-radius:var(--bs-br)}.tp-rotv_c>.tp-fldv.tp-v-lst.tp-fldv-expanded>.tp-fldv_b{transition-delay:0s;transition-duration:0s}.tp-rotv_c .tp-fldv.tp-v-vlst:not(.tp-fldv-expanded)>.tp-fldv_b{border-bottom-right-radius:var(--bs-br)}.tp-rotv.tp-rotv-not .tp-rotv_c>.tp-fldv.tp-v-fst{margin-top:calc(-1*var(--cnt-vp))}.tp-rotv.tp-rotv-not .tp-rotv_c>.tp-fldv.tp-v-fst>.tp-fldv_b{border-top-left-radius:var(--bs-br);border-top-right-radius:var(--bs-br)}.tp-rotv_c>.tp-tabv.tp-v-lst>.tp-tabv_c{border-bottom-left-radius:var(--bs-br);border-bottom-right-radius:var(--bs-br)}.tp-rotv_c>.tp-tabv.tp-v-lst>.tp-tabv_i{border-bottom-left-radius:var(--bs-br)}.tp-rotv.tp-rotv-not .tp-rotv_c>.tp-tabv.tp-v-fst{margin-top:calc(-1*var(--cnt-vp))}.tp-rotv.tp-rotv-not .tp-rotv_c>.tp-tabv.tp-v-fst>.tp-tabv_t{border-top-left-radius:var(--bs-br);border-top-right-radius:var(--bs-br)}.tp-rotv.tp-v-disabled,.tp-rotv .tp-v-disabled{pointer-events:none}.tp-rotv.tp-v-hidden,.tp-rotv .tp-v-hidden{display:none}.tp-sprv_r{background-color:var(--grv-fg);border-width:0;display:block;height:2px;margin:0;width:100%}.tp-sprv.tp-v-disabled .tp-sprv_r{opacity:.5}",plugins:[nh,ch,lh,j1,rh]})}}var UU=new xD("4.0.5");var dH={cssVariables:{"--bg":"#0a0e14","--bg-elevated":"#0f1419","--muted":"#1a2332","--text":"#e6edf3","--text-secondary":"#8b949e","--accent":"#58d5ff","--accent-2":"#42a5cc","--border":"#21262d","--border-hover":"#30363d","--success":"#3fb950","--error":"#f85149"},tweakpane:{"--tp-base-background-color":"var(--bg-elevated)","--tp-base-shadow-color":"rgba(0, 0, 0, 0.4)","--tp-button-background-color":"var(--muted)","--tp-button-background-color-active":"var(--accent-2)","--tp-button-background-color-focus":"var(--accent)","--tp-button-background-color-hover":"var(--border-hover)","--tp-button-foreground-color":"var(--text)","--tp-container-background-color":"rgba(15, 20, 25, 0.6)","--tp-container-background-color-active":"rgba(15, 20, 25, 0.8)","--tp-container-background-color-focus":"rgba(15, 20, 25, 0.9)","--tp-container-background-color-hover":"rgba(15, 20, 25, 0.7)","--tp-container-foreground-color":"var(--text)","--tp-groove-foreground-color":"var(--border)","--tp-input-background-color":"rgba(26, 35, 50, 0.5)","--tp-input-background-color-active":"rgba(26, 35, 50, 0.7)","--tp-input-background-color-focus":"rgba(26, 35, 50, 0.8)","--tp-input-background-color-hover":"rgba(26, 35, 50, 0.6)","--tp-input-foreground-color":"var(--text)","--tp-label-foreground-color":"var(--text-secondary)","--tp-monitor-background-color":"rgba(26, 35, 50, 0.5)","--tp-monitor-foreground-color":"var(--text)"}};function vH(){let H=document.createElement("style");H.id="hypertool-theme";let D=Object.entries({...dH.cssVariables,...dH.tweakpane}).map(([W,h])=>`  ${W}: ${h};`).join(`
`);H.textContent=`
  body {
   margin: 0;
   padding: 0;
  }
  
:root {
${D}
}

/* Tweakpane container styling */
.tp-dfwv {
  width: 300px !important;
  max-height: calc(100vh - 40px);
  display: flex;
  
  
  backdrop-filter: blur(12px);
  border-radius: 12px;
  border: 1px solid var(--border);
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.4);
  font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
  font-size: 12px;
  // overflow: auto;
}

/* Title styling */
.tp-dfwv .tp-rotv_t {
  color: var(--accent);
  font-weight: 600;
  font-size: 13px;
  letter-spacing: 0.3px;
}

/* Folder styling */
.tp-dfwv .tp-fldv_t {
  color: var(--text);
  font-weight: 500;
}

/* Scrollbar styling */
.tp-dfwv ::-webkit-scrollbar {
  width: 8px;
}

.tp-dfwv ::-webkit-scrollbar-track {
  background: transparent;
}

.tp-dfwv ::-webkit-scrollbar-thumb {
  background: var(--border-hover);
  border-radius: 4px;
}

.tp-dfwv ::-webkit-scrollbar-thumb:hover {
  background: #3a4149;
}

/* Animation */
.tp-dfwv {
  animation: slideIn 0.2s ease-out;
}

@keyframes slideIn {
  from {
    opacity: 0;
    transform: translateX(20px);
  }
  to {
    opacity: 1;
    transform: translateX(0);
  }
}
`,document.head.appendChild(H)}class qH{constructor(H,D={}){this.pane=null,this.definitions=H,this.options={title:D.title||"Controls",position:D.position||"top-right",expanded:D.expanded!==void 0?D.expanded:!0,container:D.container!==void 0?D.container:null,onChange:D.onChange||(()=>{}),onReady:D.onReady||(()=>{})},this.params=this.extractInitialValues(H),this.init()}extractInitialValues(H){let D={};for(let[W,h]of Object.entries(H))D[W]=h.value;return D}async init(){try{vH(),await new Promise((H)=>setTimeout(H,50)),this.createPane(),this.positionPane(),this.addControls(),this.options.onReady(),console.log("[HypertoolControls] Initialized successfully")}catch(H){console.error("[HypertoolControls] Initialization error:",H)}}createPane(){let H=this.resolveContainer(),D={title:this.options.title,expanded:this.options.expanded};if(H)D.container=H;this.pane=new nD(D)}resolveContainer(){if(typeof document==="undefined")return null;let H=this.options.container;if(!H)return null;if(H instanceof HTMLElement)return H;let D=document.querySelector(H);if(!D)return console.warn(`[HypertoolControls] Container selector "${H}" did not match any elements`),null;return D}positionPane(){if(!this.pane||this.options.container)return;let H=this.pane.element;H.style.position="fixed",H.style.zIndex="10000",{"top-right":()=>{H.style.top="20px",H.style.right="20px"},"top-left":()=>{H.style.top="20px",H.style.left="20px"},"bottom-right":()=>{H.style.bottom="20px",H.style.right="20px"},"bottom-left":()=>{H.style.bottom="20px",H.style.left="20px"}}[this.options.position]()}addControls(){if(!this.pane)return;for(let[H,D]of Object.entries(this.definitions))try{this.addControl(H,D)}catch(W){console.error(`[HypertoolControls] Error adding control "${H}":`,W)}}addControl(H,D){if(!this.pane)return;let W={label:D.label||H};switch(D.type){case"number":if(D.min!==void 0)W.min=D.min;if(D.max!==void 0)W.max=D.max;if(D.step!==void 0)W.step=D.step;break;case"select":W.options=D.options;break;case"color":case"boolean":case"string":break;default:console.warn(`[HypertoolControls] Unknown control type: ${D.type}`);return}this.pane.addBinding(this.params,H,W).on("change",(U)=>{let q=H;this.params[q]=U.value;let X={key:q,value:U.value,event:U};this.options.onChange(this.values,X)})}addFolder(H){if(!this.pane)return null;return this.pane.addFolder({title:H})}set(H,D){if(H in this.params){if(this.params[H]=D,this.pane)this.pane.refresh()}}get values(){return{...this.params}}destroy(){if(this.pane)this.pane.dispose(),this.pane=null;let H=document.getElementById("hypertool-theme");if(H)H.remove()}setVisible(H){if(!this.pane)return;this.pane.element.style.display=H?"block":"none"}refresh(){if(this.pane)this.pane.refresh()}}function cD(H,D){return new qH(H,D).params}function lD(H,D){return new qH(H,D)}var oW={};J0(oW,{startInline:()=>q0,start:()=>JD,runtime:()=>a,registerAdapter:()=>W0,mirrorCss:()=>U0,inlineAdapter:()=>AH,ensureDependencies:()=>h0,attachToWindow:()=>X0});var rD=new Set(["STYLE","LINK"]);class oD{source;target;observer=null;nodeMap=new WeakMap;active=!1;constructor(H={}){this.source=H.sourceDocument??(typeof window!=="undefined"?window.parent?.document??null:null),this.target=H.targetDocument??(typeof document!=="undefined"?document:null),this.active=Boolean(H.mirror??!0)}start(){if(!this.active)return;if(!this.source||!this.target){console.warn("[hyper-frame] Unable to mirror CSS – missing source or target document.");return}this.cleanupPreviousClones(),this.syncAll(),this.attachObserver()}stop(){this.observer?.disconnect(),this.observer=null,this.nodeMap=new WeakMap,this.cleanupPreviousClones()}cleanupPreviousClones(){if(!this.target)return;this.target.querySelectorAll('[data-hyper-frame-clone="true"]').forEach((H)=>H.parentNode?.removeChild(H))}syncAll(){if(!this.source||!this.target)return;let H=this.source.head;Array.from(H.children).filter((W)=>rD.has(W.nodeName)).forEach((W)=>{let h=this.cloneNode(W);if(!h)return;this.target?.head.appendChild(h),this.nodeMap.set(W,h)})}attachObserver(){if(!this.source||!this.target)return;if(this.observer)return;this.observer=new MutationObserver((H)=>{H.forEach((D)=>{switch(D.type){case"childList":this.handleChildListMutation(D);break;case"characterData":this.handleCharacterDataMutation(D);break;case"attributes":this.handleAttributeMutation(D);break}})}),this.observer.observe(this.source.head,{childList:!0,subtree:!0,characterData:!0,attributes:!0})}handleChildListMutation(H){if(!this.target)return;H.removedNodes.forEach((D)=>{let W=this.nodeMap.get(D);if(W&&W.parentNode)W.parentNode.removeChild(W),this.nodeMap.delete(D)}),H.addedNodes.forEach((D)=>{if(!(D instanceof HTMLElement))return;if(!rD.has(D.nodeName))return;let W=this.cloneNode(D);if(!W)return;let h=H.nextSibling?this.nodeMap.get(H.nextSibling):null;if(h&&h.parentNode)h.parentNode.insertBefore(W,h);else this.target?.head.appendChild(W);this.nodeMap.set(D,W)})}handleCharacterDataMutation(H){let W=H.target.parentNode;if(!W)return;let h=this.nodeMap.get(W);if(!h)return;h.textContent=W.textContent}handleAttributeMutation(H){let D=H.target,W=this.nodeMap.get(D);if(!W||!(W instanceof Element))return;if(H.attributeName){let h=D.getAttribute(H.attributeName);if(h===null)W.removeAttribute(H.attributeName);else W.setAttribute(H.attributeName,h)}}cloneNode(H){if(!(H instanceof HTMLElement))return null;if(!rD.has(H.nodeName))return null;let D=H.cloneNode(!0);return D.setAttribute("data-hyper-frame-clone","true"),D}}class aD{pending=new Map;ensure(H){let D=this.createKey(H);if(this.pending.has(D))return this.pending.get(D);let W=this.load(H);return this.pending.set(D,W),W}async ensureAll(H=[]){for(let D of H)await this.ensure(D)}createKey(H){return`${H.type}:${H.url}`}load(H){switch(H.type){case"script":return this.injectScript(H);case"style":return this.injectStyle(H);default:return Promise.reject(new Error(`[hyper-frame] Unsupported dependency type: ${H.type}`))}}injectScript(H){if(typeof document==="undefined")return Promise.reject(new Error("[hyper-frame] document is not available"));if(Array.from(document.querySelectorAll("script")).find((W)=>W.src===H.url))return Promise.resolve();return new Promise((W,h)=>{let U=document.createElement("script");if(U.src=H.url,U.async=!0,U.dataset.hyperFrame="external",H.integrity)U.integrity=H.integrity;if(H.crossOrigin)U.crossOrigin=H.crossOrigin;if(H.attributes)Object.entries(H.attributes).forEach(([q,X])=>{U.setAttribute(q,X)});U.addEventListener("load",()=>W(),{once:!0}),U.addEventListener("error",()=>h(new Error(`[hyper-frame] Failed to load script ${H.url}`)),{once:!0}),document.head.appendChild(U)})}injectStyle(H){if(typeof document==="undefined")return Promise.reject(new Error("[hyper-frame] document is not available"));if(Array.from(document.querySelectorAll('link[rel="stylesheet"]')).find((W)=>W.href===H.url))return Promise.resolve();return new Promise((W,h)=>{let U=document.createElement("link");if(U.rel="stylesheet",U.href=H.url,U.dataset.hyperFrame="external",H.attributes)Object.entries(H.attributes).forEach(([q,X])=>{U.setAttribute(q,X)});U.addEventListener("load",()=>W(),{once:!0}),U.addEventListener("error",()=>h(new Error(`[hyper-frame] Failed to load stylesheet ${H.url}`)),{once:!0}),document.head.appendChild(U)})}}class eD{controlsApi;constructor(){this.controlsApi=this.resolveControlsApi()}resolveControlsApi(){if(typeof window==="undefined")throw new Error("[hyper-frame] window is not available");let H=window;if(!H.hypertoolControls)throw new Error("[hyper-frame] hypertool controls are not available on window");return H.hypertoolControls}init(H){let D=H.options||{};return this.controlsApi.createControlPanel(H.definitions,{title:D.title,position:D.position,expanded:D.expanded,container:D.container,onChange:(h,U)=>{let q={key:U.key,value:U.value,event:U.event};if(H.onControlChange?.(q),typeof D.onChange==="function")D.onChange(q,H.context)}})}}var b={position:"bottom-right",image:{enabled:!0,fileName:"hyperframe-capture.png"},video:{enabled:!0,fileName:"hyperframe-recording.webm",mimeType:"video/webm",bitsPerSecond:4000000,frameRate:60},autoDownload:!0};class H0{provider=null;container=null;widget=null;imageButton=null;videoButton=null;options=b;recording=!1;mediaRecorder=null;recordingChunks=[];restorePosition=null;init({container:H,options:D,provider:W}){return this.container=H,this.options=eh(D),this.provider=W??null,this.mountWidget(),this.updateButtons(),{captureImage:()=>this.captureImage(),startRecording:()=>this.startRecording(),stopRecording:()=>this.stopRecording(),isRecording:()=>this.recording,destroy:()=>this.destroy()}}setProvider(H){this.provider=H,this.updateButtons()}destroy(){if(this.videoButton?.removeEventListener("click",this.handleVideoClick),this.imageButton?.removeEventListener("click",this.handleImageClick),this.widget&&this.widget.parentElement)this.widget.parentElement.removeChild(this.widget);if(this.container&&this.restorePosition!==null)this.container.style.position=this.restorePosition;this.widget=null,this.imageButton=null,this.videoButton=null,this.container=null,this.restorePosition=null,this.provider=null,this.recording=!1,this.teardownMediaRecorder()}mountWidget(){if(!this.container)return;if(window.getComputedStyle(this.container).position==="static")this.restorePosition=this.container.style.position,this.container.style.position="relative";this.widget=document.createElement("div"),this.widget.className="hyperframe-export-widget",Object.assign(this.widget.style,{position:"absolute",zIndex:"2147483646",display:"flex",flexDirection:"column",gap:"8px",padding:"12px",borderRadius:"12px",background:"rgba(17, 24, 39, 0.75)",backdropFilter:"blur(12px)",color:"white",fontFamily:'Inter, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif',fontSize:"12px",boxShadow:"0 10px 30px rgba(0, 0, 0, 0.25)",pointerEvents:"auto"});let{x:D,y:W}=HU(this.options.position);Object.assign(this.widget.style,D),Object.assign(this.widget.style,W),this.imageButton=this.createButton("Capture PNG"),this.imageButton.addEventListener("click",this.handleImageClick),this.widget.appendChild(this.imageButton),this.videoButton=this.createButton("Start Recording"),this.videoButton.addEventListener("click",this.handleVideoClick),this.widget.appendChild(this.videoButton),this.container.appendChild(this.widget)}createButton(H){let D=document.createElement("button");return D.type="button",D.textContent=H,Object.assign(D.style,{appearance:"none",border:"1px solid rgba(255, 255, 255, 0.2)",borderRadius:"8px",padding:"8px 12px",background:"rgba(255, 255, 255, 0.12)",color:"white",fontWeight:500,cursor:"pointer",transition:"background 120ms ease, border 120ms ease, transform 120ms ease"}),D.onmouseenter=()=>{D.style.background="rgba(255, 255, 255, 0.2)",D.style.border="1px solid rgba(255, 255, 255, 0.3)"},D.onmouseleave=()=>{D.style.background="rgba(255, 255, 255, 0.12)",D.style.border="1px solid rgba(255, 255, 255, 0.2)",D.style.transform="none"},D.onmousedown=()=>{D.style.transform="scale(0.97)"},D.onmouseup=()=>{D.style.transform="none"},D}handleImageClick=async()=>{let H=await this.captureImage();if(H&&this.options.autoDownload)cW({blob:H,fileName:this.options.image.fileName})};handleVideoClick=async()=>{if(this.recording){let H=await this.stopRecording();if(H&&this.options.autoDownload)cW({blob:H,fileName:this.options.video.fileName});return}await this.startRecording()};async captureImage(){if(!this.options.image.enabled)return null;if(this.provider?.captureFrame){let H=await this.provider.captureFrame();return nW(H)}return this.captureFromCanvas()}async startRecording(){if(!this.options.video.enabled)return null;if(this.recording)return null;if(this.provider?.startRecording)return await this.provider.startRecording({mimeType:this.options.video.mimeType,bitsPerSecond:this.options.video.bitsPerSecond,frameRate:this.options.video.frameRate}),this.recording=!0,this.updateButtons(),null;let H=this.findCanvas();if(!H||typeof H.captureStream!=="function")return console.warn("[hyper-frame] Unable to start recording: canvas captureStream not available."),null;let D=H.captureStream(this.options.video.frameRate);try{this.mediaRecorder=new MediaRecorder(D,{mimeType:this.options.video.mimeType,videoBitsPerSecond:this.options.video.bitsPerSecond})}catch(W){return console.warn("[hyper-frame] Unable to create MediaRecorder:",W),null}return this.recordingChunks=[],this.mediaRecorder.ondataavailable=(W)=>{if(W.data.size>0)this.recordingChunks.push(W.data)},this.mediaRecorder.onstop=()=>{this.recording=!1,this.updateButtons()},this.mediaRecorder.start(),this.recording=!0,this.updateButtons(),null}async stopRecording(){if(!this.recording)return null;if(this.provider?.stopRecording){let W=await this.provider.stopRecording();return this.recording=this.provider.isRecording?.()??!1,this.updateButtons(),W?nW(W):null}if(!this.mediaRecorder)return null;let H=this.mediaRecorder,D=new Promise((W)=>{H.onstop=()=>{let h=new Blob(this.recordingChunks,{type:this.options.video.mimeType});this.recording=!1,this.teardownMediaRecorder(),this.updateButtons(),W(h)}});return H.stop(),D}captureFromCanvas(){let H=this.findCanvas();if(!H)return console.warn("[hyper-frame] No canvas element found for PNG capture."),null;try{let D=H.toDataURL("image/png");return lW(D)}catch(D){return console.warn("[hyper-frame] Failed to capture canvas frame:",D),null}}findCanvas(){if(!this.container)return null;return this.container.querySelector("canvas")}teardownMediaRecorder(){if(this.mediaRecorder)this.mediaRecorder.ondataavailable=null,this.mediaRecorder.onstop=null,this.mediaRecorder=null;this.recordingChunks=[]}updateButtons(){let H=this.options.image.enabled&&(this.provider?.captureFrame||this.findCanvas());if(this.imageButton)this.imageButton.disabled=!H,this.imageButton.style.opacity=H?"1":"0.5",this.imageButton.style.cursor=H?"pointer":"not-allowed";let D=this.options.video.enabled&&(this.provider?.startRecording||this.findCanvas()&&typeof MediaRecorder!=="undefined");if(this.videoButton)this.videoButton.disabled=!D,this.videoButton.textContent=this.recording?"Stop Recording":"Start Recording",this.videoButton.style.opacity=D?"1":"0.5",this.videoButton.style.cursor=D?"pointer":"not-allowed"}}function eh(H){return{position:H?.position??b.position,image:{enabled:H?.image?.enabled??b.image.enabled,fileName:H?.image?.fileName??b.image.fileName},video:{enabled:H?.video?.enabled??b.video.enabled,fileName:H?.video?.fileName??b.video.fileName,mimeType:H?.video?.mimeType??b.video.mimeType,bitsPerSecond:H?.video?.bitsPerSecond??b.video.bitsPerSecond,frameRate:H?.video?.frameRate??b.video.frameRate},autoDownload:H?.autoDownload??b.autoDownload}}function nW(H){if(H instanceof Blob)return H;if(typeof H==="string"){if(H.startsWith("data:"))return lW(H);return new Blob([H],{type:"text/plain"})}throw new Error("[hyper-frame] Unsupported capture result type.")}function lW(H){let[D,W]=H.split(","),h=D.match(/data:(.*);base64/),U=h?h[1]:"application/octet-stream",q=atob(W),X=q.length,J=new Uint8Array(X);for(let Z=0;Z<X;Z+=1)J[Z]=q.charCodeAt(Z);return new Blob([J],{type:U})}function cW({blob:H,fileName:D}){let W=URL.createObjectURL(H),h=document.createElement("a");h.href=W,h.download=D,document.body.appendChild(h),h.click(),document.body.removeChild(h),URL.revokeObjectURL(W)}function HU(H){switch(H){case"top-left":return{x:{left:"16px"},y:{top:"16px"}};case"top-right":return{x:{right:"16px"},y:{top:"16px"}};case"bottom-left":return{x:{left:"16px"},y:{bottom:"16px"}};case"bottom-right":default:return{x:{right:"16px"},y:{bottom:"16px"}}}}function rW(H={}){let D=H.documentRef??document;if(!D)throw new Error("[hyper-frame] document is not available");let W=H.containerClassName||"hypertool-sketch",h=H.target;if(h instanceof HTMLElement)return h.classList.add(W),{element:h,createdInternally:!1};if(typeof h==="string"&&h.trim().length>0){let q=D.querySelector(h);if(q)return q.classList.add(W),{element:q,createdInternally:!1};console.warn(`[hyper-frame] Could not find container for selector "${h}", creating one instead.`)}let U=D.createElement("div");return U.classList.add(W),D.body.appendChild(U),{element:U,createdInternally:!0}}class D0{adapters=new Map;dependencyManager=new aD;cssBridge=null;config;constructor(H={}){this.config=H}registerAdapter(H){this.adapters.set(H.id,H)}async ensureDependencies(H){if(!H||H.length===0)return;await this.dependencyManager.ensureAll(H)}mirrorCss(){if(this.cssBridge)return;this.cssBridge=new oD({mirror:this.config.mirrorCss!==!1}),this.cssBridge.start()}async start(H){let D=this.resolveAdapter(H.adapter);if(H.dependencies?.length)await this.ensureDependencies(H.dependencies);if(this.config.mirrorCss!==!1&&H.mirrorCss!==!1)this.mirrorCss();if(typeof D.ensure==="function")await D.ensure(H.options,this);let W=this.createMount(H.mount),h={params:{},controls:null,getInstance:()=>null},U=this.createControls(H.controlDefinitions,H.controls,h),q=U?.params??{};h.params=q,h.controls=U;let X=null,Z=this.config.exportWidget!==!1&&H.exporter!==!1?new H0:null,Q=null,Y=(E)=>{X=E,Z?.setProvider(E)},O={mount:{container:W.container,destroy:()=>W.destroy()},controls:U,params:q,runtime:this,mountOptions:H.mount,registerExportProvider:Y},A=await D.start(H.options,O);if(A.exports)Y(A.exports);if(Z){let E=typeof H.exporter==="object"?H.exporter:void 0;Q=Z.init({container:W.container,options:E,provider:X})}if(A.getInstance)h.getInstance=()=>A.getInstance();return{destroy:()=>{if(A.destroy(),W.destroy(),U){if(typeof U.destroy==="function")U.destroy();else if(typeof U.dispose==="function")U.dispose()}Q?.destroy()},setHandlers:A.setHandlers?(E)=>A.setHandlers(E):void 0,getInstance:A.getInstance?()=>A.getInstance():void 0,params:q,controls:U,container:W.container,exporter:Q,exports:A.exports}}resolveAdapter(H){if(typeof H!=="string")return H;let D=this.adapters.get(H);if(!D)throw new Error(`[hyper-frame] Adapter "${H}" is not registered`);return D}createMount(H){let D=H?{target:H.target,containerClassName:H.containerClassName,onReady:H.onReady}:void 0,W=rW(D);if(D?.onReady)D.onReady({container:W.element});return{container:W.element,destroy:()=>{if(W.createdInternally)W.element.remove()}}}createControls(H,D,W){if(!H)return null;return new eD().init({definitions:H,options:D,context:W,onControlChange:()=>{}})}}var AH={id:"inline",async start(H,D){let W=await H?.setup?.(DU(D))||{};if(W.exports)D.registerExportProvider?.(W.exports);return WU(W)}};function DU(H){return{container:H.mount.container,controls:H.controls,params:H.params,runtime:H.runtime,mountOptions:H.mountOptions,registerExports(D){H.registerExportProvider?.(D)}}}function WU(H){return{destroy:H.destroy?.bind(H)??(()=>{}),setHandlers:H.setHandlers?.bind(H),getInstance:H.getInstance?.bind(H),exports:H.exports??null}}var a=new D0({mirrorCss:!0,exportWidget:!0});a.registerAdapter(AH);function W0(H){a.registerAdapter(H)}function JD(H){return a.start(H)}function h0(H){return a.ensureDependencies(H)}function U0(){a.mirrorCss()}function q0(H={}){let{setup:D,...W}=H;return JD({...W,adapter:AH,options:{setup:D}})}function X0(){if(typeof window==="undefined")return;let H=window,D={version:"next",runtime:a,registerAdapter:W0,ensureDependencies:h0,mirrorCss:U0,start:JD,inline:{adapter:AH,start:q0}};H.hyperFrame={...H.hyperFrame||{},...D}}X0();export{dH as studioTheme,q0 as startInline,JD as start,a as runtime,W0 as registerAdapter,U0 as mirrorCss,AH as inlineAdapter,vH as injectThemeVariables,oW as frame,h0 as ensureDependencies,cD as createControls,lD as createControlPanel,sW as controls,X0 as attachToWindow,qH as HypertoolControls};

//# debugId=A62FE1479A547C4864756E2164756E21
