{
  "version": 3,
  "sources": ["../src/frame/cssBridge.ts", "../src/frame/dependencyManager.ts", "../src/frame/controlsBridge.ts", "../src/frame/exportBridge.ts", "../src/frame/utils/dom.ts", "../src/frame/runtime.ts", "../src/frame/adapters/inline.ts", "../src/frame/index.ts"],
  "sourcesContent": [
    "const CLONE_ATTRIBUTE = 'data-hyper-frame-clone';\nconst SUPPORTED_NODE_NAMES = new Set(['STYLE', 'LINK']);\n\ninterface CssBridgeOptions {\n  sourceDocument?: Document | null;\n  targetDocument?: Document | null;\n  mirror?: boolean;\n}\n\ntype NodeMapping = WeakMap<Node, Node>;\n\nexport class CssBridge {\n  private source: Document | null;\n  private target: Document | null;\n  private observer: MutationObserver | null = null;\n  private nodeMap: NodeMapping = new WeakMap();\n  private active = false;\n\n  constructor(options: CssBridgeOptions = {}) {\n    this.source = options.sourceDocument ?? (typeof window !== 'undefined' ? window.parent?.document ?? null : null);\n    this.target = options.targetDocument ?? (typeof document !== 'undefined' ? document : null);\n    this.active = Boolean(options.mirror ?? true);\n  }\n\n  start() {\n    if (!this.active) return;\n    if (!this.source || !this.target) {\n      console.warn('[hyper-frame] Unable to mirror CSS â€“ missing source or target document.');\n      return;\n    }\n\n    this.cleanupPreviousClones();\n    this.syncAll();\n    this.attachObserver();\n  }\n\n  stop() {\n    this.observer?.disconnect();\n    this.observer = null;\n    this.nodeMap = new WeakMap();\n    this.cleanupPreviousClones();\n  }\n\n  private cleanupPreviousClones() {\n    if (!this.target) return;\n    this.target\n      .querySelectorAll(`[${CLONE_ATTRIBUTE}=\"true\"]`)\n      .forEach((node) => node.parentNode?.removeChild(node));\n  }\n\n  private syncAll() {\n    if (!this.source || !this.target) return;\n    const head = this.source.head;\n    const nodes = Array.from(head.children).filter((node) => SUPPORTED_NODE_NAMES.has(node.nodeName));\n\n    nodes.forEach((node) => {\n      const clone = this.cloneNode(node);\n      if (!clone) return;\n      this.target?.head.appendChild(clone);\n      this.nodeMap.set(node, clone);\n    });\n  }\n\n  private attachObserver() {\n    if (!this.source || !this.target) return;\n    if (this.observer) return;\n\n    this.observer = new MutationObserver((mutations) => {\n      mutations.forEach((mutation) => {\n        switch (mutation.type) {\n          case 'childList':\n            this.handleChildListMutation(mutation);\n            break;\n          case 'characterData':\n            this.handleCharacterDataMutation(mutation);\n            break;\n          case 'attributes':\n            this.handleAttributeMutation(mutation);\n            break;\n        }\n      });\n    });\n\n    this.observer.observe(this.source.head, {\n      childList: true,\n      subtree: true,\n      characterData: true,\n      attributes: true,\n    });\n  }\n\n  private handleChildListMutation(mutation: MutationRecord) {\n    if (!this.target) return;\n\n    mutation.removedNodes.forEach((node) => {\n      const mapped = this.nodeMap.get(node);\n      if (mapped && mapped.parentNode) {\n        mapped.parentNode.removeChild(mapped);\n        this.nodeMap.delete(node);\n      }\n    });\n\n    mutation.addedNodes.forEach((node) => {\n      if (!(node instanceof HTMLElement)) return;\n      if (!SUPPORTED_NODE_NAMES.has(node.nodeName)) return;\n\n      const clone = this.cloneNode(node);\n      if (!clone) return;\n\n      const reference = mutation.nextSibling ? this.nodeMap.get(mutation.nextSibling) : null;\n      if (reference && reference.parentNode) {\n        reference.parentNode.insertBefore(clone, reference);\n      } else {\n        this.target?.head.appendChild(clone);\n      }\n\n      this.nodeMap.set(node, clone);\n    });\n  }\n\n  private handleCharacterDataMutation(mutation: MutationRecord) {\n    const targetNode = mutation.target;\n    const parent = targetNode.parentNode;\n    if (!parent) return;\n    const mappedParent = this.nodeMap.get(parent);\n    if (!mappedParent) return;\n\n    mappedParent.textContent = parent.textContent;\n  }\n\n  private handleAttributeMutation(mutation: MutationRecord) {\n    const target = mutation.target as Element;\n    const mapped = this.nodeMap.get(target);\n    if (!mapped || !(mapped instanceof Element)) return;\n\n    if (mutation.attributeName) {\n      const value = target.getAttribute(mutation.attributeName);\n      if (value === null) {\n        mapped.removeAttribute(mutation.attributeName);\n      } else {\n        mapped.setAttribute(mutation.attributeName, value);\n      }\n    }\n  }\n\n  private cloneNode(node: Node): HTMLElement | null {\n    if (!(node instanceof HTMLElement)) return null;\n    if (!SUPPORTED_NODE_NAMES.has(node.nodeName)) return null;\n\n    const clone = node.cloneNode(true) as HTMLElement;\n    clone.setAttribute(CLONE_ATTRIBUTE, 'true');\n    return clone;\n  }\n}\n",
    "export type ExternalDependencyType = 'script' | 'style';\n\nexport interface ExternalDependency {\n  type: ExternalDependencyType;\n  url: string;\n  attributes?: Record<string, string>;\n  integrity?: string;\n  crossOrigin?: string;\n}\n\nexport class DependencyManager {\n  private pending: Map<string, Promise<void>> = new Map();\n\n  ensure(dependency: ExternalDependency): Promise<void> {\n    const key = this.createKey(dependency);\n    if (this.pending.has(key)) {\n      return this.pending.get(key)!;\n    }\n\n    const task = this.load(dependency);\n    this.pending.set(key, task);\n    return task;\n  }\n\n  async ensureAll(dependencies: ExternalDependency[] = []): Promise<void> {\n    for (const dependency of dependencies) {\n      await this.ensure(dependency);\n    }\n  }\n\n  private createKey(dependency: ExternalDependency): string {\n    return `${dependency.type}:${dependency.url}`;\n  }\n\n  private load(dependency: ExternalDependency): Promise<void> {\n    switch (dependency.type) {\n      case 'script':\n        return this.injectScript(dependency);\n      case 'style':\n        return this.injectStyle(dependency);\n      default:\n        return Promise.reject(new Error(`[hyper-frame] Unsupported dependency type: ${dependency.type}`));\n    }\n  }\n\n  private injectScript(dependency: ExternalDependency): Promise<void> {\n    if (typeof document === 'undefined') {\n      return Promise.reject(new Error('[hyper-frame] document is not available'));\n    }\n\n    const existing = Array.from(document.querySelectorAll<HTMLScriptElement>('script')).find(\n      (script) => script.src === dependency.url,\n    );\n    if (existing) {\n      return Promise.resolve();\n    }\n\n    return new Promise((resolve, reject) => {\n      const script = document.createElement('script');\n      script.src = dependency.url;\n      script.async = true;\n      script.dataset.hyperFrame = 'external';\n\n      if (dependency.integrity) {\n        script.integrity = dependency.integrity;\n      }\n      if (dependency.crossOrigin) {\n        script.crossOrigin = dependency.crossOrigin;\n      }\n      if (dependency.attributes) {\n        Object.entries(dependency.attributes).forEach(([key, value]) => {\n          script.setAttribute(key, value);\n        });\n      }\n\n      script.addEventListener('load', () => resolve(), { once: true });\n      script.addEventListener('error', () => reject(new Error(`[hyper-frame] Failed to load script ${dependency.url}`)), {\n        once: true,\n      });\n\n      document.head.appendChild(script);\n    });\n  }\n\n  private injectStyle(dependency: ExternalDependency): Promise<void> {\n    if (typeof document === 'undefined') {\n      return Promise.reject(new Error('[hyper-frame] document is not available'));\n    }\n\n    const existing = Array.from(document.querySelectorAll<HTMLLinkElement>('link[rel=\"stylesheet\"]')).find(\n      (link) => link.href === dependency.url,\n    );\n    if (existing) {\n      return Promise.resolve();\n    }\n\n    return new Promise((resolve, reject) => {\n      const link = document.createElement('link');\n      link.rel = 'stylesheet';\n      link.href = dependency.url;\n      link.dataset.hyperFrame = 'external';\n\n      if (dependency.attributes) {\n        Object.entries(dependency.attributes).forEach(([key, value]) => {\n          link.setAttribute(key, value);\n        });\n      }\n\n      link.addEventListener('load', () => resolve(), { once: true });\n      link.addEventListener('error', () => reject(new Error(`[hyper-frame] Failed to load stylesheet ${dependency.url}`)), {\n        once: true,\n      });\n\n      document.head.appendChild(link);\n    });\n  }\n}\n",
    "import type {\n  ControlDefinitions,\n  ControlPanelOptions,\n  ControlChangePayload,\n  HyperFrameControlContext,\n} from './types';\n\ninterface HypertoolControlsApi {\n  createControlPanel: (\n    definitions: ControlDefinitions,\n    options: {\n      title?: string;\n      position?: string;\n      expanded?: boolean;\n      container?: HTMLElement | string | null;\n      onChange?: (params: Record<string, any>, context: any) => void;\n    },\n  ) => {\n    params: Record<string, any>;\n    dispose: () => void;\n  } & Record<string, any>;\n}\n\nexport interface ControlsBridgeInitOptions {\n  definitions: ControlDefinitions;\n  options?: ControlPanelOptions;\n  context: HyperFrameControlContext;\n  onControlChange?: (change: ControlChangePayload) => void;\n}\n\nexport class ControlsBridge {\n  private controlsApi: HypertoolControlsApi;\n\n  constructor() {\n    this.controlsApi = this.resolveControlsApi();\n  }\n\n  private resolveControlsApi(): HypertoolControlsApi {\n    if (typeof window === 'undefined') {\n      throw new Error('[hyper-frame] window is not available');\n    }\n    const hyperWindow = window as unknown as { hypertoolControls?: HypertoolControlsApi };\n    if (!hyperWindow.hypertoolControls) {\n      throw new Error('[hyper-frame] hypertool controls are not available on window');\n    }\n    return hyperWindow.hypertoolControls;\n  }\n\n  init(options: ControlsBridgeInitOptions) {\n    const panelOptions = options.options || {};\n    const controls = this.controlsApi.createControlPanel(options.definitions, {\n      title: panelOptions.title,\n      position: panelOptions.position,\n      expanded: panelOptions.expanded,\n      container: panelOptions.container,\n      onChange: (params: Record<string, any>, changeContext: any) => {\n        const change: ControlChangePayload = {\n          key: changeContext.key,\n          value: changeContext.value,\n          event: changeContext.event,\n        };\n\n        options.onControlChange?.(change);\n\n        if (typeof panelOptions.onChange === 'function') {\n          panelOptions.onChange(change, options.context);\n        }\n      },\n    });\n\n    return controls;\n  }\n}\n",
    "import type {\n  ExportWidgetHandle,\n  ExportWidgetOptions,\n  ExportWidgetPosition,\n  HyperFrameExportProvider,\n} from './types';\n\ninterface ExportBridgeInitOptions {\n  container: HTMLElement;\n  options?: ExportWidgetOptions;\n  provider?: HyperFrameExportProvider | null;\n}\n\ninterface DownloadOptions {\n  blob: Blob;\n  fileName: string;\n}\n\ninterface ResolvedExportOptions {\n  position: ExportWidgetPosition;\n  image: {\n    enabled: boolean;\n    fileName: string;\n  };\n  video: {\n    enabled: boolean;\n    fileName: string;\n    mimeType: string;\n    bitsPerSecond: number;\n    frameRate: number;\n  };\n  autoDownload: boolean;\n}\n\nconst DEFAULT_EXPORT_OPTIONS: ResolvedExportOptions = {\n  position: 'bottom-right',\n  image: {\n    enabled: true,\n    fileName: 'hyperframe-capture.png',\n  },\n  video: {\n    enabled: true,\n    fileName: 'hyperframe-recording.webm',\n    mimeType: 'video/webm',\n    bitsPerSecond: 4_000_000,\n    frameRate: 60,\n  },\n  autoDownload: true,\n};\n\nexport class ExportBridge {\n  private provider: HyperFrameExportProvider | null = null;\n  private container: HTMLElement | null = null;\n  private widget: HTMLDivElement | null = null;\n  private imageButton: HTMLButtonElement | null = null;\n  private videoButton: HTMLButtonElement | null = null;\n  private options: ResolvedExportOptions = DEFAULT_EXPORT_OPTIONS;\n  private recording = false;\n  private mediaRecorder: MediaRecorder | null = null;\n  private recordingChunks: BlobPart[] = [];\n  private restorePosition: string | null = null;\n\n  init({ container, options, provider }: ExportBridgeInitOptions): ExportWidgetHandle {\n    this.container = container;\n    this.options = mergeOptions(options);\n    this.provider = provider ?? null;\n    this.mountWidget();\n    this.updateButtons();\n\n    return {\n      captureImage: () => this.captureImage(),\n      startRecording: () => this.startRecording(),\n      stopRecording: () => this.stopRecording(),\n      isRecording: () => this.recording,\n      destroy: () => this.destroy(),\n    };\n  }\n\n  setProvider(provider: HyperFrameExportProvider | null) {\n    this.provider = provider;\n    this.updateButtons();\n  }\n\n  destroy() {\n    this.videoButton?.removeEventListener('click', this.handleVideoClick);\n    this.imageButton?.removeEventListener('click', this.handleImageClick);\n\n    if (this.widget && this.widget.parentElement) {\n      this.widget.parentElement.removeChild(this.widget);\n    }\n\n    if (this.container && this.restorePosition !== null) {\n      this.container.style.position = this.restorePosition;\n    }\n\n    this.widget = null;\n    this.imageButton = null;\n    this.videoButton = null;\n    this.container = null;\n    this.restorePosition = null;\n    this.provider = null;\n    this.recording = false;\n    this.teardownMediaRecorder();\n  }\n\n  private mountWidget() {\n    if (!this.container) {\n      return;\n    }\n\n    const currentPosition = window.getComputedStyle(this.container).position;\n    if (currentPosition === 'static') {\n      this.restorePosition = this.container.style.position;\n      this.container.style.position = 'relative';\n    }\n\n    this.widget = document.createElement('div');\n    this.widget.className = 'hyperframe-export-widget';\n    Object.assign(this.widget.style, {\n      position: 'absolute',\n      zIndex: '2147483646',\n      display: 'flex',\n      flexDirection: 'column',\n      gap: '8px',\n      padding: '12px',\n      borderRadius: '12px',\n      background: 'rgba(17, 24, 39, 0.75)',\n      backdropFilter: 'blur(12px)',\n      color: 'white',\n      fontFamily: 'Inter, -apple-system, BlinkMacSystemFont, \"Segoe UI\", sans-serif',\n      fontSize: '12px',\n      boxShadow: '0 10px 30px rgba(0, 0, 0, 0.25)',\n      pointerEvents: 'auto',\n    } as CSSStyleDeclaration);\n\n    const { x, y } = resolvePosition(this.options.position);\n    Object.assign(this.widget.style, x);\n    Object.assign(this.widget.style, y);\n\n    this.imageButton = this.createButton('Capture PNG');\n    this.imageButton.addEventListener('click', this.handleImageClick);\n    this.widget.appendChild(this.imageButton);\n\n    this.videoButton = this.createButton('Start Recording');\n    this.videoButton.addEventListener('click', this.handleVideoClick);\n    this.widget.appendChild(this.videoButton);\n\n    this.container.appendChild(this.widget);\n  }\n\n  private createButton(label: string) {\n    const button = document.createElement('button');\n    button.type = 'button';\n    button.textContent = label;\n    Object.assign(button.style, {\n      appearance: 'none',\n      border: '1px solid rgba(255, 255, 255, 0.2)',\n      borderRadius: '8px',\n      padding: '8px 12px',\n      background: 'rgba(255, 255, 255, 0.12)',\n      color: 'white',\n      fontWeight: 500,\n      cursor: 'pointer',\n      transition: 'background 120ms ease, border 120ms ease, transform 120ms ease',\n    });\n    button.onmouseenter = () => {\n      button.style.background = 'rgba(255, 255, 255, 0.2)';\n      button.style.border = '1px solid rgba(255, 255, 255, 0.3)';\n    };\n    button.onmouseleave = () => {\n      button.style.background = 'rgba(255, 255, 255, 0.12)';\n      button.style.border = '1px solid rgba(255, 255, 255, 0.2)';\n      button.style.transform = 'none';\n    };\n    button.onmousedown = () => {\n      button.style.transform = 'scale(0.97)';\n    };\n    button.onmouseup = () => {\n      button.style.transform = 'none';\n    };\n    return button;\n  }\n\n  private readonly handleImageClick = async () => {\n    const blob = await this.captureImage();\n    if (blob && this.options.autoDownload) {\n      downloadBlob({ blob, fileName: this.options.image.fileName });\n    }\n  };\n\n  private readonly handleVideoClick = async () => {\n    if (this.recording) {\n      const blob = await this.stopRecording();\n      if (blob && this.options.autoDownload) {\n        downloadBlob({ blob, fileName: this.options.video.fileName });\n      }\n      return;\n    }\n\n    await this.startRecording();\n  };\n\n  private async captureImage(): Promise<Blob | null> {\n    if (!this.options.image.enabled) {\n      return null;\n    }\n\n    if (this.provider?.captureFrame) {\n      const result = await this.provider.captureFrame();\n      return normalizeCaptureResult(result);\n    }\n\n    return this.captureFromCanvas();\n  }\n\n  private async startRecording(): Promise<Blob | null> {\n    if (!this.options.video.enabled) {\n      return null;\n    }\n\n    if (this.recording) {\n      return null;\n    }\n\n    if (this.provider?.startRecording) {\n      await this.provider.startRecording({\n        mimeType: this.options.video.mimeType,\n        bitsPerSecond: this.options.video.bitsPerSecond,\n        frameRate: this.options.video.frameRate,\n      });\n      this.recording = true;\n      this.updateButtons();\n      return null;\n    }\n\n    const canvas = this.findCanvas();\n    if (!canvas || typeof (canvas as any).captureStream !== 'function') {\n      console.warn('[hyper-frame] Unable to start recording: canvas captureStream not available.');\n      return null;\n    }\n\n    const stream = (canvas as HTMLCanvasElement).captureStream(this.options.video.frameRate);\n    try {\n      this.mediaRecorder = new MediaRecorder(stream, {\n        mimeType: this.options.video.mimeType,\n        videoBitsPerSecond: this.options.video.bitsPerSecond,\n      });\n    } catch (error) {\n      console.warn('[hyper-frame] Unable to create MediaRecorder:', error);\n      return null;\n    }\n\n    this.recordingChunks = [];\n\n    this.mediaRecorder.ondataavailable = (event: BlobEvent) => {\n      if (event.data.size > 0) {\n        this.recordingChunks.push(event.data);\n      }\n    };\n\n    this.mediaRecorder.onstop = () => {\n      this.recording = false;\n      this.updateButtons();\n    };\n\n    this.mediaRecorder.start();\n    this.recording = true;\n    this.updateButtons();\n    return null;\n  }\n\n  private async stopRecording(): Promise<Blob | null> {\n    if (!this.recording) {\n      return null;\n    }\n\n    if (this.provider?.stopRecording) {\n      const result = await this.provider.stopRecording();\n      this.recording = this.provider.isRecording?.() ?? false;\n      this.updateButtons();\n      return result ? normalizeCaptureResult(result) : null;\n    }\n\n    if (!this.mediaRecorder) {\n      return null;\n    }\n\n    const recorder = this.mediaRecorder;\n    const promise = new Promise<Blob | null>((resolve) => {\n      recorder.onstop = () => {\n        const blob = new Blob(this.recordingChunks, { type: this.options.video.mimeType });\n        this.recording = false;\n        this.teardownMediaRecorder();\n        this.updateButtons();\n        resolve(blob);\n      };\n    });\n\n    recorder.stop();\n    return promise;\n  }\n\n  private captureFromCanvas(): Blob | null {\n    const canvas = this.findCanvas();\n    if (!canvas) {\n      console.warn('[hyper-frame] No canvas element found for PNG capture.');\n      return null;\n    }\n\n    try {\n      const dataUrl = canvas.toDataURL('image/png');\n      return dataUrlToBlob(dataUrl);\n    } catch (error) {\n      console.warn('[hyper-frame] Failed to capture canvas frame:', error);\n      return null;\n    }\n  }\n\n  private findCanvas(): HTMLCanvasElement | null {\n    if (!this.container) {\n      return null;\n    }\n    return this.container.querySelector('canvas');\n  }\n\n  private teardownMediaRecorder() {\n    if (this.mediaRecorder) {\n      this.mediaRecorder.ondataavailable = null;\n      this.mediaRecorder.onstop = null;\n      this.mediaRecorder = null;\n    }\n    this.recordingChunks = [];\n  }\n\n  private updateButtons() {\n    const hasImageCapability = this.options.image.enabled && (this.provider?.captureFrame || this.findCanvas());\n    if (this.imageButton) {\n      this.imageButton.disabled = !hasImageCapability;\n      this.imageButton.style.opacity = hasImageCapability ? '1' : '0.5';\n      this.imageButton.style.cursor = hasImageCapability ? 'pointer' : 'not-allowed';\n    }\n\n    const hasRecordingCapability =\n      this.options.video.enabled &&\n      (this.provider?.startRecording || (this.findCanvas() && typeof MediaRecorder !== 'undefined'));\n\n    if (this.videoButton) {\n      this.videoButton.disabled = !hasRecordingCapability;\n      this.videoButton.textContent = this.recording ? 'Stop Recording' : 'Start Recording';\n      this.videoButton.style.opacity = hasRecordingCapability ? '1' : '0.5';\n      this.videoButton.style.cursor = hasRecordingCapability ? 'pointer' : 'not-allowed';\n    }\n  }\n}\n\nfunction mergeOptions(options?: ExportWidgetOptions): ResolvedExportOptions {\n  return {\n    position: options?.position ?? DEFAULT_EXPORT_OPTIONS.position,\n    image: {\n      enabled: options?.image?.enabled ?? DEFAULT_EXPORT_OPTIONS.image.enabled,\n      fileName: options?.image?.fileName ?? DEFAULT_EXPORT_OPTIONS.image.fileName,\n    },\n    video: {\n      enabled: options?.video?.enabled ?? DEFAULT_EXPORT_OPTIONS.video.enabled,\n      fileName: options?.video?.fileName ?? DEFAULT_EXPORT_OPTIONS.video.fileName,\n      mimeType: options?.video?.mimeType ?? DEFAULT_EXPORT_OPTIONS.video.mimeType,\n      bitsPerSecond: options?.video?.bitsPerSecond ?? DEFAULT_EXPORT_OPTIONS.video.bitsPerSecond,\n      frameRate: options?.video?.frameRate ?? DEFAULT_EXPORT_OPTIONS.video.frameRate,\n    },\n    autoDownload: options?.autoDownload ?? DEFAULT_EXPORT_OPTIONS.autoDownload,\n  };\n}\n\nfunction normalizeCaptureResult(result: Blob | string): Blob {\n  if (result instanceof Blob) {\n    return result;\n  }\n\n  if (typeof result === 'string') {\n    if (result.startsWith('data:')) {\n      return dataUrlToBlob(result);\n    }\n\n    return new Blob([result], { type: 'text/plain' });\n  }\n\n  throw new Error('[hyper-frame] Unsupported capture result type.');\n}\n\nfunction dataUrlToBlob(dataUrl: string): Blob {\n  const [header, data] = dataUrl.split(',');\n  const mimeMatch = header.match(/data:(.*);base64/);\n  const mimeType = mimeMatch ? mimeMatch[1] : 'application/octet-stream';\n  const binary = atob(data);\n  const length = binary.length;\n  const buffer = new Uint8Array(length);\n  for (let i = 0; i < length; i += 1) {\n    buffer[i] = binary.charCodeAt(i);\n  }\n  return new Blob([buffer], { type: mimeType });\n}\n\nfunction downloadBlob({ blob, fileName }: DownloadOptions) {\n  const url = URL.createObjectURL(blob);\n  const link = document.createElement('a');\n  link.href = url;\n  link.download = fileName;\n  document.body.appendChild(link);\n  link.click();\n  document.body.removeChild(link);\n  URL.revokeObjectURL(url);\n}\n\nfunction resolvePosition(position: ExportWidgetPosition) {\n  switch (position) {\n    case 'top-left':\n      return { x: { left: '16px' }, y: { top: '16px' } };\n    case 'top-right':\n      return { x: { right: '16px' }, y: { top: '16px' } };\n    case 'bottom-left':\n      return { x: { left: '16px' }, y: { bottom: '16px' } };\n    case 'bottom-right':\n    default:\n      return { x: { right: '16px' }, y: { bottom: '16px' } };\n  }\n}\n",
    "export interface ResolvedContainer {\n  element: HTMLElement;\n  createdInternally: boolean;\n}\n\nexport interface ResolveContainerOptions {\n  target?: HTMLElement | string | null;\n  containerClassName?: string;\n  documentRef?: Document;\n}\n\nexport function resolveContainer(options: ResolveContainerOptions = {}): ResolvedContainer {\n  const doc = options.documentRef ?? document;\n  if (!doc) {\n    throw new Error('[hyper-frame] document is not available');\n  }\n\n  const className = options.containerClassName || 'hypertool-sketch';\n  const target = options.target;\n\n  if (target instanceof HTMLElement) {\n    target.classList.add(className);\n    return { element: target, createdInternally: false };\n  }\n\n  if (typeof target === 'string' && target.trim().length > 0) {\n    const node = doc.querySelector<HTMLElement>(target);\n    if (node) {\n      node.classList.add(className);\n      return { element: node, createdInternally: false };\n    }\n    console.warn(`[hyper-frame] Could not find container for selector \"${target}\", creating one instead.`);\n  }\n\n  const container = doc.createElement('div');\n  container.classList.add(className);\n  doc.body.appendChild(container);\n  return { element: container, createdInternally: true };\n}\n",
    "import { CssBridge } from './cssBridge';\nimport { DependencyManager, ExternalDependency } from './dependencyManager';\nimport { ControlsBridge } from './controlsBridge';\nimport { ExportBridge } from './exportBridge';\nimport { resolveContainer } from './utils/dom';\nimport type {\n  ControlDefinitions,\n  ControlPanelOptions,\n  ExportWidgetHandle,\n  ExportWidgetOptions,\n  HyperFrameAdapter,\n  HyperFrameAdapterContext,\n  HyperFrameExportProvider,\n  HyperFrameRuntimeApi,\n  HyperFrameRuntimeHandle,\n  HyperFrameStartOptions,\n  HyperFrameControlContext,\n  MountOptions,\n} from './types';\n\nexport interface HyperFrameRuntimeConfig {\n  mirrorCss?: boolean;\n  exportWidget?: boolean;\n}\n\nexport class HyperFrameRuntime implements HyperFrameRuntimeApi {\n  private adapters = new Map<string, HyperFrameAdapter<any>>();\n  private dependencyManager = new DependencyManager();\n  private cssBridge: CssBridge | null = null;\n  private config: HyperFrameRuntimeConfig;\n\n  constructor(config: HyperFrameRuntimeConfig = {}) {\n    this.config = config;\n  }\n\n  registerAdapter(adapter: HyperFrameAdapter<any>) {\n    this.adapters.set(adapter.id, adapter);\n  }\n\n  async ensureDependencies(dependencies?: HyperFrameStartOptions['dependencies']): Promise<void> {\n    if (!dependencies || dependencies.length === 0) {\n      return;\n    }\n\n    await this.dependencyManager.ensureAll(dependencies as ExternalDependency[]);\n  }\n\n  mirrorCss(): void {\n    if (this.cssBridge) {\n      return;\n    }\n    this.cssBridge = new CssBridge({ mirror: this.config.mirrorCss !== false });\n    this.cssBridge.start();\n  }\n\n  async start<Options = any>(options: HyperFrameStartOptions<Options>): Promise<HyperFrameRuntimeHandle> {\n    const adapter = this.resolveAdapter(options.adapter);\n\n    if (options.dependencies?.length) {\n      await this.ensureDependencies(options.dependencies as ExternalDependency[]);\n    }\n\n    if (this.config.mirrorCss !== false && options.mirrorCss !== false) {\n      this.mirrorCss();\n    }\n\n    if (typeof adapter.ensure === 'function') {\n      await adapter.ensure(options.options, this);\n    }\n\n    const mount = this.createMount(options.mount);\n    const controlContext: HyperFrameControlContext = {\n      params: {},\n      controls: null,\n      getInstance: () => null,\n    };\n\n    const controls = this.createControls(options.controlDefinitions, options.controls, controlContext);\n    const params = controls?.params ?? {};\n    controlContext.params = params;\n    controlContext.controls = controls;\n\n    let exportProvider: HyperFrameExportProvider | null = null;\n    const shouldEnableExport = this.config.exportWidget !== false && options.exporter !== false;\n    const exportBridge = shouldEnableExport ? new ExportBridge() : null;\n    let exporterHandle: ExportWidgetHandle | null = null;\n\n    const updateExportProvider = (provider: HyperFrameExportProvider | null) => {\n      exportProvider = provider;\n      exportBridge?.setProvider(provider);\n    };\n\n    const adapterContext: HyperFrameAdapterContext = {\n      mount: {\n        container: mount.container,\n        destroy: () => mount.destroy(),\n      },\n      controls,\n      params,\n      runtime: this,\n      mountOptions: options.mount,\n      registerExportProvider: updateExportProvider,\n    };\n\n    const handle = await adapter.start(options.options, adapterContext);\n\n    if (handle.exports) {\n      updateExportProvider(handle.exports);\n    }\n\n    if (exportBridge) {\n      const exportOptions = typeof options.exporter === 'object' ? (options.exporter as ExportWidgetOptions) : undefined;\n      exporterHandle = exportBridge.init({\n        container: mount.container,\n        options: exportOptions,\n        provider: exportProvider,\n      });\n    }\n\n    if (handle.getInstance) {\n      controlContext.getInstance = () => handle.getInstance!();\n    }\n\n    const runtimeHandle: HyperFrameRuntimeHandle = {\n      destroy: () => {\n        handle.destroy();\n        mount.destroy();\n        if (controls) {\n          if (typeof controls.destroy === 'function') {\n            controls.destroy();\n          } else if (typeof controls.dispose === 'function') {\n            controls.dispose();\n          }\n        }\n        exporterHandle?.destroy();\n      },\n      setHandlers: handle.setHandlers ? (handlers: Record<string, any>) => handle.setHandlers!(handlers) : undefined,\n      getInstance: handle.getInstance ? () => handle.getInstance!() : undefined,\n      params,\n      controls,\n      container: mount.container,\n      exporter: exporterHandle,\n      exports: handle.exports,\n    };\n\n    return runtimeHandle;\n  }\n\n  private resolveAdapter<Options>(adapter: string | HyperFrameAdapter<Options>): HyperFrameAdapter<Options> {\n    if (typeof adapter !== 'string') {\n      return adapter;\n    }\n    const resolved = this.adapters.get(adapter);\n    if (!resolved) {\n      throw new Error(`[hyper-frame] Adapter \"${adapter}\" is not registered`);\n    }\n    return resolved as HyperFrameAdapter<Options>;\n  }\n\n  private createMount(options?: MountOptions | Record<string, any>): { container: HTMLElement; destroy(): void } {\n    const baseOptions: MountOptions | undefined = options\n      ? {\n          target: (options as MountOptions).target,\n          containerClassName: (options as MountOptions).containerClassName,\n          onReady: (options as MountOptions).onReady,\n        }\n      : undefined;\n\n    const mount = resolveContainer(baseOptions);\n    if (baseOptions?.onReady) {\n      baseOptions.onReady({ container: mount.element });\n    }\n    return {\n      container: mount.element,\n      destroy: () => {\n        if (mount.createdInternally) {\n          mount.element.remove();\n        }\n      },\n    };\n  }\n\n  private createControls(\n    definitions: ControlDefinitions | undefined,\n    options: ControlPanelOptions | undefined,\n    context: HyperFrameControlContext,\n  ) {\n    if (!definitions) {\n      return null;\n    }\n\n    const bridge = new ControlsBridge();\n    return bridge.init({\n      definitions,\n      options,\n      context,\n      onControlChange: () => {\n        // Adapters can override via custom control bridges\n      },\n    });\n  }\n}\n",
    "import type {\n  HyperFrameAdapter,\n  HyperFrameAdapterContext,\n  HyperFrameAdapterHandle,\n  HyperFrameExportProvider,\n} from '../types';\n\nexport interface InlineHostContext extends Omit<HyperFrameAdapterContext, 'mount'> {\n  container: HTMLElement;\n  registerExports(provider: HyperFrameExportProvider): void;\n}\n\nexport interface InlineHostLifecycle extends Omit<HyperFrameAdapterHandle, 'destroy'> {\n  destroy?(): void;\n  exports?: HyperFrameExportProvider | null;\n}\n\nexport interface InlineAdapterOptions {\n  setup?(context: InlineHostContext): Promise<InlineHostLifecycle | void> | InlineHostLifecycle | void;\n}\n\nexport const inlineAdapter: HyperFrameAdapter<InlineAdapterOptions | undefined> = {\n  id: 'inline',\n  async start(options, context) {\n    const lifecycle = (await options?.setup?.(createHostContext(context))) || {};\n\n    if (lifecycle.exports) {\n      context.registerExportProvider?.(lifecycle.exports);\n    }\n\n    return normalizeLifecycle(lifecycle);\n  },\n};\n\nfunction createHostContext(context: HyperFrameAdapterContext): InlineHostContext {\n  return {\n    container: context.mount.container,\n    controls: context.controls,\n    params: context.params,\n    runtime: context.runtime,\n    mountOptions: context.mountOptions,\n    registerExports(provider) {\n      context.registerExportProvider?.(provider);\n    },\n  };\n}\n\nfunction normalizeLifecycle(lifecycle: InlineHostLifecycle): HyperFrameAdapterHandle {\n  return {\n    destroy: lifecycle.destroy?.bind(lifecycle) ?? (() => {}),\n    setHandlers: lifecycle.setHandlers?.bind(lifecycle),\n    getInstance: lifecycle.getInstance?.bind(lifecycle),\n    exports: lifecycle.exports ?? null,\n  };\n}\n",
    "import { HyperFrameRuntime } from './runtime';\nimport { inlineAdapter, type InlineAdapterOptions } from './adapters/inline';\nimport type {\n  HyperFrameAdapter,\n  HyperFrameRuntimeHandle,\n  HyperFrameStartOptions,\n  ExportWidgetOptions,\n  ControlDefinitions,\n  ControlPanelOptions,\n  HyperFrameDependencyDescriptor,\n  MountOptions,\n} from './types';\n\nconst runtime = new HyperFrameRuntime({ mirrorCss: true, exportWidget: true });\n\nruntime.registerAdapter(inlineAdapter);\n\nexport { runtime, inlineAdapter };\n\nexport function registerAdapter(adapter: HyperFrameAdapter<any>) {\n  runtime.registerAdapter(adapter);\n}\n\nexport function start<Options>(options: HyperFrameStartOptions<Options>) {\n  return runtime.start(options);\n}\n\nexport function ensureDependencies(dependencies?: HyperFrameStartOptions['dependencies']) {\n  return runtime.ensureDependencies(dependencies);\n}\n\nexport function mirrorCss() {\n  runtime.mirrorCss();\n}\n\ntype InlineStartBase = Omit<HyperFrameStartOptions<InlineAdapterOptions>, 'adapter' | 'options'>;\n\nexport interface InlineStartOptions\n  extends InlineStartBase,\n    InlineAdapterOptions {\n  exporter?: ExportWidgetOptions | false;\n}\n\nexport function startInline(options: InlineStartOptions = {} as InlineStartOptions): Promise<HyperFrameRuntimeHandle> {\n  const { setup, ...rest } = options;\n  const base = rest as InlineStartBase;\n\n  return start({\n    ...base,\n    adapter: inlineAdapter,\n    options: { setup },\n  });\n}\n\nexport function attachToWindow() {\n  if (typeof window === 'undefined') {\n    return;\n  }\n\n  const hyperWindow = window as unknown as {\n    hyperFrame?: any;\n  };\n\n  const api = {\n    version: 'next',\n    runtime,\n    registerAdapter,\n    ensureDependencies,\n    mirrorCss,\n    start,\n    inline: {\n      adapter: inlineAdapter,\n      start: startInline,\n    },\n  };\n\n  hyperWindow.hyperFrame = { ...(hyperWindow.hyperFrame || {}), ...api };\n}\n\nattachToWindow();\n\nexport type { HyperFrameRuntimeHandle };\nexport type {\n  HyperFrameStartOptions,\n  HyperFrameAdapter,\n  ControlDefinitions,\n  ControlPanelOptions,\n  HyperFrameDependencyDescriptor,\n  MountOptions,\n  ExportWidgetOptions,\n};\n"
  ],
  "mappings": "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",
  "debugId": "6E1B1E2C40EA1DDB64756E2164756E21",
  "names": []
}