{
  "version": 3,
  "sources": ["../src/frame/cssBridge.ts", "../src/frame/dependencyManager.ts", "../src/frame/utils/dom.ts", "../src/frame/controlsBridge.ts", "../src/frame/runtime.ts", "../src/frame/utils/wait.ts", "../src/frame/adapters/p5.ts", "../src/frame/adapters/three.ts", "../src/frame/index.ts"],
  "sourcesContent": [
    "const CLONE_ATTRIBUTE = 'data-hyper-frame-clone';\nconst SUPPORTED_NODE_NAMES = new Set(['STYLE', 'LINK']);\n\ninterface CssBridgeOptions {\n  sourceDocument?: Document | null;\n  targetDocument?: Document | null;\n  mirror?: boolean;\n}\n\ntype NodeMapping = WeakMap<Node, Node>;\n\nexport class CssBridge {\n  private source: Document | null;\n  private target: Document | null;\n  private observer: MutationObserver | null = null;\n  private nodeMap: NodeMapping = new WeakMap();\n  private active = false;\n\n  constructor(options: CssBridgeOptions = {}) {\n    this.source = options.sourceDocument ?? (typeof window !== 'undefined' ? window.parent?.document ?? null : null);\n    this.target = options.targetDocument ?? (typeof document !== 'undefined' ? document : null);\n    this.active = Boolean(options.mirror ?? true);\n  }\n\n  start() {\n    if (!this.active) return;\n    if (!this.source || !this.target) {\n      console.warn('[hyper-frame] Unable to mirror CSS â€“ missing source or target document.');\n      return;\n    }\n\n    this.cleanupPreviousClones();\n    this.syncAll();\n    this.attachObserver();\n  }\n\n  stop() {\n    this.observer?.disconnect();\n    this.observer = null;\n    this.nodeMap = new WeakMap();\n    this.cleanupPreviousClones();\n  }\n\n  private cleanupPreviousClones() {\n    if (!this.target) return;\n    this.target\n      .querySelectorAll(`[${CLONE_ATTRIBUTE}=\"true\"]`)\n      .forEach((node) => node.parentNode?.removeChild(node));\n  }\n\n  private syncAll() {\n    if (!this.source || !this.target) return;\n    const head = this.source.head;\n    const nodes = Array.from(head.children).filter((node) => SUPPORTED_NODE_NAMES.has(node.nodeName));\n\n    nodes.forEach((node) => {\n      const clone = this.cloneNode(node);\n      if (!clone) return;\n      this.target?.head.appendChild(clone);\n      this.nodeMap.set(node, clone);\n    });\n  }\n\n  private attachObserver() {\n    if (!this.source || !this.target) return;\n    if (this.observer) return;\n\n    this.observer = new MutationObserver((mutations) => {\n      mutations.forEach((mutation) => {\n        switch (mutation.type) {\n          case 'childList':\n            this.handleChildListMutation(mutation);\n            break;\n          case 'characterData':\n            this.handleCharacterDataMutation(mutation);\n            break;\n          case 'attributes':\n            this.handleAttributeMutation(mutation);\n            break;\n        }\n      });\n    });\n\n    this.observer.observe(this.source.head, {\n      childList: true,\n      subtree: true,\n      characterData: true,\n      attributes: true,\n    });\n  }\n\n  private handleChildListMutation(mutation: MutationRecord) {\n    if (!this.target) return;\n\n    mutation.removedNodes.forEach((node) => {\n      const mapped = this.nodeMap.get(node);\n      if (mapped && mapped.parentNode) {\n        mapped.parentNode.removeChild(mapped);\n        this.nodeMap.delete(node);\n      }\n    });\n\n    mutation.addedNodes.forEach((node) => {\n      if (!(node instanceof HTMLElement)) return;\n      if (!SUPPORTED_NODE_NAMES.has(node.nodeName)) return;\n\n      const clone = this.cloneNode(node);\n      if (!clone) return;\n\n      const reference = mutation.nextSibling ? this.nodeMap.get(mutation.nextSibling) : null;\n      if (reference && reference.parentNode) {\n        reference.parentNode.insertBefore(clone, reference);\n      } else {\n        this.target?.head.appendChild(clone);\n      }\n\n      this.nodeMap.set(node, clone);\n    });\n  }\n\n  private handleCharacterDataMutation(mutation: MutationRecord) {\n    const targetNode = mutation.target;\n    const parent = targetNode.parentNode;\n    if (!parent) return;\n    const mappedParent = this.nodeMap.get(parent);\n    if (!mappedParent) return;\n\n    mappedParent.textContent = parent.textContent;\n  }\n\n  private handleAttributeMutation(mutation: MutationRecord) {\n    const target = mutation.target as Element;\n    const mapped = this.nodeMap.get(target);\n    if (!mapped || !(mapped instanceof Element)) return;\n\n    if (mutation.attributeName) {\n      const value = target.getAttribute(mutation.attributeName);\n      if (value === null) {\n        mapped.removeAttribute(mutation.attributeName);\n      } else {\n        mapped.setAttribute(mutation.attributeName, value);\n      }\n    }\n  }\n\n  private cloneNode(node: Node): HTMLElement | null {\n    if (!(node instanceof HTMLElement)) return null;\n    if (!SUPPORTED_NODE_NAMES.has(node.nodeName)) return null;\n\n    const clone = node.cloneNode(true) as HTMLElement;\n    clone.setAttribute(CLONE_ATTRIBUTE, 'true');\n    return clone;\n  }\n}\n",
    "export type ExternalDependencyType = 'script' | 'style';\n\nexport interface ExternalDependency {\n  type: ExternalDependencyType;\n  url: string;\n  attributes?: Record<string, string>;\n  integrity?: string;\n  crossOrigin?: string;\n}\n\nexport class DependencyManager {\n  private pending: Map<string, Promise<void>> = new Map();\n\n  ensure(dependency: ExternalDependency): Promise<void> {\n    const key = this.createKey(dependency);\n    if (this.pending.has(key)) {\n      return this.pending.get(key)!;\n    }\n\n    const task = this.load(dependency);\n    this.pending.set(key, task);\n    return task;\n  }\n\n  async ensureAll(dependencies: ExternalDependency[] = []): Promise<void> {\n    for (const dependency of dependencies) {\n      await this.ensure(dependency);\n    }\n  }\n\n  private createKey(dependency: ExternalDependency): string {\n    return `${dependency.type}:${dependency.url}`;\n  }\n\n  private load(dependency: ExternalDependency): Promise<void> {\n    switch (dependency.type) {\n      case 'script':\n        return this.injectScript(dependency);\n      case 'style':\n        return this.injectStyle(dependency);\n      default:\n        return Promise.reject(new Error(`[hyper-frame] Unsupported dependency type: ${dependency.type}`));\n    }\n  }\n\n  private injectScript(dependency: ExternalDependency): Promise<void> {\n    if (typeof document === 'undefined') {\n      return Promise.reject(new Error('[hyper-frame] document is not available'));\n    }\n\n    const existing = Array.from(document.querySelectorAll<HTMLScriptElement>('script')).find(\n      (script) => script.src === dependency.url,\n    );\n    if (existing) {\n      return Promise.resolve();\n    }\n\n    return new Promise((resolve, reject) => {\n      const script = document.createElement('script');\n      script.src = dependency.url;\n      script.async = true;\n      script.dataset.hyperFrame = 'external';\n\n      if (dependency.integrity) {\n        script.integrity = dependency.integrity;\n      }\n      if (dependency.crossOrigin) {\n        script.crossOrigin = dependency.crossOrigin;\n      }\n      if (dependency.attributes) {\n        Object.entries(dependency.attributes).forEach(([key, value]) => {\n          script.setAttribute(key, value);\n        });\n      }\n\n      script.addEventListener('load', () => resolve(), { once: true });\n      script.addEventListener('error', () => reject(new Error(`[hyper-frame] Failed to load script ${dependency.url}`)), {\n        once: true,\n      });\n\n      document.head.appendChild(script);\n    });\n  }\n\n  private injectStyle(dependency: ExternalDependency): Promise<void> {\n    if (typeof document === 'undefined') {\n      return Promise.reject(new Error('[hyper-frame] document is not available'));\n    }\n\n    const existing = Array.from(document.querySelectorAll<HTMLLinkElement>('link[rel=\"stylesheet\"]')).find(\n      (link) => link.href === dependency.url,\n    );\n    if (existing) {\n      return Promise.resolve();\n    }\n\n    return new Promise((resolve, reject) => {\n      const link = document.createElement('link');\n      link.rel = 'stylesheet';\n      link.href = dependency.url;\n      link.dataset.hyperFrame = 'external';\n\n      if (dependency.attributes) {\n        Object.entries(dependency.attributes).forEach(([key, value]) => {\n          link.setAttribute(key, value);\n        });\n      }\n\n      link.addEventListener('load', () => resolve(), { once: true });\n      link.addEventListener('error', () => reject(new Error(`[hyper-frame] Failed to load stylesheet ${dependency.url}`)), {\n        once: true,\n      });\n\n      document.head.appendChild(link);\n    });\n  }\n}\n",
    "export interface ResolvedContainer {\n  element: HTMLElement;\n  createdInternally: boolean;\n}\n\nexport interface ResolveContainerOptions {\n  target?: HTMLElement | string | null;\n  containerClassName?: string;\n  documentRef?: Document;\n}\n\nexport function resolveContainer(options: ResolveContainerOptions = {}): ResolvedContainer {\n  const doc = options.documentRef ?? document;\n  if (!doc) {\n    throw new Error('[hyper-frame] document is not available');\n  }\n\n  const className = options.containerClassName || 'hypertool-sketch';\n  const target = options.target;\n\n  if (target instanceof HTMLElement) {\n    target.classList.add(className);\n    return { element: target, createdInternally: false };\n  }\n\n  if (typeof target === 'string' && target.trim().length > 0) {\n    const node = doc.querySelector<HTMLElement>(target);\n    if (node) {\n      node.classList.add(className);\n      return { element: node, createdInternally: false };\n    }\n    console.warn(`[hyper-frame] Could not find container for selector \"${target}\", creating one instead.`);\n  }\n\n  const container = doc.createElement('div');\n  container.classList.add(className);\n  doc.body.appendChild(container);\n  return { element: container, createdInternally: true };\n}\n",
    "import type {\n  ControlDefinitions,\n  ControlPanelOptions,\n  ControlChangePayload,\n  P5SketchContext,\n} from './types';\n\ninterface HypertoolControlsApi {\n  createControlPanel: (\n    definitions: ControlDefinitions,\n    options: {\n      title?: string;\n      position?: string;\n      expanded?: boolean;\n      container?: HTMLElement | string | null;\n      onChange?: (params: Record<string, any>, context: any) => void;\n    },\n  ) => {\n    params: Record<string, any>;\n    dispose: () => void;\n  } & Record<string, any>;\n}\n\nexport interface ControlsBridgeInitOptions {\n  definitions: ControlDefinitions;\n  options?: ControlPanelOptions;\n  context: P5SketchContext;\n  onControlChange?: (change: ControlChangePayload) => void;\n}\n\nexport class ControlsBridge {\n  private controlsApi: HypertoolControlsApi;\n\n  constructor() {\n    this.controlsApi = this.resolveControlsApi();\n  }\n\n  private resolveControlsApi(): HypertoolControlsApi {\n    if (typeof window === 'undefined') {\n      throw new Error('[hyper-frame] window is not available');\n    }\n    const hyperWindow = window as unknown as { hypertoolControls?: HypertoolControlsApi };\n    if (!hyperWindow.hypertoolControls) {\n      throw new Error('[hyper-frame] hypertool controls are not available on window');\n    }\n    return hyperWindow.hypertoolControls;\n  }\n\n  init(options: ControlsBridgeInitOptions) {\n    const panelOptions = options.options || {};\n    const controls = this.controlsApi.createControlPanel(options.definitions, {\n      title: panelOptions.title,\n      position: panelOptions.position,\n      expanded: panelOptions.expanded,\n      container: panelOptions.container,\n      onChange: (params: Record<string, any>, changeContext: any) => {\n        if (typeof panelOptions.onChange === 'function') {\n          const change: ControlChangePayload = {\n            key: changeContext.key,\n            value: changeContext.value,\n            event: changeContext.event,\n          };\n          options.onControlChange?.(change);\n          panelOptions.onChange(change, options.context);\n        } else {\n          options.onControlChange?.({\n            key: changeContext.key,\n            value: changeContext.value,\n            event: changeContext.event,\n          });\n        }\n      },\n    });\n\n    return controls;\n  }\n}\n",
    "import { CssBridge } from './cssBridge';\nimport { DependencyManager, ExternalDependency } from './dependencyManager';\nimport { resolveContainer } from './utils/dom';\nimport type { P5Handler } from './types';\nimport type {\n  HyperFrameAdapter,\n  HyperFrameAdapterContext,\n  HyperFrameRuntimeHandle,\n  HyperFrameRuntimeApi,\n  HyperFrameStartOptions,\n  MountOptions,\n  MountResult,\n  RunP5SketchOptions,\n  RunP5SketchResult,\n  RunThreeSketchOptions,\n  RunThreeSketchResult,\n  StartP5SketchOptions,\n  StartThreeSketchOptions,\n  P5HandlerMap,\n  P5SketchHandlers,\n  ThreeLifecycleHandlers,\n  P5Instance,\n  MountThreeOptions,\n  ThreeContext,\n} from './types';\nimport { ControlsBridge } from './controlsBridge';\nimport type { ControlChangePayload, P5SketchContext, ThreeSketchContext } from './types';\n\nfunction mapP5Handlers(handlerMap: P5HandlerMap): P5SketchHandlers {\n  const mapped: P5SketchHandlers = {};\n\n  Object.entries(handlerMap).forEach(([key, handler]) => {\n    if (typeof handler === 'function') {\n      mapped[key] = (instance, _context, ...args) => {\n        (handler as P5Handler)(instance, ...args);\n      };\n    }\n  });\n\n  return mapped;\n}\n\nexport interface HyperFrameRuntimeConfig {\n  mirrorCss?: boolean;\n}\n\nexport class HyperFrameRuntime implements HyperFrameRuntimeApi {\n  private adapters = new Map<string, HyperFrameAdapter<any>>();\n  private dependencyManager = new DependencyManager();\n  private cssBridge: CssBridge | null = null;\n  private config: HyperFrameRuntimeConfig;\n\n  constructor(config: HyperFrameRuntimeConfig = {}) {\n    this.config = config;\n  }\n\n  registerAdapter(adapter: HyperFrameAdapter<any>) {\n    this.adapters.set(adapter.id, adapter);\n  }\n\n  async ensureDependencies(dependencies?: HyperFrameStartOptions['dependencies']): Promise<void> {\n    if (!dependencies || dependencies.length === 0) {\n      return;\n    }\n\n    await this.dependencyManager.ensureAll(\n      dependencies as ExternalDependency[],\n    );\n  }\n\n  mirrorCss(): void {\n    if (this.cssBridge) {\n      return;\n    }\n    this.cssBridge = new CssBridge({ mirror: this.config.mirrorCss !== false });\n    this.cssBridge.start();\n  }\n\n  async start<Options = any>(options: HyperFrameStartOptions<Options>): Promise<HyperFrameRuntimeHandle> {\n    const adapter = this.resolveAdapter(options.adapter);\n\n    if (options.dependencies?.length) {\n      await this.ensureDependencies(options.dependencies);\n    }\n\n    if (this.config.mirrorCss !== false && options.mirrorCss !== false) {\n      this.mirrorCss();\n    }\n\n    if (typeof adapter.ensure === 'function') {\n      await adapter.ensure(options.options, this);\n    }\n\n    const mount = this.createMount(options.mount);\n    const controlsBridge = new ControlsBridge();\n\n    const sketchContext: P5SketchContext = {\n      params: {},\n      controls: null,\n      getInstance: () => null,\n      getP5Instance: () => null,\n    };\n\n    const controls = options.controlDefinitions\n      ? controlsBridge.init({\n          definitions: options.controlDefinitions,\n          options: options.controls,\n          context: sketchContext,\n          onControlChange: (change: ControlChangePayload) => {\n            // placeholder to keep compatibility; adapters can override\n          },\n        })\n      : null;\n\n    const adapterContext: HyperFrameAdapterContext = {\n      mount: {\n        container: mount.container,\n        destroy: () => mount.destroy(),\n      },\n      controls,\n      params: controls?.params ?? {},\n      runtime: this,\n      mountOptions: options.mount,\n    };\n\n    const handle = await adapter.start(options.options, adapterContext);\n\n    if (sketchContext) {\n      sketchContext.params = adapterContext.params;\n      sketchContext.controls = controls;\n      const getInstance = () => (handle.getInstance ? handle.getInstance() : null);\n      sketchContext.getInstance = getInstance;\n      sketchContext.getP5Instance = getInstance;\n    }\n\n    const runtimeHandle: HyperFrameRuntimeHandle = {\n      destroy: () => {\n        handle.destroy();\n        mount.destroy();\n        if (controls) {\n          if (typeof controls.destroy === 'function') {\n            controls.destroy();\n          } else if (typeof controls.dispose === 'function') {\n            controls.dispose();\n          }\n        }\n      },\n      setHandlers: handle.setHandlers ? (handlers: Record<string, any>) => handle.setHandlers!(handlers) : undefined,\n      getInstance: handle.getInstance ? () => handle.getInstance!() : undefined,\n      params: adapterContext.params,\n      controls,\n      container: mount.container,\n    };\n\n    return runtimeHandle;\n  }\n\n  private resolveAdapter<Options>(adapter: string | HyperFrameAdapter<Options>): HyperFrameAdapter<Options> {\n    if (typeof adapter !== 'string') {\n      return adapter;\n    }\n    const resolved = this.adapters.get(adapter);\n    if (!resolved) {\n      throw new Error(`[hyper-frame] Adapter \"${adapter}\" is not registered`);\n    }\n    return resolved as HyperFrameAdapter<Options>;\n  }\n\n  private createMount(options?: MountOptions | Record<string, any>): { container: HTMLElement; destroy(): void } {\n    const baseOptions: MountOptions | undefined = options\n      ? {\n          target: (options as MountOptions).target,\n          containerClassName: (options as MountOptions).containerClassName,\n          onReady: (options as MountOptions).onReady,\n        }\n      : undefined;\n\n    const mount = resolveContainer(baseOptions);\n    if (baseOptions?.onReady) {\n      baseOptions.onReady({ container: mount.element });\n    }\n    return {\n      container: mount.element,\n      destroy: () => {\n        if (mount.createdInternally) {\n          mount.element.remove();\n        }\n      },\n    };\n  }\n\n  // Backwards compatibility helpers --------------------------------------------------\n\n  async runP5Sketch(options: RunP5SketchOptions): Promise<RunP5SketchResult> {\n    const handle = await this.start({\n      adapter: 'p5',\n      options: options.handlers,\n      controlDefinitions: options.controlDefinitions,\n      controls: options.controls,\n      mount: options.mount,\n      dependencies: options.dependencies,\n      mirrorCss: options.mirrorCss,\n    });\n\n    const params = handle.params ?? {};\n    const controls = handle.controls;\n\n    return {\n      params,\n      controls,\n      context: {\n        params,\n        controls,\n        getP5Instance: () => (handle.getInstance ? handle.getInstance() : null),\n        getInstance: () => (handle.getInstance ? handle.getInstance() : null),\n      },\n      destroy: () => handle.destroy(),\n      setHandlers: (handlers: P5SketchHandlers) => handle.setHandlers?.(handlers as Record<string, any>),\n      getInstance: () => (handle.getInstance ? (handle.getInstance() as any) : null),\n    };\n  }\n\n  async startP5Sketch(options: StartP5SketchOptions) {\n    const dependencies = [...(options.dependencies ?? [])];\n    if (options.p5?.url) {\n      dependencies.unshift({ type: 'script', url: options.p5.url });\n    }\n    return this.runP5Sketch({\n      ...options,\n      dependencies,\n    });\n  }\n\n  async mountP5Sketch(handlers: P5HandlerMap, mount?: MountOptions): Promise<MountResult<P5Instance>> {\n    const handle = await this.start({\n      adapter: 'p5',\n      options: mapP5Handlers(handlers),\n      mount,\n    });\n\n    return {\n      container: handle.container,\n      getInstance: () => (handle.getInstance ? (handle.getInstance() as P5Instance | null) : null),\n      setHandlers: (nextHandlers: Record<string, any>) => {\n        handle.setHandlers?.(mapP5Handlers(nextHandlers as P5HandlerMap));\n      },\n      destroy: () => handle.destroy(),\n    };\n  }\n\n  async runThreeSketch(options: RunThreeSketchOptions): Promise<RunThreeSketchResult> {\n    const handle = await this.start({\n      adapter: 'three',\n      options: options.handlers,\n      controlDefinitions: options.controlDefinitions,\n      controls: options.controls,\n      mount: options.mount,\n      dependencies: options.dependencies,\n      mirrorCss: options.mirrorCss,\n    });\n\n    const context: ThreeSketchContext = {\n      params: handle.params ?? {},\n      controls: handle.controls,\n      getThreeContext: () => (handle.getInstance ? handle.getInstance() : null),\n    };\n\n    return {\n      params: handle.params ?? {},\n      controls: handle.controls,\n      context,\n      destroy: () => handle.destroy(),\n      setHandlers: (handlers: ThreeLifecycleHandlers) => handle.setHandlers?.(handlers as Record<string, any>),\n      getContext: () => (handle.getInstance ? (handle.getInstance() as any) : null),\n    };\n  }\n\n  async startThreeSketch(options: StartThreeSketchOptions) {\n    const dependencies = [...(options.dependencies ?? [])];\n    if (options.three?.url) {\n      dependencies.unshift({ type: 'script', url: options.three.url });\n    }\n    return this.runThreeSketch({\n      ...options,\n      dependencies,\n    });\n  }\n\n  async mountThreeSketch(handlers: ThreeLifecycleHandlers, mount?: MountThreeOptions): Promise<MountResult<ThreeContext>> {\n    const handle = await this.start({\n      adapter: 'three',\n      options: handlers,\n      mount,\n    });\n\n    return {\n      container: handle.container,\n      getInstance: () => (handle.getInstance ? (handle.getInstance() as ThreeContext | null) : null),\n      setHandlers: (nextHandlers: Record<string, any>) => {\n        handle.setHandlers?.(nextHandlers as ThreeLifecycleHandlers);\n      },\n      destroy: () => handle.destroy(),\n    };\n  }\n}\n",
    "export function nextFrame(callback: () => void) {\n  if (typeof requestAnimationFrame === 'function') {\n    requestAnimationFrame(callback);\n  } else {\n    setTimeout(callback, 16);\n  }\n}\n\nexport function waitForCondition(condition: () => boolean, maxAttempts: number, label: string): Promise<void> {\n  return new Promise((resolve, reject) => {\n    let attempts = 0;\n\n    function tick() {\n      attempts += 1;\n\n      try {\n        if (condition()) {\n          resolve();\n          return;\n        }\n      } catch (error) {\n        // ignore errors from condition evaluation and keep waiting\n      }\n\n      if (attempts >= maxAttempts) {\n        reject(new Error(`[hyper-frame] Timed out waiting for ${label}`));\n        return;\n      }\n\n      nextFrame(tick);\n    }\n\n    tick();\n  });\n}\n",
    "import type {\n  HyperFrameAdapter,\n  HyperFrameAdapterContext,\n  HyperFrameAdapterHandle,\n  P5Instance,\n  P5SketchHandlers,\n  P5SketchContext,\n} from '../types';\nimport { waitForCondition } from '../utils/wait';\n\nconst DEFAULT_P5_CDN_URL = 'https://cdn.jsdelivr.net/npm/p5@1.6.0/lib/p5.min.js';\n\ntype P5Constructor = new (sketch: (p5: P5Instance) => void, node?: HTMLElement) => P5Instance;\n\ndeclare global {\n  interface Window {\n    p5?: P5Constructor;\n  }\n}\n\nfunction getP5Constructor(): P5Constructor {\n  if (typeof window === 'undefined') {\n    throw new Error('[hyper-frame] window is not available');\n  }\n\n  const ctor = (window as any).p5;\n\n  if (typeof ctor !== 'function') {\n    throw new Error('[hyper-frame] p5 constructor not found on window. Ensure p5 is loaded before hyper-frame.');\n  }\n\n  return ctor as P5Constructor;\n}\n\nfunction applyHandlers(instance: P5Instance, handlers: Record<string, (...args: any[]) => void>) {\n  for (const key in handlers) {\n    if (Object.prototype.hasOwnProperty.call(handlers, key)) {\n      const handler = handlers[key];\n      if (typeof handler === 'function') {\n        (instance as Record<string, unknown>)[key] = handler;\n      }\n    }\n  }\n}\n\nfunction wrapHandlers(\n  handlers: P5SketchHandlers,\n  sketchContext: P5SketchContext\n): Record<string, (...args: any[]) => void> {\n  const wrapped: Record<string, (...args: any[]) => void> = {};\n\n  Object.entries(handlers).forEach(([key, handler]) => {\n    if (typeof handler === 'function') {\n      wrapped[key] = (instance: P5Instance, ...args: any[]) => {\n        return handler(instance, sketchContext, ...args);\n      };\n    }\n  });\n\n  return wrapped;\n}\n\nasync function ensureP5Available(): Promise<void> {\n  if (typeof window === 'undefined') {\n    throw new Error('[hyper-frame] window is not available');\n  }\n\n  if (typeof (window as any).p5 === 'function') {\n    return;\n  }\n\n  if (typeof document === 'undefined') {\n    throw new Error('[hyper-frame] document is not available');\n  }\n\n  const scriptUrl = DEFAULT_P5_CDN_URL;\n  const existing = Array.from(document.querySelectorAll(`script[src=\"${scriptUrl}\"]`));\n  if (existing.length === 0) {\n    const script = document.createElement('script');\n    script.src = scriptUrl;\n    script.async = true;\n    script.dataset.hyperFrame = 'p5';\n    document.head.appendChild(script);\n  }\n\n  await waitForCondition(() => typeof (window as any).p5 === 'function', 300, 'p5 constructor');\n}\n\nexport const p5Adapter: HyperFrameAdapter<P5SketchHandlers> = {\n  id: 'p5',\n  async ensure(_handlers, runtime) {\n    try {\n      await ensureP5Available();\n    } catch (error) {\n      await runtime.ensureDependencies([{ type: 'script', url: DEFAULT_P5_CDN_URL }]);\n      await waitForCondition(() => typeof (window as any).p5 === 'function', 300, 'p5 constructor');\n    }\n  },\n  async start(handlers: P5SketchHandlers, context: HyperFrameAdapterContext): Promise<HyperFrameAdapterHandle> {\n    if (typeof document === 'undefined') {\n      throw new Error('mountP5Sketch cannot run outside a browser environment');\n    }\n\n    let activeInstance: P5Instance | null = null;\n    let currentHandlers: P5SketchHandlers = { ...handlers };\n\n    const sketchContext: P5SketchContext = {\n      params: context.params,\n      controls: context.controls,\n      getInstance: () => activeInstance,\n      getP5Instance: () => activeInstance,\n    };\n\n    const wrappedHandlers = () => wrapHandlers(currentHandlers, sketchContext);\n\n    function sketch(p5Instance: P5Instance) {\n      activeInstance = p5Instance;\n      applyHandlers(p5Instance, wrappedHandlers());\n    }\n\n    const P5Ctor = getP5Constructor();\n    const p5Controller = new P5Ctor(sketch, context.mount.container);\n    if (!activeInstance) {\n      activeInstance = (p5Controller as unknown) as P5Instance;\n    }\n\n    return {\n      destroy() {\n        if (activeInstance) {\n          activeInstance.remove();\n          activeInstance = null;\n        }\n      },\n      setHandlers(nextHandlers: Record<string, any>) {\n        currentHandlers = { ...nextHandlers } as P5SketchHandlers;\n        if (activeInstance) {\n          applyHandlers(activeInstance, wrappedHandlers());\n        }\n      },\n      getInstance() {\n        return activeInstance;\n      },\n    };\n  },\n};\n",
    "import type {\n  HyperFrameAdapter,\n  HyperFrameAdapterContext,\n  HyperFrameAdapterHandle,\n  ThreeContext,\n  ThreeLifecycleHandlers,\n  ThreeSketchContext,\n} from '../types';\n\nfunction getThreeConstructors(): any {\n  if (typeof window === 'undefined') {\n    throw new Error('[hyper-frame] window is not available');\n  }\n\n  const THREE = (window as any).THREE;\n\n  if (typeof THREE !== 'object') {\n    throw new Error('[hyper-frame] THREE not found on window. Make sure to import and expose Three.js on window in your sketch.');\n  }\n\n  return THREE;\n}\n\nfunction createSketchContext(context: HyperFrameAdapterContext, threeContext: ThreeContext): ThreeSketchContext {\n  return {\n    params: context.params,\n    controls: context.controls,\n    getThreeContext: () => threeContext,\n  };\n}\n\nexport const threeAdapter: HyperFrameAdapter<ThreeLifecycleHandlers> = {\n  id: 'three',\n  async start(handlers: ThreeLifecycleHandlers, context: HyperFrameAdapterContext): Promise<HyperFrameAdapterHandle> {\n    if (typeof document === 'undefined') {\n      throw new Error('mountThreeSketch cannot run outside a browser environment');\n    }\n\n    const THREE = getThreeConstructors();\n    const mountOptions = (context.mountOptions || {}) as Record<string, any>;\n    const cameraOpts = mountOptions.camera || {};\n    const rendererOpts = mountOptions.renderer || {};\n    const container = context.mount.container;\n\n    const scene = new THREE.Scene();\n\n    const cameraType = cameraOpts.type || 'perspective';\n    let camera: any;\n\n    if (cameraType === 'perspective') {\n      camera = new THREE.PerspectiveCamera(\n        cameraOpts.fov || 75,\n        container.clientWidth / (container.clientHeight || 1),\n        cameraOpts.near || 0.1,\n        cameraOpts.far || 1000,\n      );\n    } else {\n      const aspect = (container.clientWidth || window.innerWidth) / (container.clientHeight || window.innerHeight || 1);\n      camera = new THREE.OrthographicCamera(\n        -aspect,\n        aspect,\n        1,\n        -1,\n        cameraOpts.near || 0.1,\n        cameraOpts.far || 1000,\n      );\n    }\n\n    if (cameraOpts.position) {\n      camera.position.set(...cameraOpts.position);\n    } else {\n      camera.position.z = 5;\n    }\n\n    const renderer = new THREE.WebGLRenderer({\n      antialias: rendererOpts.antialias !== false,\n      alpha: Boolean(rendererOpts.alpha),\n      preserveDrawingBuffer: Boolean(rendererOpts.preserveDrawingBuffer),\n    });\n\n    const width = container.clientWidth || window.innerWidth;\n    const height = container.clientHeight || window.innerHeight;\n    renderer.setSize(width, height);\n    renderer.setPixelRatio(window.devicePixelRatio);\n    container.appendChild(renderer.domElement);\n\n    let orbitControls: any = null;\n    if (mountOptions.orbitControls) {\n      const OrbitControls = (window as any).OrbitControls || THREE.OrbitControls;\n      if (OrbitControls) {\n        orbitControls = new OrbitControls(camera, renderer.domElement);\n      } else {\n        console.warn('[hyper-frame] OrbitControls not found. Make sure to import and expose it on window.');\n      }\n    }\n\n    const threeContext: ThreeContext = {\n      scene,\n      camera,\n      renderer,\n      controls: orbitControls || undefined,\n    };\n\n    let currentHandlers: ThreeLifecycleHandlers = { ...handlers };\n    let animationId: number | null = null;\n    let isAnimating = false;\n\n    const sketchContext = createSketchContext(context, threeContext);\n\n    function handleResize() {\n      const width = container.clientWidth || window.innerWidth;\n      const height = container.clientHeight || window.innerHeight;\n\n      if (camera instanceof THREE.PerspectiveCamera) {\n        camera.aspect = width / height;\n        camera.updateProjectionMatrix();\n      } else if (camera instanceof THREE.OrthographicCamera) {\n        const aspect = width / height;\n        camera.left = -aspect;\n        camera.right = aspect;\n        camera.updateProjectionMatrix();\n      }\n\n      renderer.setSize(width, height);\n\n      currentHandlers.resize?.(threeContext, sketchContext);\n    }\n\n    window.addEventListener('resize', handleResize);\n\n    function animate() {\n      if (!isAnimating) return;\n\n      animationId = requestAnimationFrame(animate);\n\n      if (orbitControls && typeof orbitControls.update === 'function') {\n        orbitControls.update();\n      }\n\n      currentHandlers.animate?.(threeContext, sketchContext);\n\n      renderer.render(scene, camera);\n    }\n\n    currentHandlers.setup?.(threeContext, sketchContext);\n\n    if (typeof mountOptions.onReady === 'function') {\n      mountOptions.onReady(threeContext);\n    }\n\n    function startAnimation() {\n      if (!isAnimating) {\n        isAnimating = true;\n        animate();\n      }\n    }\n\n    function stopAnimation() {\n      isAnimating = false;\n      if (animationId !== null) {\n        cancelAnimationFrame(animationId);\n        animationId = null;\n      }\n    }\n\n    startAnimation();\n\n    return {\n      destroy() {\n        stopAnimation();\n        window.removeEventListener('resize', handleResize);\n\n        currentHandlers.dispose?.();\n\n        if (orbitControls && typeof orbitControls.dispose === 'function') {\n          orbitControls.dispose();\n        }\n\n        renderer.dispose();\n        if (renderer.domElement.parentNode === container) {\n          container.removeChild(renderer.domElement);\n        }\n      },\n      setHandlers(nextHandlers: Record<string, any>) {\n        currentHandlers = { ...nextHandlers } as ThreeLifecycleHandlers;\n      },\n      getInstance() {\n        return threeContext;\n      },\n    };\n  },\n};\n",
    "import { HyperFrameRuntime } from './runtime';\nimport { p5Adapter } from './adapters/p5';\nimport { threeAdapter } from './adapters/three';\nimport type {\n  HyperFrameAdapter,\n  HyperFrameStartOptions,\n  MountOptions,\n  MountResult,\n  P5HandlerMap,\n  P5Instance,\n  P5SketchHandlers,\n  RunP5SketchOptions,\n  RunP5SketchResult,\n  StartP5SketchOptions,\n  RunThreeSketchOptions,\n  RunThreeSketchResult,\n  StartThreeSketchOptions,\n  ThreeLifecycleHandlers,\n  MountThreeOptions,\n  ThreeContext,\n} from './types';\n\nconst runtime = new HyperFrameRuntime({ mirrorCss: true });\n\nruntime.registerAdapter(p5Adapter);\nruntime.registerAdapter(threeAdapter);\n\nexport { runtime, p5Adapter, threeAdapter };\n\nexport function registerAdapter(adapter: HyperFrameAdapter<any>) {\n  runtime.registerAdapter(adapter);\n}\n\nexport function start<Options>(options: HyperFrameStartOptions<Options>) {\n  return runtime.start(options);\n}\n\nexport function ensureDependencies(dependencies?: HyperFrameStartOptions['dependencies']) {\n  return runtime.ensureDependencies(dependencies);\n}\n\nexport function mirrorCss() {\n  runtime.mirrorCss();\n}\n\nexport function mountP5Sketch(handlers: P5HandlerMap, options?: MountOptions): Promise<MountResult<P5Instance>> {\n  return runtime.mountP5Sketch(handlers, options);\n}\n\nexport function runP5Sketch(options: RunP5SketchOptions): Promise<RunP5SketchResult> {\n  return runtime.runP5Sketch(options);\n}\n\nexport function startP5Sketch(options: StartP5SketchOptions): Promise<RunP5SketchResult> {\n  return runtime.startP5Sketch(options);\n}\n\nexport function runThreeSketch(options: RunThreeSketchOptions): Promise<RunThreeSketchResult> {\n  return runtime.runThreeSketch(options);\n}\n\nexport function startThreeSketch(options: StartThreeSketchOptions): Promise<RunThreeSketchResult> {\n  return runtime.startThreeSketch(options);\n}\n\nexport function mountThreeSketch(\n  handlers: ThreeLifecycleHandlers,\n  options?: MountThreeOptions,\n): Promise<MountResult<ThreeContext>> {\n  return runtime.mountThreeSketch(handlers, options);\n}\n\nexport function attachToWindow() {\n  if (typeof window === 'undefined') {\n    return;\n  }\n\n  const hyperWindow = window as unknown as {\n    hyperFrame?: any;\n  };\n\n  const api = {\n    version: 'next',\n    runtime,\n    registerAdapter,\n    ensureDependencies,\n    mirrorCss,\n    start,\n    p5: {\n      mount: mountP5Sketch,\n      run: runP5Sketch,\n      start: startP5Sketch,\n    },\n    three: {\n      mount: mountThreeSketch,\n      run: runThreeSketch,\n      start: startThreeSketch,\n    },\n  };\n\n  hyperWindow.hyperFrame = { ...(hyperWindow.hyperFrame || {}), ...api };\n}\n\nattachToWindow();\n\nexport type {\n  P5Instance,\n  P5SketchHandlers,\n  P5HandlerMap,\n  RunP5SketchOptions,\n  RunP5SketchResult,\n  StartP5SketchOptions,\n  ThreeLifecycleHandlers,\n  RunThreeSketchOptions,\n  RunThreeSketchResult,\n  StartThreeSketchOptions,\n  MountResult,\n  MountOptions,\n  MountThreeOptions,\n  ThreeContext,\n};\n"
  ],
  "mappings": "8ZACA,IAAM,EAAuB,IAAI,IAAI,CAAC,QAAS,MAAM,CAAC,EAU/C,MAAM,CAAU,CACb,OACA,OACA,SAAoC,KACpC,QAAuB,IAAI,QAC3B,OAAS,GAEjB,WAAW,CAAC,EAA4B,CAAC,EAAG,CAC1C,KAAK,OAAS,EAAQ,iBAAmB,OAAO,SAAW,YAAc,OAAO,QAAQ,UAAY,KAAO,MAC3G,KAAK,OAAS,EAAQ,iBAAmB,OAAO,WAAa,YAAc,SAAW,MACtF,KAAK,OAAS,QAAQ,EAAQ,QAAU,EAAI,EAG9C,KAAK,EAAG,CACN,IAAK,KAAK,OAAQ,OAClB,IAAK,KAAK,SAAW,KAAK,OAAQ,CAChC,QAAQ,KAAK,yEAAwE,EACrF,OAGF,KAAK,sBAAsB,EAC3B,KAAK,QAAQ,EACb,KAAK,eAAe,EAGtB,IAAI,EAAG,CACL,KAAK,UAAU,WAAW,EAC1B,KAAK,SAAW,KAChB,KAAK,QAAU,IAAI,QACnB,KAAK,sBAAsB,EAGrB,qBAAqB,EAAG,CAC9B,IAAK,KAAK,OAAQ,OAClB,KAAK,OACF,iBAAiB,iCAA6B,EAC9C,QAAQ,CAAC,IAAS,EAAK,YAAY,YAAY,CAAI,CAAC,EAGjD,OAAO,EAAG,CAChB,IAAK,KAAK,SAAW,KAAK,OAAQ,OAClC,IAAM,EAAO,KAAK,OAAO,KACX,MAAM,KAAK,EAAK,QAAQ,EAAE,OAAO,CAAC,IAAS,EAAqB,IAAI,EAAK,QAAQ,CAAC,EAE1F,QAAQ,CAAC,IAAS,CACtB,IAAM,EAAQ,KAAK,UAAU,CAAI,EACjC,IAAK,EAAO,OACZ,KAAK,QAAQ,KAAK,YAAY,CAAK,EACnC,KAAK,QAAQ,IAAI,EAAM,CAAK,EAC7B,EAGK,cAAc,EAAG,CACvB,IAAK,KAAK,SAAW,KAAK,OAAQ,OAClC,GAAI,KAAK,SAAU,OAEnB,KAAK,SAAW,IAAI,iBAAiB,CAAC,IAAc,CAClD,EAAU,QAAQ,CAAC,IAAa,CAC9B,OAAQ,EAAS,UACV,YACH,KAAK,wBAAwB,CAAQ,EACrC,UACG,gBACH,KAAK,4BAA4B,CAAQ,EACzC,UACG,aACH,KAAK,wBAAwB,CAAQ,EACrC,OAEL,EACF,EAED,KAAK,SAAS,QAAQ,KAAK,OAAO,KAAM,CACtC,UAAW,GACX,QAAS,GACT,cAAe,GACf,WAAY,EACd,CAAC,EAGK,uBAAuB,CAAC,EAA0B,CACxD,IAAK,KAAK,OAAQ,OAElB,EAAS,aAAa,QAAQ,CAAC,IAAS,CACtC,IAAM,EAAS,KAAK,QAAQ,IAAI,CAAI,EACpC,GAAI,GAAU,EAAO,WACnB,EAAO,WAAW,YAAY,CAAM,EACpC,KAAK,QAAQ,OAAO,CAAI,EAE3B,EAED,EAAS,WAAW,QAAQ,CAAC,IAAS,CACpC,KAAM,aAAgB,aAAc,OACpC,IAAK,EAAqB,IAAI,EAAK,QAAQ,EAAG,OAE9C,IAAM,EAAQ,KAAK,UAAU,CAAI,EACjC,IAAK,EAAO,OAEZ,IAAM,EAAY,EAAS,YAAc,KAAK,QAAQ,IAAI,EAAS,WAAW,EAAI,KAClF,GAAI,GAAa,EAAU,WACzB,EAAU,WAAW,aAAa,EAAO,CAAS,EAElD,UAAK,QAAQ,KAAK,YAAY,CAAK,EAGrC,KAAK,QAAQ,IAAI,EAAM,CAAK,EAC7B,EAGK,2BAA2B,CAAC,EAA0B,CAE5D,IAAM,EADa,EAAS,OACF,WAC1B,IAAK,EAAQ,OACb,IAAM,EAAe,KAAK,QAAQ,IAAI,CAAM,EAC5C,IAAK,EAAc,OAEnB,EAAa,YAAc,EAAO,YAG5B,uBAAuB,CAAC,EAA0B,CACxD,IAAM,EAAS,EAAS,OAClB,EAAS,KAAK,QAAQ,IAAI,CAAM,EACtC,IAAK,KAAY,aAAkB,SAAU,OAE7C,GAAI,EAAS,cAAe,CAC1B,IAAM,EAAQ,EAAO,aAAa,EAAS,aAAa,EACxD,GAAI,IAAU,KACZ,EAAO,gBAAgB,EAAS,aAAa,EAE7C,OAAO,aAAa,EAAS,cAAe,CAAK,GAK/C,SAAS,CAAC,EAAgC,CAChD,KAAM,aAAgB,aAAc,OAAO,KAC3C,IAAK,EAAqB,IAAI,EAAK,QAAQ,EAAG,OAAO,KAErD,IAAM,EAAQ,EAAK,UAAU,EAAI,EAEjC,OADA,EAAM,aAtJc,yBAsJgB,MAAM,EACnC,EAEX,CC/IO,MAAM,CAAkB,CACrB,QAAsC,IAAI,IAElD,MAAM,CAAC,EAA+C,CACpD,IAAM,EAAM,KAAK,UAAU,CAAU,EACrC,GAAI,KAAK,QAAQ,IAAI,CAAG,EACtB,OAAO,KAAK,QAAQ,IAAI,CAAG,EAG7B,IAAM,EAAO,KAAK,KAAK,CAAU,EAEjC,OADA,KAAK,QAAQ,IAAI,EAAK,CAAI,EACnB,OAGH,UAAS,CAAC,EAAqC,CAAC,EAAkB,CACtE,QAAW,KAAc,EACvB,MAAM,KAAK,OAAO,CAAU,EAIxB,SAAS,CAAC,EAAwC,CACxD,MAAO,GAAG,EAAW,QAAQ,EAAW,MAGlC,IAAI,CAAC,EAA+C,CAC1D,OAAQ,EAAW,UACZ,SACH,OAAO,KAAK,aAAa,CAAU,MAChC,QACH,OAAO,KAAK,YAAY,CAAU,UAElC,OAAO,QAAQ,OAAO,IAAI,MAAM,8CAA8C,EAAW,MAAM,CAAC,GAI9F,YAAY,CAAC,EAA+C,CAClE,GAAI,OAAO,WAAa,YACtB,OAAO,QAAQ,OAAO,IAAI,MAAM,yCAAyC,CAAC,EAM5E,GAHiB,MAAM,KAAK,SAAS,iBAAoC,QAAQ,CAAC,EAAE,KAClF,CAAC,IAAW,EAAO,MAAQ,EAAW,GACxC,EAEE,OAAO,QAAQ,QAAQ,EAGzB,OAAO,IAAI,QAAQ,CAAC,EAAS,IAAW,CACtC,IAAM,EAAS,SAAS,cAAc,QAAQ,EAK9C,GAJA,EAAO,IAAM,EAAW,IACxB,EAAO,MAAQ,GACf,EAAO,QAAQ,WAAa,WAExB,EAAW,UACb,EAAO,UAAY,EAAW,UAEhC,GAAI,EAAW,YACb,EAAO,YAAc,EAAW,YAElC,GAAI,EAAW,WACb,OAAO,QAAQ,EAAW,UAAU,EAAE,QAAQ,EAAE,EAAK,KAAW,CAC9D,EAAO,aAAa,EAAK,CAAK,EAC/B,EAGH,EAAO,iBAAiB,OAAQ,IAAM,EAAQ,EAAG,CAAE,KAAM,EAAK,CAAC,EAC/D,EAAO,iBAAiB,QAAS,IAAM,EAAO,IAAI,MAAM,uCAAuC,EAAW,KAAK,CAAC,EAAG,CACjH,KAAM,EACR,CAAC,EAED,SAAS,KAAK,YAAY,CAAM,EACjC,EAGK,WAAW,CAAC,EAA+C,CACjE,GAAI,OAAO,WAAa,YACtB,OAAO,QAAQ,OAAO,IAAI,MAAM,yCAAyC,CAAC,EAM5E,GAHiB,MAAM,KAAK,SAAS,iBAAkC,wBAAwB,CAAC,EAAE,KAChG,CAAC,IAAS,EAAK,OAAS,EAAW,GACrC,EAEE,OAAO,QAAQ,QAAQ,EAGzB,OAAO,IAAI,QAAQ,CAAC,EAAS,IAAW,CACtC,IAAM,EAAO,SAAS,cAAc,MAAM,EAK1C,GAJA,EAAK,IAAM,aACX,EAAK,KAAO,EAAW,IACvB,EAAK,QAAQ,WAAa,WAEtB,EAAW,WACb,OAAO,QAAQ,EAAW,UAAU,EAAE,QAAQ,EAAE,EAAK,KAAW,CAC9D,EAAK,aAAa,EAAK,CAAK,EAC7B,EAGH,EAAK,iBAAiB,OAAQ,IAAM,EAAQ,EAAG,CAAE,KAAM,EAAK,CAAC,EAC7D,EAAK,iBAAiB,QAAS,IAAM,EAAO,IAAI,MAAM,2CAA2C,EAAW,KAAK,CAAC,EAAG,CACnH,KAAM,EACR,CAAC,EAED,SAAS,KAAK,YAAY,CAAI,EAC/B,EAEL,CCzGO,SAAS,CAAgB,CAAC,EAAmC,CAAC,EAAsB,CACzF,IAAM,EAAM,EAAQ,aAAe,SACnC,IAAK,EACH,MAAM,IAAI,MAAM,yCAAyC,EAG3D,IAAM,EAAY,EAAQ,oBAAsB,mBAC1C,EAAS,EAAQ,OAEvB,GAAI,aAAkB,YAEpB,OADA,EAAO,UAAU,IAAI,CAAS,EACvB,CAAE,QAAS,EAAQ,kBAAmB,EAAM,EAGrD,GAAI,OAAO,IAAW,UAAY,EAAO,KAAK,EAAE,OAAS,EAAG,CAC1D,IAAM,EAAO,EAAI,cAA2B,CAAM,EAClD,GAAI,EAEF,OADA,EAAK,UAAU,IAAI,CAAS,EACrB,CAAE,QAAS,EAAM,kBAAmB,EAAM,EAEnD,QAAQ,KAAK,wDAAwD,2BAAgC,EAGvG,IAAM,EAAY,EAAI,cAAc,KAAK,EAGzC,OAFA,EAAU,UAAU,IAAI,CAAS,EACjC,EAAI,KAAK,YAAY,CAAS,EACvB,CAAE,QAAS,EAAW,kBAAmB,EAAK,ECPhD,MAAM,CAAe,CAClB,YAER,WAAW,EAAG,CACZ,KAAK,YAAc,KAAK,mBAAmB,EAGrC,kBAAkB,EAAyB,CACjD,GAAI,OAAO,SAAW,YACpB,MAAM,IAAI,MAAM,uCAAuC,EAEzD,IAAM,EAAc,OACpB,IAAK,EAAY,kBACf,MAAM,IAAI,MAAM,8DAA8D,EAEhF,OAAO,EAAY,kBAGrB,IAAI,CAAC,EAAoC,CACvC,IAAM,EAAe,EAAQ,SAAW,CAAC,EAyBzC,OAxBiB,KAAK,YAAY,mBAAmB,EAAQ,YAAa,CACxE,MAAO,EAAa,MACpB,SAAU,EAAa,SACvB,SAAU,EAAa,SACvB,UAAW,EAAa,UACxB,SAAU,CAAC,EAA6B,IAAuB,CAC7D,GAAI,OAAO,EAAa,WAAa,WAAY,CAC/C,IAAM,EAA+B,CACnC,IAAK,EAAc,IACnB,MAAO,EAAc,MACrB,MAAO,EAAc,KACvB,EACA,EAAQ,kBAAkB,CAAM,EAChC,EAAa,SAAS,EAAQ,EAAQ,OAAO,EAE7C,OAAQ,kBAAkB,CACxB,IAAK,EAAc,IACnB,MAAO,EAAc,MACrB,MAAO,EAAc,KACvB,CAAC,EAGP,CAAC,EAIL,CChDA,SAAS,CAAa,CAAC,EAA4C,CACjE,IAAM,EAA2B,CAAC,EAUlC,OARA,OAAO,QAAQ,CAAU,EAAE,QAAQ,EAAE,EAAK,KAAa,CACrD,GAAI,OAAO,IAAY,WACrB,EAAO,GAAO,CAAC,EAAU,KAAa,IAAS,CAC5C,EAAsB,EAAU,GAAG,CAAI,GAG7C,EAEM,EAOF,MAAM,CAAkD,CACrD,SAAW,IAAI,IACf,kBAAoB,IAAI,EACxB,UAA8B,KAC9B,OAER,WAAW,CAAC,EAAkC,CAAC,EAAG,CAChD,KAAK,OAAS,EAGhB,eAAe,CAAC,EAAiC,CAC/C,KAAK,SAAS,IAAI,EAAQ,GAAI,CAAO,OAGjC,mBAAkB,CAAC,EAAsE,CAC7F,IAAK,GAAgB,EAAa,SAAW,EAC3C,OAGF,MAAM,KAAK,kBAAkB,UAC3B,CACF,EAGF,SAAS,EAAS,CAChB,GAAI,KAAK,UACP,OAEF,KAAK,UAAY,IAAI,EAAU,CAAE,OAAQ,KAAK,OAAO,YAAc,EAAM,CAAC,EAC1E,KAAK,UAAU,MAAM,OAGjB,MAAoB,CAAC,EAA4E,CACrG,IAAM,EAAU,KAAK,eAAe,EAAQ,OAAO,EAEnD,GAAI,EAAQ,cAAc,OACxB,MAAM,KAAK,mBAAmB,EAAQ,YAAY,EAGpD,GAAI,KAAK,OAAO,YAAc,IAAS,EAAQ,YAAc,GAC3D,KAAK,UAAU,EAGjB,GAAI,OAAO,EAAQ,SAAW,WAC5B,MAAM,EAAQ,OAAO,EAAQ,QAAS,IAAI,EAG5C,IAAM,EAAQ,KAAK,YAAY,EAAQ,KAAK,EACtC,EAAiB,IAAI,EAErB,EAAiC,CACrC,OAAQ,CAAC,EACT,SAAU,KACV,YAAa,IAAM,KACnB,cAAe,IAAM,IACvB,EAEM,EAAW,EAAQ,mBACrB,EAAe,KAAK,CAClB,YAAa,EAAQ,mBACrB,QAAS,EAAQ,SACjB,QAAS,EACT,gBAAiB,CAAC,IAAiC,EAGrD,CAAC,EACD,KAEE,EAA2C,CAC/C,MAAO,CACL,UAAW,EAAM,UACjB,QAAS,IAAM,EAAM,QAAQ,CAC/B,EACA,WACA,OAAQ,GAAU,QAAU,CAAC,EAC7B,QAAS,KACT,aAAc,EAAQ,KACxB,EAEM,EAAS,MAAM,EAAQ,MAAM,EAAQ,QAAS,CAAc,EAElE,GAAI,EAAe,CACjB,EAAc,OAAS,EAAe,OACtC,EAAc,SAAW,EACzB,IAAM,EAAc,IAAO,EAAO,YAAc,EAAO,YAAY,EAAI,KACvE,EAAc,YAAc,EAC5B,EAAc,cAAgB,EAsBhC,MAnB+C,CAC7C,QAAS,IAAM,CAGb,GAFA,EAAO,QAAQ,EACf,EAAM,QAAQ,EACV,GACF,GAAI,OAAO,EAAS,UAAY,WAC9B,EAAS,QAAQ,EACZ,QAAI,OAAO,EAAS,UAAY,WACrC,EAAS,QAAQ,IAIvB,YAAa,EAAO,YAAc,CAAC,IAAkC,EAAO,YAAa,CAAQ,EAAI,OACrG,YAAa,EAAO,YAAc,IAAM,EAAO,YAAa,EAAI,OAChE,OAAQ,EAAe,OACvB,WACA,UAAW,EAAM,SACnB,EAKM,cAAuB,CAAC,EAA0E,CACxG,GAAI,OAAO,IAAY,SACrB,OAAO,EAET,IAAM,EAAW,KAAK,SAAS,IAAI,CAAO,EAC1C,IAAK,EACH,MAAM,IAAI,MAAM,0BAA0B,sBAA4B,EAExE,OAAO,EAGD,WAAW,CAAC,EAA2F,CAC7G,IAAM,EAAwC,EAC1C,CACE,OAAS,EAAyB,OAClC,mBAAqB,EAAyB,mBAC9C,QAAU,EAAyB,OACrC,EACA,OAEE,EAAQ,EAAiB,CAAW,EAC1C,GAAI,GAAa,QACf,EAAY,QAAQ,CAAE,UAAW,EAAM,OAAQ,CAAC,EAElD,MAAO,CACL,UAAW,EAAM,QACjB,QAAS,IAAM,CACb,GAAI,EAAM,kBACR,EAAM,QAAQ,OAAO,EAG3B,OAKI,YAAW,CAAC,EAAyD,CACzE,IAAM,EAAS,MAAM,KAAK,MAAM,CAC9B,QAAS,KACT,QAAS,EAAQ,SACjB,mBAAoB,EAAQ,mBAC5B,SAAU,EAAQ,SAClB,MAAO,EAAQ,MACf,aAAc,EAAQ,aACtB,UAAW,EAAQ,SACrB,CAAC,EAEK,EAAS,EAAO,QAAU,CAAC,EAC3B,EAAW,EAAO,SAExB,MAAO,CACL,SACA,WACA,QAAS,CACP,SACA,WACA,cAAe,IAAO,EAAO,YAAc,EAAO,YAAY,EAAI,KAClE,YAAa,IAAO,EAAO,YAAc,EAAO,YAAY,EAAI,IAClE,EACA,QAAS,IAAM,EAAO,QAAQ,EAC9B,YAAa,CAAC,IAA+B,EAAO,cAAc,CAA+B,EACjG,YAAa,IAAO,EAAO,YAAe,EAAO,YAAY,EAAY,IAC3E,OAGI,cAAa,CAAC,EAA+B,CACjD,IAAM,EAAe,CAAC,GAAI,EAAQ,cAAgB,CAAC,CAAE,EACrD,GAAI,EAAQ,IAAI,IACd,EAAa,QAAQ,CAAE,KAAM,SAAU,IAAK,EAAQ,GAAG,GAAI,CAAC,EAE9D,OAAO,KAAK,YAAY,IACnB,EACH,cACF,CAAC,OAGG,cAAa,CAAC,EAAwB,EAAwD,CAClG,IAAM,EAAS,MAAM,KAAK,MAAM,CAC9B,QAAS,KACT,QAAS,EAAc,CAAQ,EAC/B,OACF,CAAC,EAED,MAAO,CACL,UAAW,EAAO,UAClB,YAAa,IAAO,EAAO,YAAe,EAAO,YAAY,EAA0B,KACvF,YAAa,CAAC,IAAsC,CAClD,EAAO,cAAc,EAAc,CAA4B,CAAC,GAElE,QAAS,IAAM,EAAO,QAAQ,CAChC,OAGI,eAAc,CAAC,EAA+D,CAClF,IAAM,EAAS,MAAM,KAAK,MAAM,CAC9B,QAAS,QACT,QAAS,EAAQ,SACjB,mBAAoB,EAAQ,mBAC5B,SAAU,EAAQ,SAClB,MAAO,EAAQ,MACf,aAAc,EAAQ,aACtB,UAAW,EAAQ,SACrB,CAAC,EAEK,EAA8B,CAClC,OAAQ,EAAO,QAAU,CAAC,EAC1B,SAAU,EAAO,SACjB,gBAAiB,IAAO,EAAO,YAAc,EAAO,YAAY,EAAI,IACtE,EAEA,MAAO,CACL,OAAQ,EAAO,QAAU,CAAC,EAC1B,SAAU,EAAO,SACjB,UACA,QAAS,IAAM,EAAO,QAAQ,EAC9B,YAAa,CAAC,IAAqC,EAAO,cAAc,CAA+B,EACvG,WAAY,IAAO,EAAO,YAAe,EAAO,YAAY,EAAY,IAC1E,OAGI,iBAAgB,CAAC,EAAkC,CACvD,IAAM,EAAe,CAAC,GAAI,EAAQ,cAAgB,CAAC,CAAE,EACrD,GAAI,EAAQ,OAAO,IACjB,EAAa,QAAQ,CAAE,KAAM,SAAU,IAAK,EAAQ,MAAM,GAAI,CAAC,EAEjE,OAAO,KAAK,eAAe,IACtB,EACH,cACF,CAAC,OAGG,iBAAgB,CAAC,EAAkC,EAA+D,CACtH,IAAM,EAAS,MAAM,KAAK,MAAM,CAC9B,QAAS,QACT,QAAS,EACT,OACF,CAAC,EAED,MAAO,CACL,UAAW,EAAO,UAClB,YAAa,IAAO,EAAO,YAAe,EAAO,YAAY,EAA4B,KACzF,YAAa,CAAC,IAAsC,CAClD,EAAO,cAAc,CAAsC,GAE7D,QAAS,IAAM,EAAO,QAAQ,CAChC,EAEJ,CChTO,SAAS,CAAS,CAAC,EAAsB,CAC9C,GAAI,OAAO,wBAA0B,WACnC,sBAAsB,CAAQ,EAE9B,gBAAW,EAAU,EAAE,EAIpB,SAAS,CAAgB,CAAC,EAA0B,EAAqB,EAA8B,CAC5G,OAAO,IAAI,QAAQ,CAAC,EAAS,IAAW,CACtC,IAAI,EAAW,EAEf,SAAS,CAAI,EAAG,CACd,GAAY,EAEZ,GAAI,CACF,GAAI,EAAU,EAAG,CACf,EAAQ,EACR,QAEF,MAAO,EAAO,EAIhB,GAAI,GAAY,EAAa,CAC3B,EAAO,IAAI,MAAM,uCAAuC,GAAO,CAAC,EAChE,OAGF,EAAU,CAAI,EAGhB,EAAK,EACN,ECvBH,IAAM,EAAqB,sDAU3B,SAAS,CAAgB,EAAkB,CACzC,GAAI,OAAO,SAAW,YACpB,MAAM,IAAI,MAAM,uCAAuC,EAGzD,IAAM,EAAQ,OAAe,GAE7B,GAAI,OAAO,IAAS,WAClB,MAAM,IAAI,MAAM,2FAA2F,EAG7G,OAAO,EAGT,SAAS,CAAa,CAAC,EAAsB,EAAoD,CAC/F,QAAW,KAAO,EAChB,GAAI,OAAO,UAAU,eAAe,KAAK,EAAU,CAAG,EAAG,CACvD,IAAM,EAAU,EAAS,GACzB,GAAI,OAAO,IAAY,WACpB,EAAqC,GAAO,GAMrD,SAAS,EAAY,CACnB,EACA,EAC0C,CAC1C,IAAM,EAAoD,CAAC,EAU3D,OARA,OAAO,QAAQ,CAAQ,EAAE,QAAQ,EAAE,EAAK,KAAa,CACnD,GAAI,OAAO,IAAY,WACrB,EAAQ,GAAO,CAAC,KAAyB,IAAgB,CACvD,OAAO,EAAQ,EAAU,EAAe,GAAG,CAAI,GAGpD,EAEM,EAGT,eAAe,EAAiB,EAAkB,CAChD,GAAI,OAAO,SAAW,YACpB,MAAM,IAAI,MAAM,uCAAuC,EAGzD,GAAI,OAAQ,OAAe,KAAO,WAChC,OAGF,GAAI,OAAO,WAAa,YACtB,MAAM,IAAI,MAAM,yCAAyC,EAG3D,IAAM,EAAY,EAElB,GADiB,MAAM,KAAK,SAAS,iBAAiB,eAAe,KAAa,CAAC,EACtE,SAAW,EAAG,CACzB,IAAM,EAAS,SAAS,cAAc,QAAQ,EAC9C,EAAO,IAAM,EACb,EAAO,MAAQ,GACf,EAAO,QAAQ,WAAa,KAC5B,SAAS,KAAK,YAAY,CAAM,EAGlC,MAAM,EAAiB,IAAM,OAAQ,OAAe,KAAO,WAAY,IAAK,gBAAgB,EAGvF,IAAM,EAAiD,CAC5D,GAAI,UACE,OAAM,CAAC,EAAW,EAAS,CAC/B,GAAI,CACF,MAAM,GAAkB,EACxB,MAAO,EAAO,CACd,MAAM,EAAQ,mBAAmB,CAAC,CAAE,KAAM,SAAU,IAAK,CAAmB,CAAC,CAAC,EAC9E,MAAM,EAAiB,IAAM,OAAQ,OAAe,KAAO,WAAY,IAAK,gBAAgB,SAG1F,MAAK,CAAC,EAA4B,EAAqE,CAC3G,GAAI,OAAO,WAAa,YACtB,MAAM,IAAI,MAAM,wDAAwD,EAG1E,IAAI,EAAoC,KACpC,EAAoC,IAAK,CAAS,EAEhD,EAAiC,CACrC,OAAQ,EAAQ,OAChB,SAAU,EAAQ,SAClB,YAAa,IAAM,EACnB,cAAe,IAAM,CACvB,EAEM,EAAkB,IAAM,GAAa,EAAiB,CAAa,EAEzE,SAAS,CAAM,CAAC,EAAwB,CACtC,EAAiB,EACjB,EAAc,EAAY,EAAgB,CAAC,EAI7C,IAAM,EAAe,IADN,EAAiB,GACA,EAAQ,EAAQ,MAAM,SAAS,EAC/D,IAAK,EACH,EAAkB,EAGpB,MAAO,CACL,OAAO,EAAG,CACR,GAAI,EACF,EAAe,OAAO,EACtB,EAAiB,MAGrB,WAAW,CAAC,EAAmC,CAE7C,GADA,EAAkB,IAAK,CAAa,EAChC,EACF,EAAc,EAAgB,EAAgB,CAAC,GAGnD,WAAW,EAAG,CACZ,OAAO,EAEX,EAEJ,ECvIA,SAAS,EAAoB,EAAQ,CACnC,GAAI,OAAO,SAAW,YACpB,MAAM,IAAI,MAAM,uCAAuC,EAGzD,IAAM,EAAS,OAAe,MAE9B,GAAI,OAAO,IAAU,SACnB,MAAM,IAAI,MAAM,4GAA4G,EAG9H,OAAO,EAGT,SAAS,EAAmB,CAAC,EAAmC,EAAgD,CAC9G,MAAO,CACL,OAAQ,EAAQ,OAChB,SAAU,EAAQ,SAClB,gBAAiB,IAAM,CACzB,EAGK,IAAM,EAA0D,CACrE,GAAI,aACE,MAAK,CAAC,EAAkC,EAAqE,CACjH,GAAI,OAAO,WAAa,YACtB,MAAM,IAAI,MAAM,2DAA2D,EAG7E,IAAM,EAAQ,GAAqB,EAC7B,EAAgB,EAAQ,cAAgB,CAAC,EACzC,EAAa,EAAa,QAAU,CAAC,EACrC,EAAe,EAAa,UAAY,CAAC,EACzC,EAAY,EAAQ,MAAM,UAE1B,EAAQ,IAAI,EAAM,MAElB,EAAa,EAAW,MAAQ,cAClC,EAEJ,GAAI,IAAe,cACjB,EAAS,IAAI,EAAM,kBACjB,EAAW,KAAO,GAClB,EAAU,aAAe,EAAU,cAAgB,GACnD,EAAW,MAAQ,IACnB,EAAW,KAAO,IACpB,EACK,KACL,IAAM,GAAU,EAAU,aAAe,OAAO,aAAe,EAAU,cAAgB,OAAO,aAAe,GAC/G,EAAS,IAAI,EAAM,oBAChB,EACD,EACA,EACA,GACA,EAAW,MAAQ,IACnB,EAAW,KAAO,IACpB,EAGF,GAAI,EAAW,SACb,EAAO,SAAS,IAAI,GAAG,EAAW,QAAQ,EAE1C,OAAO,SAAS,EAAI,EAGtB,IAAM,EAAW,IAAI,EAAM,cAAc,CACvC,UAAW,EAAa,YAAc,GACtC,MAAO,QAAQ,EAAa,KAAK,EACjC,sBAAuB,QAAQ,EAAa,qBAAqB,CACnE,CAAC,EAEK,EAAQ,EAAU,aAAe,OAAO,WACxC,EAAS,EAAU,cAAgB,OAAO,YAChD,EAAS,QAAQ,EAAO,CAAM,EAC9B,EAAS,cAAc,OAAO,gBAAgB,EAC9C,EAAU,YAAY,EAAS,UAAU,EAEzC,IAAI,EAAqB,KACzB,GAAI,EAAa,cAAe,CAC9B,IAAM,EAAiB,OAAe,eAAiB,EAAM,cAC7D,GAAI,EACF,EAAgB,IAAI,EAAc,EAAQ,EAAS,UAAU,EAE7D,aAAQ,KAAK,qFAAqF,EAItG,IAAM,EAA6B,CACjC,QACA,SACA,WACA,SAAU,GAAiB,MAC7B,EAEI,EAA0C,IAAK,CAAS,EACxD,EAA6B,KAC7B,EAAc,GAEZ,EAAgB,GAAoB,EAAS,CAAY,EAE/D,SAAS,CAAY,EAAG,CACtB,IAAM,EAAQ,EAAU,aAAe,OAAO,WACxC,EAAS,EAAU,cAAgB,OAAO,YAEhD,GAAI,aAAkB,EAAM,kBAC1B,EAAO,OAAS,EAAQ,EACxB,EAAO,uBAAuB,EACzB,QAAI,aAAkB,EAAM,mBAAoB,CACrD,IAAM,EAAS,EAAQ,EACvB,EAAO,MAAQ,EACf,EAAO,MAAQ,EACf,EAAO,uBAAuB,EAGhC,EAAS,QAAQ,EAAO,CAAM,EAE9B,EAAgB,SAAS,EAAc,CAAa,EAGtD,OAAO,iBAAiB,SAAU,CAAY,EAE9C,SAAS,CAAO,EAAG,CACjB,IAAK,EAAa,OAIlB,GAFA,EAAc,sBAAsB,CAAO,EAEvC,GAAiB,OAAO,EAAc,SAAW,WACnD,EAAc,OAAO,EAGvB,EAAgB,UAAU,EAAc,CAAa,EAErD,EAAS,OAAO,EAAO,CAAM,EAK/B,GAFA,EAAgB,QAAQ,EAAc,CAAa,EAE/C,OAAO,EAAa,UAAY,WAClC,EAAa,QAAQ,CAAY,EAGnC,SAAS,CAAc,EAAG,CACxB,IAAK,EACH,EAAc,GACd,EAAQ,EAIZ,SAAS,CAAa,EAAG,CAEvB,GADA,EAAc,GACV,IAAgB,KAClB,qBAAqB,CAAW,EAChC,EAAc,KAMlB,OAFA,EAAe,EAER,CACL,OAAO,EAAG,CAMR,GALA,EAAc,EACd,OAAO,oBAAoB,SAAU,CAAY,EAEjD,EAAgB,UAAU,EAEtB,GAAiB,OAAO,EAAc,UAAY,WACpD,EAAc,QAAQ,EAIxB,GADA,EAAS,QAAQ,EACb,EAAS,WAAW,aAAe,EACrC,EAAU,YAAY,EAAS,UAAU,GAG7C,WAAW,CAAC,EAAmC,CAC7C,EAAkB,IAAK,CAAa,GAEtC,WAAW,EAAG,CACZ,OAAO,EAEX,EAEJ,ECzKA,IAAM,EAAU,IAAI,EAAkB,CAAE,UAAW,EAAK,CAAC,EAEzD,EAAQ,gBAAgB,CAAS,EACjC,EAAQ,gBAAgB,CAAY,EAI7B,SAAS,CAAe,CAAC,EAAiC,CAC/D,EAAQ,gBAAgB,CAAO,EAG1B,SAAS,CAAc,CAAC,EAA0C,CACvE,OAAO,EAAQ,MAAM,CAAO,EAGvB,SAAS,CAAkB,CAAC,EAAuD,CACxF,OAAO,EAAQ,mBAAmB,CAAY,EAGzC,SAAS,CAAS,EAAG,CAC1B,EAAQ,UAAU,EAGb,SAAS,CAAa,CAAC,EAAwB,EAA0D,CAC9G,OAAO,EAAQ,cAAc,EAAU,CAAO,EAGzC,SAAS,CAAW,CAAC,EAAyD,CACnF,OAAO,EAAQ,YAAY,CAAO,EAG7B,SAAS,CAAa,CAAC,EAA2D,CACvF,OAAO,EAAQ,cAAc,CAAO,EAG/B,SAAS,CAAc,CAAC,EAA+D,CAC5F,OAAO,EAAQ,eAAe,CAAO,EAGhC,SAAS,CAAgB,CAAC,EAAiE,CAChG,OAAO,EAAQ,iBAAiB,CAAO,EAGlC,SAAS,CAAgB,CAC9B,EACA,EACoC,CACpC,OAAO,EAAQ,iBAAiB,EAAU,CAAO,EAG5C,SAAS,CAAc,EAAG,CAC/B,GAAI,OAAO,SAAW,YACpB,OAGF,IAAM,EAAc,OAId,EAAM,CACV,QAAS,OACT,UACA,kBACA,qBACA,YACA,QACA,GAAI,CACF,MAAO,EACP,IAAK,EACL,MAAO,CACT,EACA,MAAO,CACL,MAAO,EACP,IAAK,EACL,MAAO,CACT,CACF,EAEA,EAAY,WAAa,IAAM,EAAY,YAAc,CAAC,KAAO,CAAI,EAGvE,EAAe",
  "debugId": "FBAF976A877B3C6864756E2164756E21",
  "names": []
}