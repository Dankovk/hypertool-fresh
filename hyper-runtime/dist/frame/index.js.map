{
  "version": 3,
  "sources": ["../src/frame/dom.ts", "../src/frame/styleSync.ts", "../src/frame/runtime.ts", "../src/frame/adapters/p5.ts", "../src/frame/adapters/three.ts", "../src/frame/index.ts"],
  "sourcesContent": [
    "export interface ResolvedContainer {\n  element: HTMLElement;\n  createdInternally: boolean;\n}\n\nexport interface ResolveContainerOptions {\n  target?: HTMLElement | string | null;\n  className?: string;\n}\n\nexport function resolveContainer(options: ResolveContainerOptions = {}): ResolvedContainer {\n  if (typeof document === 'undefined') {\n    throw new Error('[hyper-frame] document is not available');\n  }\n\n  const className = options.className && options.className.trim().length > 0\n    ? options.className\n    : 'hyperframe-root';\n\n  const target = options.target;\n\n  if (target instanceof HTMLElement) {\n    target.classList.add(className);\n    return { element: target, createdInternally: false };\n  }\n\n  if (typeof target === 'string' && target.trim().length > 0) {\n    const element = document.querySelector<HTMLElement>(target);\n    if (element) {\n      element.classList.add(className);\n      return { element, createdInternally: false };\n    }\n    console.warn(`[hyper-frame] Could not find container for selector \"${target}\", creating one instead.`);\n  }\n\n  const container = document.createElement('div');\n  container.classList.add(className);\n  document.body.appendChild(container);\n  return { element: container, createdInternally: true };\n}\n",
    "interface StyleMirrorOptions {\n  sourceDocument?: Document | null;\n}\n\ninterface MirrorMapping {\n  clone: Element;\n  sourceId: string;\n}\n\nexport class ParentStyleMirror {\n  private observer: MutationObserver | null = null;\n  private readonly mappings = new Map<Element, MirrorMapping>();\n  private readonly reverseMappings = new Map<string, Element>();\n  private readonly anchor: Comment;\n  private running = false;\n  private sourceDocument: Document | null = null;\n  private sourceIdCounter = 0;\n\n  constructor(private readonly targetDocument: Document) {\n    this.anchor = targetDocument.createComment('hyperframe-style-anchor');\n    targetDocument.head.appendChild(this.anchor);\n  }\n\n  start(options: StyleMirrorOptions = {}): void {\n    if (this.running) {\n      return;\n    }\n\n    const source = options.sourceDocument ?? this.tryResolveParentDocument();\n    if (!source) {\n      console.warn('[hyper-frame] Unable to access parent document styles.');\n      return;\n    }\n\n    this.sourceDocument = source;\n    this.running = true;\n    this.copyInitialNodes(source);\n    this.observeSource(source);\n  }\n\n  stop(): void {\n    this.running = false;\n    if (this.observer) {\n      this.observer.disconnect();\n      this.observer = null;\n    }\n    this.mappings.clear();\n    this.reverseMappings.clear();\n    this.sourceDocument = null;\n  }\n\n  private tryResolveParentDocument(): Document | null {\n    if (typeof window === 'undefined') {\n      return null;\n    }\n\n    try {\n      if (!window.parent || window.parent === window) {\n        return null;\n      }\n      return window.parent.document;\n    } catch (error) {\n      console.warn('[hyper-frame] Accessing parent document styles is not permitted:', error);\n      return null;\n    }\n  }\n\n  private copyInitialNodes(source: Document): void {\n    const nodes = source.querySelectorAll('link[rel=\"stylesheet\"], style');\n    nodes.forEach((node) => {\n      if (node instanceof HTMLLinkElement || node instanceof HTMLStyleElement) {\n        this.ensureMirror(node);\n      }\n    });\n  }\n\n  private observeSource(source: Document): void {\n    if (typeof MutationObserver === 'undefined') {\n      return;\n    }\n\n    this.observer = new MutationObserver((mutations) => {\n      mutations.forEach((mutation) => {\n        if (mutation.type === 'childList') {\n          mutation.addedNodes.forEach((node) => {\n            if (node instanceof HTMLLinkElement || node instanceof HTMLStyleElement) {\n              this.ensureMirror(node);\n            }\n          });\n          mutation.removedNodes.forEach((node) => {\n            if (node instanceof HTMLLinkElement || node instanceof HTMLStyleElement) {\n              this.removeMirror(node);\n            }\n          });\n        }\n\n        if (mutation.type === 'attributes') {\n          const target = mutation.target;\n          if (target instanceof HTMLLinkElement || target instanceof HTMLStyleElement) {\n            this.updateMirror(target);\n          }\n        }\n\n        if (mutation.type === 'characterData') {\n          const parent = mutation.target.parentElement;\n          if (parent instanceof HTMLStyleElement) {\n            this.updateMirror(parent);\n          }\n        }\n      });\n    });\n\n    this.observer.observe(source.documentElement, {\n      attributes: true,\n      attributeFilter: ['href', 'media', 'disabled', 'integrity', 'crossorigin', 'referrerpolicy'],\n      characterData: true,\n      childList: true,\n      subtree: true,\n    });\n  }\n\n  private ensureMirror(sourceNode: HTMLLinkElement | HTMLStyleElement): void {\n    const mapping = this.mappings.get(sourceNode);\n    if (mapping) {\n      this.updateMirror(sourceNode);\n      return;\n    }\n\n    const clone = this.targetDocument.createElement(sourceNode.tagName.toLowerCase());\n    clone.setAttribute('data-hyperframe-clone', 'true');\n    const sourceId = this.createSourceId();\n    clone.setAttribute('data-hyperframe-source', sourceId);\n\n    this.applyAttributes(sourceNode, clone);\n\n    if (clone instanceof HTMLStyleElement && sourceNode instanceof HTMLStyleElement) {\n      clone.textContent = sourceNode.textContent;\n    }\n\n    this.targetDocument.head.insertBefore(clone, this.anchor);\n    this.mappings.set(sourceNode, { clone, sourceId });\n    this.reverseMappings.set(sourceId, clone);\n  }\n\n  private removeMirror(sourceNode: HTMLLinkElement | HTMLStyleElement): void {\n    const mapping = this.mappings.get(sourceNode);\n    if (!mapping) {\n      return;\n    }\n\n    mapping.clone.remove();\n    this.mappings.delete(sourceNode);\n    this.reverseMappings.delete(mapping.sourceId);\n  }\n\n  private updateMirror(sourceNode: HTMLLinkElement | HTMLStyleElement): void {\n    const mapping = this.mappings.get(sourceNode);\n    if (!mapping) {\n      this.ensureMirror(sourceNode);\n      return;\n    }\n\n    const { clone } = mapping;\n    this.applyAttributes(sourceNode, clone);\n\n    if (clone instanceof HTMLStyleElement && sourceNode instanceof HTMLStyleElement) {\n      if (clone.textContent !== sourceNode.textContent) {\n        clone.textContent = sourceNode.textContent;\n      }\n    }\n  }\n\n  private applyAttributes(source: HTMLLinkElement | HTMLStyleElement, target: Element): void {\n    const cloneAttributes = new Set<string>();\n    for (let i = 0; i < target.attributes.length; i += 1) {\n      cloneAttributes.add(target.attributes[i].name);\n    }\n\n    Array.from(source.attributes).forEach((attribute) => {\n      target.setAttribute(attribute.name, attribute.value);\n      cloneAttributes.delete(attribute.name);\n    });\n\n    cloneAttributes.forEach((name) => {\n      if (name.startsWith('data-hyperframe')) {\n        return;\n      }\n      target.removeAttribute(name);\n    });\n  }\n\n  private createSourceId(): string {\n    this.sourceIdCounter += 1;\n    return `hf-style-${this.sourceIdCounter}`;\n  }\n}\n\nexport function syncParentStyles(targetDocument: Document, options: StyleMirrorOptions = {}): ParentStyleMirror {\n  const mirror = new ParentStyleMirror(targetDocument);\n  mirror.start(options);\n  return mirror;\n}\n",
    "import {\n  HyperFrameControlRuntime,\n  HyperFrameControlSetup,\n  HyperFrameContext,\n  HyperFrameMessageHandler,\n  HyperFrameRenderer,\n  HyperFrameRendererContext,\n  HyperFrameRendererSession,\n  HyperFrameSession,\n  HyperFrameStartOptions,\n  ControlChangePayload,\n} from './types';\nimport { resolveContainer } from './dom';\nimport { ParentStyleMirror, syncParentStyles } from './styleSync';\n\ninterface HyperFrameRuntimeOptions {\n  autoSyncParentStyles?: boolean;\n  defaultContainerClassName?: string;\n}\n\ninterface ContextRef {\n  current: HyperFrameContext | null;\n}\n\ninterface ActiveSession {\n  container: HTMLElement;\n  createdInternally: boolean;\n  controlRuntime: HyperFrameControlRuntime | null;\n  rendererSession: HyperFrameRendererSession | null;\n  context: HyperFrameContext;\n}\n\ntype ListenerMap = Map<string, Set<HyperFrameMessageHandler>>;\n\nfunction getHypertoolControls(): any {\n  if (typeof window === 'undefined') {\n    throw new Error('[hyper-frame] window is not available');\n  }\n\n  const hyperWindow = window as unknown as {\n    hypertoolControls?: any;\n  };\n\n  if (!hyperWindow.hypertoolControls) {\n    throw new Error('[hyper-frame] hypertool controls are not available on window');\n  }\n\n  return hyperWindow.hypertoolControls;\n}\n\nfunction nextFrame(callback: () => void) {\n  if (typeof requestAnimationFrame === 'function') {\n    requestAnimationFrame(callback);\n  } else {\n    setTimeout(callback, 16);\n  }\n}\n\nfunction waitForCondition(condition: () => boolean, maxAttempts: number, label: string): Promise<void> {\n  return new Promise((resolve, reject) => {\n    let attempts = 0;\n\n    function tick() {\n      attempts += 1;\n\n      try {\n        if (condition()) {\n          resolve();\n          return;\n        }\n      } catch (error) {\n        // ignore errors from condition evaluation and keep waiting\n      }\n\n      if (attempts >= maxAttempts) {\n        reject(new Error(`[hyper-frame] Timed out waiting for ${label}`));\n        return;\n      }\n\n      nextFrame(tick);\n    }\n\n    tick();\n  });\n}\n\nasync function ensureControlsReady(maxAttempts: number): Promise<void> {\n  await waitForCondition(() => {\n    try {\n      getHypertoolControls();\n      return true;\n    } catch (error) {\n      return false;\n    }\n  }, maxAttempts, 'hypertool controls');\n}\n\nasync function initializeControls(\n  setup: HyperFrameControlSetup,\n  contextRef: ContextRef,\n  readinessAttempts: number\n): Promise<HyperFrameControlRuntime> {\n  await ensureControlsReady(readinessAttempts);\n  const controlsApi = getHypertoolControls();\n  const baseOptions = setup.options || {};\n\n  const controlInstance = controlsApi.createControlPanel(setup.definitions, {\n    title: baseOptions.title,\n    position: baseOptions.position,\n    expanded: baseOptions.expanded,\n    container: baseOptions.container,\n    onChange: (params: Record<string, any>, changeContext: any) => {\n      if (contextRef.current) {\n        contextRef.current.params = params;\n        if (typeof baseOptions.onChange === 'function') {\n          const payload: ControlChangePayload = {\n            key: changeContext.key,\n            value: changeContext.value,\n            event: changeContext.event,\n          };\n          try {\n            baseOptions.onChange(payload, contextRef.current);\n          } catch (error) {\n            console.error('[hyper-frame] Error in control change handler:', error);\n          }\n        }\n      }\n    },\n  });\n\n  return {\n    params: controlInstance.params,\n    controls: controlInstance,\n    destroy: () => {\n      if (typeof controlInstance.destroy === 'function') {\n        controlInstance.destroy();\n      }\n    },\n  };\n}\n\nexport class HyperFrameRuntime {\n  private readonly renderers = new Map<string, HyperFrameRenderer<any>>();\n  private readonly listeners: ListenerMap = new Map();\n  private readonly options: HyperFrameRuntimeOptions;\n  private styleMirror: ParentStyleMirror | null = null;\n  private activeSession: ActiveSession | null = null;\n  private readyAttempts = 600;\n\n  constructor(options: HyperFrameRuntimeOptions = {}) {\n    this.options = options;\n    if (typeof window !== 'undefined') {\n      window.addEventListener('message', (event) => {\n        this.handleIncomingMessage(event.data);\n      });\n    }\n  }\n\n  registerRenderer<TOptions = Record<string, unknown>>(renderer: HyperFrameRenderer<TOptions>): void {\n    this.renderers.set(renderer.id, renderer as HyperFrameRenderer<any>);\n  }\n\n  unregisterRenderer(id: string): void {\n    this.renderers.delete(id);\n  }\n\n  listRenderers(): string[] {\n    return Array.from(this.renderers.keys());\n  }\n\n  syncParentStyles(force = false): void {\n    if (typeof document === 'undefined') {\n      return;\n    }\n\n    if (this.styleMirror && !force) {\n      return;\n    }\n\n    this.styleMirror = syncParentStyles(document);\n  }\n\n  onMessage(type: string, handler: HyperFrameMessageHandler): () => void {\n    if (!this.listeners.has(type)) {\n      this.listeners.set(type, new Set());\n    }\n    this.listeners.get(type)!.add(handler);\n    return () => {\n      this.listeners.get(type)?.delete(handler);\n    };\n  }\n\n  sendMessage(type: string, payload?: unknown): void {\n    this.emitLocal(type, payload);\n    if (typeof window !== 'undefined' && window.parent && window.parent !== window) {\n      try {\n        window.parent.postMessage(\n          {\n            source: 'hyperframe-runtime',\n            type,\n            payload,\n          },\n          '*'\n        );\n      } catch (error) {\n        console.warn('[hyper-frame] Failed to post message to parent window:', error);\n      }\n    }\n  }\n\n  async start<TOptions = Record<string, unknown>>(options: HyperFrameStartOptions<TOptions>): Promise<HyperFrameSession> {\n    if (typeof window === 'undefined' || typeof document === 'undefined') {\n      throw new Error('[hyper-frame] HyperFrameRuntime can only run in a browser environment');\n    }\n\n    if (this.options.autoSyncParentStyles !== false || options.syncParentStyles) {\n      this.syncParentStyles();\n    }\n\n    const rendererId = options.renderer;\n    const renderer = rendererId ? this.renderers.get(rendererId) : null;\n\n    if (rendererId && !renderer) {\n      throw new Error(`[hyper-frame] Renderer \"${rendererId}\" is not registered`);\n    }\n\n    const resolveOptions = {\n      target: options.target,\n      className: options.containerClassName || this.options.defaultContainerClassName,\n    };\n\n    const containerInfo = resolveContainer(resolveOptions);\n    const contextRef: ContextRef = { current: null };\n\n    const controlRuntime = options.controls\n      ? await initializeControls(options.controls, contextRef, this.readyAttempts)\n      : null;\n\n    const params = controlRuntime ? controlRuntime.params : {};\n    const controls = controlRuntime ? controlRuntime.controls : null;\n\n    const environment = { window, document };\n\n    const context: HyperFrameContext = {\n      params,\n      controls,\n      container: containerInfo.element,\n      environment,\n      metadata: options.metadata,\n      rendererOptions: (options.rendererOptions || {}) as Record<string, unknown>,\n      sendMessage: (type: string, payload?: unknown) => this.sendMessage(type, payload),\n      onMessage: (type: string, handler: HyperFrameMessageHandler) => this.onMessage(type, handler),\n    };\n\n    contextRef.current = context;\n\n    if (renderer && typeof renderer.prepare === 'function') {\n      await renderer.prepare(options.rendererOptions as TOptions);\n    }\n\n    let rendererSession: HyperFrameRendererSession | null = null;\n\n    if (renderer) {\n      const result = await renderer.mount({\n        ...context,\n        options: (options.rendererOptions || {}) as TOptions,\n      } as HyperFrameRendererContext<TOptions>);\n      rendererSession = result || null;\n    }\n\n    if (this.activeSession) {\n      this.activeSession.rendererSession?.destroy?.();\n      this.activeSession.controlRuntime?.destroy();\n      if (this.activeSession.createdInternally) {\n        this.activeSession.container.remove();\n      }\n    }\n\n    const activeSession: ActiveSession = {\n      container: containerInfo.element,\n      createdInternally: containerInfo.createdInternally,\n      controlRuntime,\n      rendererSession,\n      context,\n    };\n\n    this.activeSession = activeSession;\n    this.sendMessage('ready', {\n      params,\n      metadata: options.metadata || null,\n      renderer: rendererId || null,\n    });\n\n    return {\n      params,\n      controls,\n      container: containerInfo.element,\n      metadata: options.metadata,\n      destroy: () => this.destroyActiveSession(activeSession),\n      update: rendererSession?.update?.bind(rendererSession),\n      getInstance: rendererSession?.getInstance?.bind(rendererSession),\n    };\n  }\n\n  private destroyActiveSession(session: ActiveSession): void {\n    session.rendererSession?.destroy?.();\n    session.controlRuntime?.destroy();\n    if (session.createdInternally) {\n      session.container.remove();\n    }\n    if (this.activeSession === session) {\n      this.activeSession = null;\n    }\n  }\n\n  private emitLocal(type: string, payload?: unknown) {\n    const handlers = this.listeners.get(type);\n    if (!handlers) {\n      return;\n    }\n    handlers.forEach((handler) => {\n      try {\n        handler(payload);\n      } catch (error) {\n        console.error('[hyper-frame] Error in message handler:', error);\n      }\n    });\n  }\n\n  private handleIncomingMessage(data: any) {\n    if (!data || typeof data !== 'object') {\n      return;\n    }\n\n    const message = data as { source?: string; type?: string; payload?: unknown };\n\n    if (message.source && message.source !== 'hypertool-studio' && message.source !== 'hyperframe-host') {\n      return;\n    }\n\n    if (!message.type) {\n      return;\n    }\n\n    this.emitLocal(message.type, message.payload);\n  }\n}\n\nexport function createHyperFrameRuntime(options: HyperFrameRuntimeOptions = {}): HyperFrameRuntime {\n  return new HyperFrameRuntime(options);\n}\n",
    "import type {\n  HyperFrameRenderer,\n  HyperFrameRendererContext,\n  HyperFrameRendererSession,\n  ControlDefinitions,\n  ControlChangePayload,\n} from '../types';\nimport { HyperFrameRuntime } from '../runtime';\nimport type { ResolveContainerOptions } from '../dom';\nimport { resolveContainer } from '../dom';\n\nexport type P5Instance = any;\n\nexport type P5Handler = (instance: P5Instance, ...args: any[]) => void;\n\nexport type P5HandlerMap = Record<string, P5Handler | undefined>;\n\nexport interface MountOptions extends ResolveContainerOptions {\n  containerClassName?: string;\n  onReady?: (context: { p5: P5Instance; container: HTMLElement }) => void;\n}\n\nexport interface MountResult {\n  container: HTMLElement;\n  getInstance(): P5Instance | null;\n  setHandlers(handlers: P5HandlerMap): void;\n  destroy(): void;\n}\n\ntype P5Constructor = new (sketch: (p5: P5Instance) => void, node?: HTMLElement) => P5Instance;\n\ndeclare global {\n  interface Window {\n    p5?: P5Constructor;\n  }\n}\n\nfunction getP5Constructor(): P5Constructor {\n  if (typeof window === 'undefined') {\n    throw new Error('[hyper-frame] window is not available');\n  }\n\n  const ctor = window.p5;\n\n  if (typeof ctor !== 'function') {\n    throw new Error('[hyper-frame] p5 constructor not found on window. Ensure p5 is loaded before hyper-frame.');\n  }\n\n  return ctor as P5Constructor;\n}\n\nexport function mountP5Sketch(initialHandlers: P5HandlerMap, options?: MountOptions): MountResult {\n  if (typeof document === 'undefined') {\n    throw new Error('mountP5Sketch cannot run outside a browser environment');\n  }\n\n  const opts: MountOptions = options || {};\n  const currentHandlers: P5HandlerMap = { ...initialHandlers };\n  const containerInfo = resolveContainer({\n    target: opts.target,\n    className: opts.className || opts.containerClassName,\n  });\n  const container = containerInfo.element;\n  const createdInternally = containerInfo.createdInternally;\n\n  let instance: P5Instance | null = null;\n\n  function sketch(p5Instance: P5Instance) {\n    instance = p5Instance;\n    applyHandlers(p5Instance, currentHandlers);\n    if (opts.onReady) {\n      opts.onReady({ p5: p5Instance, container });\n    }\n  }\n\n  const P5Ctor = getP5Constructor();\n  const p5Controller = new P5Ctor(sketch, container);\n  if (!instance) {\n    instance = (p5Controller as unknown) as P5Instance;\n  }\n\n  function setHandlers(nextHandlers: P5HandlerMap) {\n    if (!instance) {\n      return;\n    }\n    applyHandlers(instance, nextHandlers);\n  }\n\n  function destroy() {\n    if (instance) {\n      instance.remove();\n      instance = null;\n    }\n\n    if (createdInternally) {\n      container.remove();\n    }\n  }\n\n  return {\n    container,\n    getInstance: () => instance,\n    setHandlers,\n    destroy,\n  };\n}\n\nfunction applyHandlers(instance: P5Instance, handlers: P5HandlerMap) {\n  Object.keys(handlers).forEach((key) => {\n    const handler = handlers[key];\n    if (typeof handler === 'function') {\n      (instance as Record<string, unknown>)[key] = function handlerWrapper(this: unknown, ...args: any[]) {\n        return (handler as P5Handler)(instance as P5Instance, ...args);\n      };\n    }\n  });\n}\n\nexport interface P5ControlPanelOptions {\n  title?: string;\n  position?: string;\n  expanded?: boolean;\n  container?: HTMLElement | string | null;\n  onChange?: (change: ControlChangePayload, context: P5SketchContext) => void;\n}\n\nexport interface P5SketchContext {\n  params: Record<string, any>;\n  controls: any;\n  getP5Instance(): P5Instance | null;\n}\n\nexport type P5SketchHandler = (p5: P5Instance, context: P5SketchContext, ...args: any[]) => void;\n\nexport type P5SketchHandlers = Record<string, P5SketchHandler | undefined>;\n\nexport interface RunP5SketchOptions {\n  controlDefinitions: ControlDefinitions;\n  handlers: P5SketchHandlers;\n  controls?: P5ControlPanelOptions;\n  mount?: MountOptions;\n  preconfiguredControls?: {\n    params: Record<string, any>;\n    controls: any;\n  };\n}\n\nexport interface RunP5SketchResult {\n  params: Record<string, any>;\n  controls: any;\n  context: P5SketchContext;\n  destroy(): void;\n  setHandlers(handlers: P5SketchHandlers): void;\n  getInstance(): P5Instance | null;\n}\n\nfunction getHypertoolControls(): any {\n  if (typeof window === 'undefined') {\n    throw new Error('[hyper-frame] window is not available');\n  }\n  const hyperWindow = window as unknown as {\n    hypertoolControls?: any;\n  };\n\n  if (!hyperWindow.hypertoolControls) {\n    throw new Error('[hyper-frame] hypertool controls are not available on window');\n  }\n\n  return hyperWindow.hypertoolControls;\n}\n\nfunction wrapHandlers(\n  handlers: P5SketchHandlers,\n  context: P5SketchContext,\n  setActiveInstance: (instance: P5Instance) => void\n): P5HandlerMap {\n  const wrapped: P5HandlerMap = {};\n\n  Object.entries(handlers).forEach(([key, handler]) => {\n    if (typeof handler === 'function') {\n      wrapped[key] = function wrappedHandler(instance: P5Instance, ...args: any[]) {\n        setActiveInstance(instance);\n        return (handler as P5SketchHandler)(instance, context, ...args);\n      };\n    }\n  });\n\n  return wrapped;\n}\n\nexport function runP5Sketch(options: RunP5SketchOptions): RunP5SketchResult {\n  const controlOptions = options.controls || {};\n\n  let params: Record<string, any>;\n  let controlsInstance: any;\n  let ownsControls = false;\n\n  if (options.preconfiguredControls) {\n    params = options.preconfiguredControls.params;\n    controlsInstance = options.preconfiguredControls.controls;\n  } else {\n    const controlsApi = getHypertoolControls();\n    controlsInstance = controlsApi.createControlPanel(options.controlDefinitions, {\n      title: controlOptions.title,\n      position: controlOptions.position,\n      expanded: controlOptions.expanded,\n      container: controlOptions.container,\n      onChange: (updatedParams: Record<string, any>, changeContext: any) => {\n        if (typeof controlOptions.onChange === 'function') {\n          const change: ControlChangePayload = {\n            key: changeContext.key,\n            value: changeContext.value,\n            event: changeContext.event,\n          };\n          controlOptions.onChange(change, sketchContext);\n        }\n      },\n    });\n    params = controlsInstance.params;\n    ownsControls = true;\n  }\n\n  const sketchContext: P5SketchContext = {\n    params,\n    controls: controlsInstance,\n    getP5Instance: () => activeInstance,\n  };\n\n  let activeInstance: P5Instance | null = null;\n\n  function setActiveInstance(instance: P5Instance) {\n    activeInstance = instance;\n  }\n\n  const mounted = mountP5Sketch(\n    wrapHandlers(options.handlers, sketchContext, setActiveInstance),\n    options.mount\n  );\n\n  function setHandlers(handlers: P5SketchHandlers) {\n    mounted.setHandlers(wrapHandlers(handlers, sketchContext, setActiveInstance));\n  }\n\n  return {\n    params,\n    controls: controlsInstance,\n    context: sketchContext,\n    destroy() {\n      mounted.destroy();\n      if (ownsControls && typeof controlsInstance.destroy === 'function') {\n        controlsInstance.destroy();\n      }\n    },\n    setHandlers,\n    getInstance() {\n      return mounted.getInstance();\n    },\n  };\n}\n\nfunction nextFrame(callback: () => void) {\n  if (typeof requestAnimationFrame === 'function') {\n    requestAnimationFrame(callback);\n  } else {\n    setTimeout(callback, 16);\n  }\n}\n\nfunction waitForCondition(condition: () => boolean, maxAttempts: number, label: string): Promise<void> {\n  return new Promise((resolve, reject) => {\n    let attempts = 0;\n\n    function tick() {\n      attempts += 1;\n\n      try {\n        if (condition()) {\n          resolve();\n          return;\n        }\n      } catch (error) {}\n\n      if (attempts >= maxAttempts) {\n        reject(new Error(`[hyper-frame] Timed out waiting for ${label}`));\n        return;\n      }\n\n      nextFrame(tick);\n    }\n\n    tick();\n  });\n}\n\nconst DEFAULT_P5_CDN_URL = 'https://cdn.jsdelivr.net/npm/p5@1.6.0/lib/p5.min.js';\nconst P5_SCRIPT_SELECTOR = 'script[data-hypertool=\"p5\"]';\n\nfunction ensureP5Script(url: string, maxAttempts: number): Promise<void> {\n  if (typeof window === 'undefined') {\n    return Promise.reject(new Error('[hyper-frame] window is not available'));\n  }\n\n  if (typeof window.p5 === 'function') {\n    return Promise.resolve();\n  }\n\n  return new Promise((resolve, reject) => {\n    let settled = false;\n\n    function fulfill() {\n      if (settled) return;\n      settled = true;\n      resolve();\n    }\n\n    function fail(error: Error) {\n      if (settled) return;\n      settled = true;\n      reject(error);\n    }\n\n    waitForCondition(() => typeof window.p5 === 'function', maxAttempts, 'p5 constructor')\n      .then(fulfill)\n      .catch(fail);\n\n    function handleScriptError() {\n      fail(new Error(`[hyper-frame] Failed to load p5 script from ${url}`));\n    }\n\n    const existing = document.querySelector<HTMLScriptElement>(P5_SCRIPT_SELECTOR);\n    if (existing) {\n      existing.addEventListener('error', handleScriptError, { once: true });\n      return;\n    }\n\n    const script = document.createElement('script');\n    script.src = url;\n    script.async = true;\n    script.dataset.hypertool = 'p5';\n    script.addEventListener('error', handleScriptError, { once: true });\n    document.head.appendChild(script);\n  });\n}\n\nexport interface StartP5SketchOptions extends RunP5SketchOptions {\n  p5?: {\n    url?: string;\n    maxAttempts?: number;\n  };\n  readiness?: {\n    maxAttempts?: number;\n  };\n  metadata?: Record<string, unknown>;\n}\n\nexport interface RunP5SketchResultWithInstance extends RunP5SketchResult {\n  setHandlers(handlers: P5SketchHandlers): void;\n  getInstance(): P5Instance | null;\n}\n\nexport async function startP5SketchWithRuntime(\n  runtime: HyperFrameRuntime,\n  options: StartP5SketchOptions\n): Promise<RunP5SketchResultWithInstance> {\n  const readinessAttempts = typeof options.readiness?.maxAttempts === 'number'\n    ? options.readiness.maxAttempts\n    : 600;\n\n  const p5Attempts = typeof options.p5?.maxAttempts === 'number'\n    ? options.p5.maxAttempts\n    : readinessAttempts;\n\n  const p5Url = typeof options.p5?.url === 'string' && options.p5.url.trim().length > 0\n    ? options.p5.url\n    : DEFAULT_P5_CDN_URL;\n\n  await ensureP5Script(p5Url, p5Attempts);\n\n  const instanceRef: { current: P5Instance | null } = { current: null };\n\n  const controlDefinitions = options.controlDefinitions;\n  const controlsOptions = options.controls;\n\n  const session = await runtime.start<P5RendererOptions>({\n    renderer: 'p5',\n    rendererOptions: {\n      ...options,\n      instanceRef,\n    } as P5RendererOptions,\n    controls: controlDefinitions\n      ? {\n          definitions: controlDefinitions as ControlDefinitions,\n          options: controlsOptions\n            ? {\n                ...controlsOptions,\n                onChange: controlsOptions.onChange\n                  ? (change: ControlChangePayload, context) => {\n                      if (!controlsOptions.onChange) {\n                        return;\n                      }\n                      const sketchContext: P5SketchContext = {\n                        params: context.params,\n                        controls: context.controls,\n                        getP5Instance: () => instanceRef.current,\n                      };\n                      controlsOptions.onChange(change, sketchContext);\n                    }\n                  : undefined,\n              }\n            : undefined,\n        }\n      : null,\n    target: options.mount?.target ?? null,\n    containerClassName: options.mount?.className || options.mount?.containerClassName,\n    metadata: options.metadata,\n  });\n\n  return {\n    params: session.params,\n    controls: session.controls,\n    context: {\n      params: session.params,\n      controls: session.controls,\n      getP5Instance: () => (session.getInstance ? (session.getInstance() as P5Instance | null) : instanceRef.current),\n    },\n    destroy: () => session.destroy(),\n    setHandlers: (handlers: P5SketchHandlers) => {\n      if (session.update) {\n        session.update({ type: 'handlers', handlers });\n      }\n    },\n    getInstance: () => (session.getInstance ? (session.getInstance() as P5Instance | null) : instanceRef.current),\n  };\n}\n\nexport interface P5RendererSession extends HyperFrameRendererSession {\n  setHandlers(handlers: P5SketchHandlers): void;\n}\n\nexport interface P5RendererOptions extends StartP5SketchOptions {\n  instanceRef?: { current: P5Instance | null };\n}\n\nexport function createP5Renderer(): HyperFrameRenderer<P5RendererOptions, P5RendererSession> {\n  return {\n    id: 'p5',\n    async mount(context: HyperFrameRendererContext<P5RendererOptions>) {\n      const options = context.options;\n      const instanceRef = options.instanceRef || { current: null };\n\n      let activeInstance: P5Instance | null = null;\n\n      const sketchContext: P5SketchContext = {\n        params: context.params,\n        controls: context.controls,\n        getP5Instance: () => activeInstance,\n      };\n\n      const wrappedHandlers = wrapHandlers(options.handlers || {}, sketchContext, (instance) => {\n        activeInstance = instance;\n        instanceRef.current = instance;\n      });\n\n      const mountResult = mountP5Sketch(wrappedHandlers, {\n        ...(options.mount || {}),\n        target: context.container,\n        className: options.mount?.className || options.mount?.containerClassName || context.container.className,\n        containerClassName: options.mount?.containerClassName,\n        onReady: (readyContext) => {\n          activeInstance = readyContext.p5;\n          instanceRef.current = readyContext.p5;\n          if (options.mount?.onReady) {\n            options.mount.onReady(readyContext);\n          }\n        },\n      });\n\n      return {\n        destroy: () => {\n          mountResult.destroy();\n        },\n        update: (message: unknown) => {\n          if (\n            message &&\n            typeof message === 'object' &&\n            (message as { type?: string }).type === 'handlers'\n          ) {\n            const payload = message as { handlers?: P5SketchHandlers };\n            if (payload.handlers) {\n              mountResult.setHandlers(\n                wrapHandlers(payload.handlers, sketchContext, (instance) => {\n                  activeInstance = instance;\n                  instanceRef.current = instance;\n                })\n              );\n            }\n          }\n        },\n        getInstance: () => mountResult.getInstance(),\n        setHandlers: (handlers: P5SketchHandlers) => {\n          mountResult.setHandlers(\n            wrapHandlers(handlers, sketchContext, (instance) => {\n              activeInstance = instance;\n              instanceRef.current = instance;\n            })\n          );\n        },\n      } as P5RendererSession;\n    },\n  };\n}\n",
    "import type {\n  HyperFrameRenderer,\n  HyperFrameRendererContext,\n  HyperFrameRendererSession,\n  ControlDefinitions,\n  ControlChangePayload,\n} from '../types';\nimport { HyperFrameRuntime } from '../runtime';\nimport type { ResolveContainerOptions } from '../dom';\nimport { resolveContainer } from '../dom';\n\nexport type ThreeInstance = any;\n\nexport interface ThreeContext {\n  scene: any;\n  camera: any;\n  renderer: any;\n  controls?: any;\n}\n\nexport interface ThreeSketchContext {\n  params: Record<string, any>;\n  controls: any;\n  getThreeContext(): ThreeContext | null;\n}\n\nexport type ThreeSketchHandler = (three: ThreeContext, context: ThreeSketchContext, ...args: any[]) => void;\n\nexport interface ThreeLifecycleHandlers {\n  setup?: ThreeSketchHandler;\n  animate?: ThreeSketchHandler;\n  resize?: ThreeSketchHandler;\n  dispose?: () => void;\n}\n\nexport interface MountThreeOptions extends ResolveContainerOptions {\n  containerClassName?: string;\n  camera?: {\n    type?: 'perspective' | 'orthographic';\n    fov?: number;\n    near?: number;\n    far?: number;\n    position?: [number, number, number];\n  };\n  renderer?: {\n    antialias?: boolean;\n    alpha?: boolean;\n    preserveDrawingBuffer?: boolean;\n  };\n  orbitControls?: boolean;\n  onReady?: (context: ThreeContext) => void;\n}\n\nexport interface MountThreeResult {\n  container: HTMLElement;\n  getContext(): ThreeContext | null;\n  destroy(): void;\n  startAnimation(): void;\n  stopAnimation(): void;\n  setHandlers(handlers: ThreeLifecycleHandlers): void;\n}\n\nfunction getThreeConstructors(): any {\n  if (typeof window === 'undefined') {\n    throw new Error('[hyper-frame] window is not available');\n  }\n\n  const THREE = (window as any).THREE;\n\n  if (typeof THREE !== 'object') {\n    throw new Error('[hyper-frame] THREE not found on window. Make sure to import and expose Three.js on window in your sketch.');\n  }\n\n  return THREE;\n}\n\nexport function mountThreeSketch(initialHandlers: ThreeLifecycleHandlers, options?: MountThreeOptions): MountThreeResult {\n  if (typeof document === 'undefined') {\n    throw new Error('mountThreeSketch cannot run outside a browser environment');\n  }\n\n  const opts: MountThreeOptions = options || {};\n  const THREE = getThreeConstructors();\n\n  const containerInfo = resolveContainer({\n    target: opts.target,\n    className: opts.className || opts.containerClassName || 'hyperframe-three-sketch',\n  });\n  const container = containerInfo.element;\n  const createdInternally = containerInfo.createdInternally;\n\n  const scene = new THREE.Scene();\n\n  const cameraOpts = opts.camera || {};\n  const cameraType = cameraOpts.type || 'perspective';\n  let camera: any;\n\n  if (cameraType === 'perspective') {\n    camera = new THREE.PerspectiveCamera(\n      cameraOpts.fov || 75,\n      window.innerWidth / window.innerHeight,\n      cameraOpts.near || 0.1,\n      cameraOpts.far || 1000\n    );\n  } else {\n    const aspect = window.innerWidth / window.innerHeight;\n    camera = new THREE.OrthographicCamera(\n      -aspect,\n      aspect,\n      1,\n      -1,\n      cameraOpts.near || 0.1,\n      cameraOpts.far || 1000\n    );\n  }\n\n  if (cameraOpts.position) {\n    camera.position.set(...cameraOpts.position);\n  } else {\n    camera.position.z = 5;\n  }\n\n  const rendererOpts = opts.renderer || {};\n  const renderer = new THREE.WebGLRenderer({\n    antialias: rendererOpts.antialias !== false,\n    alpha: rendererOpts.alpha || false,\n    preserveDrawingBuffer: rendererOpts.preserveDrawingBuffer || false,\n  });\n  renderer.setSize(container.clientWidth || window.innerWidth, container.clientHeight || window.innerHeight);\n  renderer.setPixelRatio(window.devicePixelRatio);\n  container.appendChild(renderer.domElement);\n\n  let orbitControls: any = null;\n  if (opts.orbitControls) {\n    const OrbitControls = (window as any).OrbitControls || THREE.OrbitControls;\n    if (OrbitControls) {\n      orbitControls = new OrbitControls(camera, renderer.domElement);\n    } else {\n      console.warn('[hyper-frame] OrbitControls not found. Make sure to import and expose it on window.');\n    }\n  }\n\n  const threeContext: ThreeContext = {\n    scene,\n    camera,\n    renderer,\n    controls: orbitControls,\n  };\n\n  let animationId: number | null = null;\n  let isAnimating = false;\n  let currentHandlers: ThreeLifecycleHandlers = { ...initialHandlers };\n\n  const sketchContextPlaceholder: ThreeSketchContext = {\n    params: {},\n    controls: null,\n    getThreeContext: () => threeContext,\n  };\n\n  function handleResize() {\n    const width = container.clientWidth || window.innerWidth;\n    const height = container.clientHeight || window.innerHeight;\n\n    if (camera instanceof THREE.PerspectiveCamera) {\n      camera.aspect = width / height;\n      camera.updateProjectionMatrix();\n    } else if (camera instanceof THREE.OrthographicCamera) {\n      const aspect = width / height;\n      camera.left = -aspect;\n      camera.right = aspect;\n      camera.updateProjectionMatrix();\n    }\n\n    renderer.setSize(width, height);\n\n    if (currentHandlers.resize) {\n      currentHandlers.resize(threeContext, sketchContextPlaceholder);\n    }\n  }\n\n  function animate() {\n    if (!isAnimating) {\n      return;\n    }\n\n    animationId = requestAnimationFrame(animate);\n\n    if (currentHandlers.animate) {\n      currentHandlers.animate(threeContext, sketchContextPlaceholder);\n    }\n\n    renderer.render(scene, camera);\n  }\n\n  function startAnimation() {\n    if (isAnimating) {\n      return;\n    }\n    isAnimating = true;\n    animate();\n  }\n\n  function stopAnimation() {\n    isAnimating = false;\n    if (animationId !== null) {\n      cancelAnimationFrame(animationId);\n      animationId = null;\n    }\n  }\n\n  window.addEventListener('resize', handleResize);\n\n  if (currentHandlers.setup) {\n    currentHandlers.setup(threeContext, sketchContextPlaceholder);\n  }\n\n  startAnimation();\n\n  if (opts.onReady) {\n    opts.onReady(threeContext);\n  }\n\n  return {\n    container,\n    getContext: () => threeContext,\n    destroy() {\n      stopAnimation();\n      window.removeEventListener('resize', handleResize);\n      if (currentHandlers.dispose) {\n        currentHandlers.dispose();\n      }\n      if (orbitControls) {\n        orbitControls.dispose();\n      }\n      renderer.dispose();\n      container.removeChild(renderer.domElement);\n      if (createdInternally) {\n        container.remove();\n      }\n    },\n    startAnimation,\n    stopAnimation,\n    setHandlers(nextHandlers: ThreeLifecycleHandlers) {\n      currentHandlers = { ...nextHandlers };\n    },\n  };\n}\n\nexport interface ThreeControlPanelOptions {\n  title?: string;\n  position?: string;\n  expanded?: boolean;\n  container?: HTMLElement | string | null;\n  onChange?: (change: ControlChangePayload, context: ThreeSketchContext) => void;\n}\n\nexport interface RunThreeSketchOptions {\n  controlDefinitions: ControlDefinitions;\n  handlers: ThreeLifecycleHandlers;\n  controls?: ThreeControlPanelOptions;\n  mount?: MountThreeOptions;\n  preconfiguredControls?: {\n    params: Record<string, any>;\n    controls: any;\n  };\n}\n\nexport interface RunThreeSketchResult {\n  params: Record<string, any>;\n  controls: any;\n  context: ThreeSketchContext;\n  threeContext: ThreeContext;\n  destroy(): void;\n  getInstance(): ThreeContext | null;\n}\n\nfunction getHypertoolControls(): any {\n  if (typeof window === 'undefined') {\n    throw new Error('[hyper-frame] window is not available');\n  }\n  const hyperWindow = window as unknown as {\n    hypertoolControls?: any;\n  };\n\n  if (!hyperWindow.hypertoolControls) {\n    throw new Error('[hyper-frame] hypertool controls are not available on window');\n  }\n\n  return hyperWindow.hypertoolControls;\n}\n\nexport function runThreeSketch(options: RunThreeSketchOptions): RunThreeSketchResult {\n  const controlOptions = options.controls || {};\n\n  let params: Record<string, any> = {};\n  let controlsInstance: any;\n  let ownsControls = false;\n\n  if (options.preconfiguredControls) {\n    params = options.preconfiguredControls.params;\n    controlsInstance = options.preconfiguredControls.controls;\n  } else {\n    const controlsApi = getHypertoolControls();\n    controlsInstance = controlsApi.createControlPanel(options.controlDefinitions, {\n      title: controlOptions.title,\n      position: controlOptions.position,\n      expanded: controlOptions.expanded,\n      container: controlOptions.container,\n      onChange: (updatedParams: Record<string, any>, changeContext: any) => {\n        sketchContext.params = updatedParams;\n        if (typeof controlOptions.onChange === 'function') {\n          const change: ControlChangePayload = {\n            key: changeContext.key,\n            value: changeContext.value,\n            event: changeContext.event,\n          };\n          controlOptions.onChange(change, sketchContext);\n        }\n      },\n    });\n    params = controlsInstance.params;\n    ownsControls = true;\n  }\n\n  let mountResult: MountThreeResult | null = null;\n\n  const sketchContext: ThreeSketchContext = {\n    params,\n    controls: controlsInstance,\n    getThreeContext: () => (mountResult ? mountResult.getContext() : null),\n  };\n\n  const wrappedHandlers: ThreeLifecycleHandlers = {\n    setup: options.handlers.setup\n      ? (three, _ctx) => options.handlers.setup!(three, sketchContext)\n      : undefined,\n    animate: options.handlers.animate\n      ? (three, _ctx) => options.handlers.animate!(three, sketchContext)\n      : undefined,\n    resize: options.handlers.resize\n      ? (three, _ctx) => options.handlers.resize!(three, sketchContext)\n      : undefined,\n    dispose: options.handlers.dispose,\n  };\n\n  mountResult = mountThreeSketch(wrappedHandlers, options.mount);\n\n  return {\n    params,\n    controls: controlsInstance,\n    context: sketchContext,\n    threeContext: mountResult.getContext()!,\n    destroy() {\n      mountResult?.destroy();\n      if (ownsControls && typeof controlsInstance.destroy === 'function') {\n        controlsInstance.destroy();\n      }\n    },\n    getInstance() {\n      return mountResult ? mountResult.getContext() : null;\n    },\n  };\n}\n\nfunction nextFrame(callback: () => void) {\n  if (typeof requestAnimationFrame === 'function') {\n    requestAnimationFrame(callback);\n  } else {\n    setTimeout(callback, 16);\n  }\n}\n\nfunction waitForCondition(condition: () => boolean, maxAttempts: number, label: string): Promise<void> {\n  return new Promise((resolve, reject) => {\n    let attempts = 0;\n\n    function tick() {\n      attempts += 1;\n\n      try {\n        if (condition()) {\n          resolve();\n          return;\n        }\n      } catch (error) {}\n\n      if (attempts >= maxAttempts) {\n        reject(new Error(`[hyper-frame] Timed out waiting for ${label}`));\n        return;\n      }\n\n      nextFrame(tick);\n    }\n\n    tick();\n  });\n}\n\nfunction ensureThreeReady(maxAttempts: number): Promise<void> {\n  return waitForCondition(() => {\n    try {\n      getThreeConstructors();\n      return true;\n    } catch (error) {\n      return false;\n    }\n  }, maxAttempts, 'THREE constructor');\n}\n\nexport interface StartThreeSketchOptions extends RunThreeSketchOptions {\n  readiness?: {\n    maxAttempts?: number;\n  };\n  metadata?: Record<string, unknown>;\n}\n\nexport async function startThreeSketchWithRuntime(\n  runtime: HyperFrameRuntime,\n  options: StartThreeSketchOptions\n): Promise<RunThreeSketchResult> {\n  const readinessAttempts = typeof options.readiness?.maxAttempts === 'number'\n    ? options.readiness.maxAttempts\n    : 600;\n\n  await ensureThreeReady(readinessAttempts);\n\n  const threeContextRef: { current: ThreeContext | null } = { current: null };\n\n  const session = await runtime.start<ThreeRendererOptions>({\n    renderer: 'three',\n    rendererOptions: {\n      ...options,\n      threeContextRef,\n    } as ThreeRendererOptions,\n    controls: options.controlDefinitions\n      ? {\n          definitions: options.controlDefinitions as ControlDefinitions,\n          options: options.controls\n            ? {\n                ...options.controls,\n                onChange: options.controls.onChange\n                  ? (change: ControlChangePayload, context) => {\n                      if (!options.controls?.onChange) {\n                        return;\n                      }\n                      const sketchContext: ThreeSketchContext = {\n                        params: context.params,\n                        controls: context.controls,\n                        getThreeContext: () => threeContextRef.current,\n                      };\n                      options.controls.onChange(change, sketchContext);\n                    }\n                  : undefined,\n              }\n            : undefined,\n        }\n      : null,\n    target: options.mount?.target ?? null,\n    containerClassName: options.mount?.className || options.mount?.containerClassName,\n    metadata: options.metadata,\n  });\n\n  return {\n    params: session.params,\n    controls: session.controls,\n    context: {\n      params: session.params,\n      controls: session.controls,\n      getThreeContext: () => (session.getInstance ? (session.getInstance() as ThreeContext | null) : threeContextRef.current),\n    },\n    threeContext: (session.getInstance ? (session.getInstance() as ThreeContext | null) : threeContextRef.current)!,\n    destroy: () => session.destroy(),\n    getInstance: () => (session.getInstance ? (session.getInstance() as ThreeContext | null) : threeContextRef.current),\n  };\n}\n\ninterface ThreeRendererSession extends HyperFrameRendererSession {}\n\nexport interface ThreeRendererOptions extends StartThreeSketchOptions {\n  threeContextRef?: { current: ThreeContext | null };\n}\n\nexport function createThreeRenderer(): HyperFrameRenderer<ThreeRendererOptions, ThreeRendererSession> {\n  return {\n    id: 'three',\n    async mount(context: HyperFrameRendererContext<ThreeRendererOptions>) {\n      const options = context.options;\n      const threeContextRef = options.threeContextRef || { current: null };\n\n      let mountResult: MountThreeResult | null = null;\n\n      const sketchContext: ThreeSketchContext = {\n        params: context.params,\n        controls: context.controls,\n        getThreeContext: () => (mountResult ? mountResult.getContext() : null),\n      };\n\n      const wrappedHandlers: ThreeLifecycleHandlers = {\n        setup: options.handlers.setup\n          ? (three, _ctx) => options.handlers.setup!(three, sketchContext)\n          : undefined,\n        animate: options.handlers.animate\n          ? (three, _ctx) => options.handlers.animate!(three, sketchContext)\n          : undefined,\n        resize: options.handlers.resize\n          ? (three, _ctx) => options.handlers.resize!(three, sketchContext)\n          : undefined,\n        dispose: options.handlers.dispose,\n      };\n\n      mountResult = mountThreeSketch(wrappedHandlers, {\n        ...(options.mount || {}),\n        target: context.container,\n        className: options.mount?.className || options.mount?.containerClassName || context.container.className,\n        containerClassName: options.mount?.containerClassName,\n        onReady: (readyContext) => {\n          threeContextRef.current = readyContext;\n          if (options.mount?.onReady) {\n            options.mount.onReady(readyContext);\n          }\n        },\n      });\n\n      threeContextRef.current = mountResult.getContext();\n\n      return {\n        destroy: () => {\n          mountResult?.destroy();\n        },\n        update: (message: unknown) => {\n          if (\n            message &&\n            typeof message === 'object' &&\n            (message as { type?: string }).type === 'handlers'\n          ) {\n            const payload = message as { handlers?: ThreeLifecycleHandlers };\n            const nextHandlers = payload.handlers;\n            if (nextHandlers) {\n              const mergedHandlers: ThreeLifecycleHandlers = {\n                setup: nextHandlers.setup\n                  ? (three, _ctx) => nextHandlers.setup!(three, sketchContext)\n                  : options.handlers.setup\n                    ? (three, _ctx) => options.handlers.setup!(three, sketchContext)\n                    : undefined,\n                animate: nextHandlers.animate\n                  ? (three, _ctx) => nextHandlers.animate!(three, sketchContext)\n                  : options.handlers.animate\n                    ? (three, _ctx) => options.handlers.animate!(three, sketchContext)\n                    : undefined,\n                resize: nextHandlers.resize\n                  ? (three, _ctx) => nextHandlers.resize!(three, sketchContext)\n                  : options.handlers.resize\n                    ? (three, _ctx) => options.handlers.resize!(three, sketchContext)\n                    : undefined,\n                dispose: nextHandlers.dispose || options.handlers.dispose,\n              };\n              mountResult?.setHandlers(mergedHandlers);\n            }\n          }\n        },\n        getInstance: () => (mountResult ? mountResult.getContext() : null),\n      };\n    },\n  };\n}\n",
    "import type { HyperFrameStartOptions, HyperFrameSession } from './types';\nimport { createHyperFrameRuntime, HyperFrameRuntime } from './runtime';\nimport { ParentStyleMirror, syncParentStyles } from './styleSync';\n\nimport {\n  mountP5Sketch,\n  runP5Sketch,\n  startP5SketchWithRuntime,\n  createP5Renderer,\n  type StartP5SketchOptions,\n  type RunP5SketchOptions,\n  type RunP5SketchResultWithInstance,\n  type P5RendererOptions,\n  type P5RendererSession,\n  type P5Instance,\n  type P5SketchContext,\n  type P5SketchHandlers,\n  type P5ControlPanelOptions,\n  type MountOptions,\n  type MountResult,\n} from './adapters/p5';\n\nimport {\n  mountThreeSketch,\n  runThreeSketch,\n  startThreeSketchWithRuntime,\n  createThreeRenderer,\n  type StartThreeSketchOptions,\n  type RunThreeSketchOptions,\n  type RunThreeSketchResult,\n  type ThreeRendererOptions,\n  type ThreeInstance,\n  type ThreeContext,\n  type ThreeSketchContext,\n  type ThreeLifecycleHandlers,\n  type ThreeControlPanelOptions,\n  type MountThreeOptions,\n  type MountThreeResult,\n} from './adapters/three';\n\nexport * from './types';\nexport { ParentStyleMirror, syncParentStyles };\nexport {\n  mountP5Sketch,\n  runP5Sketch,\n  startP5SketchWithRuntime,\n  createP5Renderer,\n};\nexport {\n  mountThreeSketch,\n  runThreeSketch,\n  startThreeSketchWithRuntime,\n  createThreeRenderer,\n};\n\nexport type {\n  StartP5SketchOptions,\n  RunP5SketchOptions,\n  RunP5SketchResultWithInstance,\n  P5RendererOptions,\n  P5RendererSession,\n  P5Instance,\n  P5SketchContext,\n  P5SketchHandlers,\n  P5ControlPanelOptions,\n  MountOptions,\n  MountResult,\n  StartThreeSketchOptions,\n  RunThreeSketchOptions,\n  RunThreeSketchResult,\n  ThreeRendererOptions,\n  ThreeInstance,\n  ThreeContext,\n  ThreeSketchContext,\n  ThreeLifecycleHandlers,\n  ThreeControlPanelOptions,\n  MountThreeOptions,\n  MountThreeResult,\n};\n\nexport { createHyperFrameRuntime, HyperFrameRuntime };\n\nconst defaultRuntime = createHyperFrameRuntime();\ndefaultRuntime.registerRenderer(createP5Renderer());\ndefaultRuntime.registerRenderer(createThreeRenderer());\n\nexport const hyperFrameRuntime = defaultRuntime;\n\nexport function startHyperFrame<TOptions = Record<string, unknown>>(options: HyperFrameStartOptions<TOptions>): Promise<HyperFrameSession> {\n  return defaultRuntime.start(options);\n}\n\nexport async function startP5Sketch(options: StartP5SketchOptions): Promise<RunP5SketchResultWithInstance> {\n  return startP5SketchWithRuntime(defaultRuntime, options);\n}\n\nexport async function startThreeSketch(options: StartThreeSketchOptions): Promise<RunThreeSketchResult> {\n  return startThreeSketchWithRuntime(defaultRuntime, options);\n}\n\nif (typeof window !== 'undefined') {\n  const globalWindow = window as unknown as {\n    hyperFrame?: {\n      start?: typeof startHyperFrame;\n      registerRenderer?: (renderer: any) => void;\n      syncParentStyles?: () => void;\n      p5?: {\n        mount?: typeof mountP5Sketch;\n        run?: typeof runP5Sketch;\n        start?: (options: StartP5SketchOptions) => Promise<RunP5SketchResultWithInstance>;\n      };\n      three?: {\n        mount?: typeof mountThreeSketch;\n        run?: typeof runThreeSketch;\n        start?: (options: StartThreeSketchOptions) => Promise<RunThreeSketchResult>;\n      };\n    };\n  };\n\n  const existing = globalWindow.hyperFrame || {};\n\n  globalWindow.hyperFrame = {\n    ...existing,\n    start: startHyperFrame,\n    registerRenderer: (renderer: any) => {\n      defaultRuntime.registerRenderer(renderer);\n    },\n    syncParentStyles: () => defaultRuntime.syncParentStyles(true),\n    p5: {\n      ...(existing.p5 || {}),\n      mount: mountP5Sketch,\n      run: runP5Sketch,\n      start: (options: StartP5SketchOptions) => startP5Sketch(options),\n    },\n    three: {\n      ...(existing.three || {}),\n      mount: mountThreeSketch,\n      run: runThreeSketch,\n      start: (options: StartThreeSketchOptions) => startThreeSketch(options),\n    },\n  };\n}\n"
  ],
  "mappings": "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",
  "debugId": "0919B84E270A19B064756E2164756E21",
  "names": []
}