var u=Object.defineProperty;var O=(q,K)=>{for(var G in K)u(q,G,{get:K[G],enumerable:!0,configurable:!0,set:(J)=>K[G]=()=>J})};var p={};O(p,{startThreeSketch:()=>c,startP5Sketch:()=>d,runThreeSketch:()=>H,runP5Sketch:()=>E,mountThreeSketch:()=>A,mountP5Sketch:()=>w});function g(){if(typeof window==="undefined")throw new Error("[hyper-frame] window is not available");let q=window.p5;if(typeof q!=="function")throw new Error("[hyper-frame] p5 constructor not found on window. Ensure p5 is loaded before hyper-frame.");return q}function w(q,K){if(typeof document==="undefined")throw new Error("mountP5Sketch cannot run outside a browser environment");var G=K||{},J={...q},Q=T(G),M=Q.element,$=Q.createdInternally,Y=null;function X(B){if(Y=B,b(B,J),G.onReady)G.onReady({p5:B,container:M})}var V=g(),Z=new V(X,M);if(!Y)Y=Z;function z(B){if(J={...B},Y)b(Y,J)}function D(){if(Y)Y.remove(),Y=null;if($)M.remove()}return{container:M,getInstance:function B(){return Y},setHandlers:z,destroy:D}}function b(q,K){for(let G in K)if(Object.prototype.hasOwnProperty.call(K,G)){let J=K[G];if(typeof J==="function")q[G]=function Q(...M){return J(q,...M)}}}function T(q){let K=q.containerClassName||"hypertool-sketch",G=q.target;if(G instanceof HTMLElement)return G.classList.add(K),{element:G,createdInternally:!1};if(typeof G==="string"&&G.trim().length>0){let Q=document.querySelector(G);if(Q)return Q.classList.add(K),{element:Q,createdInternally:!1};console.warn(`[hyper-frame] Could not find container for selector "${G}", creating one instead.`)}let J=document.createElement("div");return J.classList.add(K),document.body.appendChild(J),{element:J,createdInternally:!0}}function N(){if(typeof window==="undefined")throw new Error("[hyper-frame] window is not available");let q=window;if(!q.hypertoolControls)throw new Error("[hyper-frame] hypertool controls are not available on window");return q.hypertoolControls}function R(q,K,G){let J={};return Object.entries(q).forEach(function Q([M,$]){if(typeof $==="function")J[M]=function Y(X,...V){return G(X),$(X,K,...V)}}),J}function E(q){let K=N(),G=q.controls||{},J=K.createControlPanel(q.controlDefinitions,{title:G.title,position:G.position,expanded:G.expanded,container:G.container,onChange:(V,Z)=>{if(typeof G.onChange==="function"){let z={key:Z.key,value:Z.value,event:Z.event};G.onChange(z,Q)}}}),Q={params:J.params,controls:J,getP5Instance:function V(){return M}},M=null;function $(V){M=V}let Y=w(R(q.handlers,Q,$),q.mount||{});function X(V){Y.setHandlers(R(V,Q,$))}return{params:J.params,controls:J,context:Q,destroy(){Y.destroy()},setHandlers:X,getInstance(){return Y.getInstance()}}}function x(q){if(typeof requestAnimationFrame==="function")requestAnimationFrame(q);else setTimeout(q,16)}function _(q,K,G){return new Promise((J,Q)=>{let M=0;function $(){M+=1;try{if(q()){J();return}}catch(Y){}if(M>=K){Q(new Error(`[hyper-frame] Timed out waiting for ${G}`));return}x($)}$()})}var C="https://cdn.jsdelivr.net/npm/p5@1.6.0/lib/p5.min.js",m='script[data-hypertool="p5"]';function h(q,K){if(typeof window==="undefined")return Promise.reject(new Error("[hyper-frame] window is not available"));if(typeof window.p5==="function")return Promise.resolve();return new Promise((G,J)=>{let Q=!1;function M(){if(Q)return;Q=!0,G()}function $(Z){if(Q)return;Q=!0,J(Z)}_(()=>typeof window.p5==="function",K,"p5 constructor").then(M).catch($);function Y(){$(new Error(`[hyper-frame] Failed to load p5 script from ${q}`))}let X=document.querySelector(m);if(X){X.addEventListener("error",Y,{once:!0});return}let V=document.createElement("script");V.src=q,V.async=!0,V.dataset.hypertool="p5",V.addEventListener("error",Y,{once:!0}),document.head.appendChild(V)})}function I(q){return _(function K(){try{return N(),!0}catch(G){return!1}},q,"hypertool controls")}async function d(q){if(typeof window==="undefined")throw new Error("[hyper-frame] window is not available");let K=q.readiness||{},G=q.p5||{},J=typeof K.maxAttempts==="number"?K.maxAttempts:600,Q=typeof G.maxAttempts==="number"?G.maxAttempts:J,M=typeof G.url==="string"&&G.url.trim().length>0?G.url:C;return await h(M,Q),await I(J),E({controlDefinitions:q.controlDefinitions,handlers:q.handlers,controls:q.controls,mount:q.mount})}function y(){if(typeof window==="undefined")throw new Error("[hyper-frame] window is not available");let q=window.THREE;if(typeof q!=="object")throw new Error("[hyper-frame] THREE not found on window. Make sure to import and expose Three.js on window in your sketch.");return q}function A(q,K){if(typeof document==="undefined")throw new Error("mountThreeSketch cannot run outside a browser environment");let G=K||{},J=y(),Q=T({target:G.target,containerClassName:G.containerClassName||"hypertool-three-sketch"}),M=Q.element,$=Q.createdInternally,Y=new J.Scene,X=G.camera||{},V=X.type||"perspective",Z;if(V==="perspective")Z=new J.PerspectiveCamera(X.fov||75,window.innerWidth/window.innerHeight,X.near||0.1,X.far||1000);else{let W=window.innerWidth/window.innerHeight;Z=new J.OrthographicCamera(-W,W,1,-1,X.near||0.1,X.far||1000)}if(X.position)Z.position.set(...X.position);else Z.position.z=5;let z=G.renderer||{},D=new J.WebGLRenderer({antialias:z.antialias!==!1,alpha:z.alpha||!1,preserveDrawingBuffer:z.preserveDrawingBuffer||!1});D.setSize(M.clientWidth||window.innerWidth,M.clientHeight||window.innerHeight),D.setPixelRatio(window.devicePixelRatio),M.appendChild(D.domElement);let B=null;if(G.orbitControls){let W=window.OrbitControls||J.OrbitControls;if(W)B=new W(Z,D.domElement);else console.warn("[hyper-frame] OrbitControls not found. Make sure to import and expose it on window.")}let L={scene:Y,camera:Z,renderer:D,controls:B},U=null,F=!1;function j(){let W=M.clientWidth||window.innerWidth,v=M.clientHeight||window.innerHeight;if(Z.aspect=W/v,Z.updateProjectionMatrix(),D.setSize(W,v),q.resize)q.resize(L,{})}window.addEventListener("resize",j);function f(){if(!F)return;if(U=requestAnimationFrame(f),B)B.update();if(q.animate)q.animate(L,{});D.render(Y,Z)}if(q.setup)q.setup(L,{});if(G.onReady)G.onReady(L);function P(){if(!F)F=!0,f()}function S(){if(F=!1,U!==null)cancelAnimationFrame(U),U=null}function k(){if(S(),window.removeEventListener("resize",j),q.dispose)q.dispose();if(B)B.dispose();if(D.dispose(),M.removeChild(D.domElement),$)M.remove()}return P(),{container:M,getContext:()=>L,destroy:k,startAnimation:P,stopAnimation:S}}function H(q){let K=N(),G=q.controls||{},J={params:{},controls:null,getThreeContext:()=>Y},Q=K.createControlPanel(q.controlDefinitions,{title:G.title,position:G.position,expanded:G.expanded,container:G.container,onChange:(X,V)=>{if(J.params=X,typeof G.onChange==="function"){let Z={key:V.key,value:V.value,event:V.event};G.onChange(Z,J)}}});J.params=Q.params,J.controls=Q;let M={};if(q.handlers.setup){let X=q.handlers.setup;M.setup=(V,Z)=>{X(V,J)}}if(q.handlers.animate){let X=q.handlers.animate;M.animate=(V,Z)=>{X(V,J)}}if(q.handlers.resize){let X=q.handlers.resize;M.resize=(V,Z)=>{X(V,J)}}if(q.handlers.dispose)M.dispose=q.handlers.dispose;let $=A(M,q.mount||{}),Y=$.getContext();return{params:Q.params,controls:Q,context:J,threeContext:Y,destroy(){$.destroy()},getInstance(){return $.getContext()}}}function l(q){return _(function K(){try{return y(),!0}catch(G){return!1}},q,"THREE constructor")}async function c(q){if(typeof window==="undefined")throw new Error("[hyper-frame] window is not available");let K=q.readiness||{},G=typeof K.maxAttempts==="number"?K.maxAttempts:600;return await l(G),await I(G),H({controlDefinitions:q.controlDefinitions,handlers:q.handlers,controls:q.controls,mount:q.mount})}export{c as startThreeSketch,d as startP5Sketch,H as runThreeSketch,E as runP5Sketch,A as mountThreeSketch,w as mountP5Sketch};

//# debugId=65FD223FA1C2675264756E2164756E21
