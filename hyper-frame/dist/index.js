function j(){if(typeof window>"u")throw Error("[hyper-frame] window is not available");let q=window.p5;if(typeof q!=="function")throw Error("[hyper-frame] p5 constructor not found on window. Ensure p5 is loaded before hyper-frame.");return q}function F(q,K){if(typeof document>"u")throw Error("mountP5Sketch cannot run outside a browser environment");var z=K||{},G={...q},J=N(z),M=J.element,X=J.createdInternally,Q=null;function Y($){if(Q=$,D($,G),z.onReady)z.onReady({p5:$,container:M})}var V=j(),Z=new V(Y,M);if(!Q)Q=Z;function B($){if(G={...$},Q)D(Q,G)}function U(){if(Q)Q.remove(),Q=null;if(X)M.remove()}return{container:M,getInstance:function(){return Q},setHandlers:B,destroy:U}}function D(q,K){for(let z in K)if(Object.prototype.hasOwnProperty.call(K,z)){let G=K[z];if(typeof G==="function")q[z]=function(...M){return G(q,...M)}}}function N(q){let K=q.containerClassName||"hypertool-sketch",z=q.target;if(z instanceof HTMLElement)return z.classList.add(K),{element:z,createdInternally:!1};if(typeof z==="string"&&z.trim().length>0){let J=document.querySelector(z);if(J)return J.classList.add(K),{element:J,createdInternally:!1};console.warn(`[hyper-frame] Could not find container for selector "${z}", creating one instead.`)}let G=document.createElement("div");return G.classList.add(K),document.body.appendChild(G),{element:G,createdInternally:!0}}function L(){if(typeof window>"u")throw Error("[hyper-frame] window is not available");let q=window;if(!q.hypertoolControls)throw Error("[hyper-frame] hypertool controls are not available on window");return q.hypertoolControls}function W(q,K,z){let G={};return Object.entries(q).forEach(function([M,X]){if(typeof X==="function")G[M]=function(Y,...V){return z(Y),X(Y,K,...V)}}),G}function R(q){let K=L(),z=q.controls||{},G=K.createControlPanel(q.controlDefinitions,{title:z.title,position:z.position,expanded:z.expanded,container:z.container,onChange:(V,Z)=>{if(typeof z.onChange==="function"){let B={key:Z.key,value:Z.value,event:Z.event};z.onChange(B,J)}}}),J={params:G.params,controls:G,getP5Instance:function(){return M}},M=null;function X(V){M=V}let Q=F(W(q.handlers,J,X),q.mount||{});function Y(V){Q.setHandlers(W(V,J,X))}return{params:G.params,controls:G,context:J,destroy(){Q.destroy()},setHandlers:Y,getInstance(){return Q.getInstance()}}}function E(q){if(typeof requestAnimationFrame==="function")requestAnimationFrame(q);else setTimeout(q,16)}function T(q,K,z){return new Promise((G,J)=>{let M=0;function X(){M+=1;try{if(q()){G();return}}catch(Q){}if(M>=K){J(Error(`[hyper-frame] Timed out waiting for ${z}`));return}E(X)}X()})}var _="https://cdn.jsdelivr.net/npm/p5@1.6.0/lib/p5.min.js",f='script[data-hypertool="p5"]';function S(q,K){if(typeof window>"u")return Promise.reject(Error("[hyper-frame] window is not available"));if(typeof window.p5==="function")return Promise.resolve();return new Promise((z,G)=>{let J=!1;function M(){if(J)return;J=!0,z()}function X(Z){if(J)return;J=!0,G(Z)}T(()=>typeof window.p5==="function",K,"p5 constructor").then(M).catch(X);function Q(){X(Error(`[hyper-frame] Failed to load p5 script from ${q}`))}let Y=document.querySelector(f);if(Y){Y.addEventListener("error",Q,{once:!0});return}let V=document.createElement("script");V.src=q,V.async=!0,V.dataset.hypertool="p5",V.addEventListener("error",Q,{once:!0}),document.head.appendChild(V)})}function b(q){return T(function(){try{return L(),!0}catch(z){return!1}},q,"hypertool controls")}async function w(q){if(typeof window>"u")throw Error("[hyper-frame] window is not available");let K=q.readiness||{},z=q.p5||{},G=typeof K.maxAttempts==="number"?K.maxAttempts:600,J=typeof z.maxAttempts==="number"?z.maxAttempts:G,M=typeof z.url==="string"&&z.url.trim().length>0?z.url:_;return await S(M,J),await b(G),R({controlDefinitions:q.controlDefinitions,handlers:q.handlers,controls:q.controls,mount:q.mount})}export{w as startP5Sketch,R as runP5Sketch,F as mountP5Sketch};

//# debugId=416BD1C1972D441464756E2164756E21
