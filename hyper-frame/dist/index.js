function y(){if(typeof window>"u")throw Error("[hyper-frame] window is not available");let q=window.p5;if(typeof q!=="function")throw Error("[hyper-frame] p5 constructor not found on window. Ensure p5 is loaded before hyper-frame.");return q}function A(q,Q){if(typeof document>"u")throw Error("mountP5Sketch cannot run outside a browser environment");var G=Q||{},J={...q},M=w(G),K=M.element,$=M.createdInternally,Y=null;function X(B){if(Y=B,b(B,J),G.onReady)G.onReady({p5:B,container:K})}var V=y(),Z=new V(X,K);if(!Y)Y=Z;function z(B){if(J={...B},Y)b(Y,J)}function D(){if(Y)Y.remove(),Y=null;if($)K.remove()}return{container:K,getInstance:function(){return Y},setHandlers:z,destroy:D}}function b(q,Q){for(let G in Q)if(Object.prototype.hasOwnProperty.call(Q,G)){let J=Q[G];if(typeof J==="function")q[G]=function(...K){return J(q,...K)}}}function w(q){let Q=q.containerClassName||"hypertool-sketch",G=q.target;if(G instanceof HTMLElement)return G.classList.add(Q),{element:G,createdInternally:!1};if(typeof G==="string"&&G.trim().length>0){let M=document.querySelector(G);if(M)return M.classList.add(Q),{element:M,createdInternally:!1};console.warn(`[hyper-frame] Could not find container for selector "${G}", creating one instead.`)}let J=document.createElement("div");return J.classList.add(Q),J.classList.add("hyper-frame-container"),document.body.appendChild(J),{element:J,createdInternally:!0}}function N(){if(typeof window>"u")throw Error("[hyper-frame] window is not available");let q=window;if(!q.hypertoolControls)throw Error("[hyper-frame] hypertool controls are not available on window");return q.hypertoolControls}function R(q,Q,G){let J={};return Object.entries(q).forEach(function([K,$]){if(typeof $==="function")J[K]=function(X,...V){return G(X),$(X,Q,...V)}}),J}function H(q){let Q=N(),G=q.controls||{},J=Q.createControlPanel(q.controlDefinitions,{title:G.title,position:G.position,expanded:G.expanded,container:G.container,onChange:(V,Z)=>{if(typeof G.onChange==="function"){let z={key:Z.key,value:Z.value,event:Z.event};G.onChange(z,M)}}}),M={params:J.params,controls:J,getP5Instance:function(){return K}},K=null;function $(V){K=V}let Y=A(R(q.handlers,M,$),q.mount||{});function X(V){Y.setHandlers(R(V,M,$))}return{params:J.params,controls:J,context:M,destroy(){Y.destroy()},setHandlers:X,getInstance(){return Y.getInstance()}}}function k(q){if(typeof requestAnimationFrame==="function")requestAnimationFrame(q);else setTimeout(q,16)}function _(q,Q,G){return new Promise((J,M)=>{let K=0;function $(){K+=1;try{if(q()){J();return}}catch(Y){}if(K>=Q){M(Error(`[hyper-frame] Timed out waiting for ${G}`));return}k($)}$()})}var u="https://cdn.jsdelivr.net/npm/p5@1.6.0/lib/p5.min.js",O='script[data-hypertool="p5"]';function g(q,Q){if(typeof window>"u")return Promise.reject(Error("[hyper-frame] window is not available"));if(typeof window.p5==="function")return Promise.resolve();return new Promise((G,J)=>{let M=!1;function K(){if(M)return;M=!0,G()}function $(Z){if(M)return;M=!0,J(Z)}_(()=>typeof window.p5==="function",Q,"p5 constructor").then(K).catch($);function Y(){$(Error(`[hyper-frame] Failed to load p5 script from ${q}`))}let X=document.querySelector(O);if(X){X.addEventListener("error",Y,{once:!0});return}let V=document.createElement("script");V.src=q,V.async=!0,V.dataset.hypertool="p5",V.addEventListener("error",Y,{once:!0}),document.head.appendChild(V)})}function T(q){return _(function(){try{return N(),!0}catch(G){return!1}},q,"hypertool controls")}async function h(q){if(typeof window>"u")throw Error("[hyper-frame] window is not available");let Q=q.readiness||{},G=q.p5||{},J=typeof Q.maxAttempts==="number"?Q.maxAttempts:600,M=typeof G.maxAttempts==="number"?G.maxAttempts:J,K=typeof G.url==="string"&&G.url.trim().length>0?G.url:u;return await g(K,M),await T(J),H({controlDefinitions:q.controlDefinitions,handlers:q.handlers,controls:q.controls,mount:q.mount})}function E(){if(typeof window>"u")throw Error("[hyper-frame] window is not available");let q=window.THREE;if(typeof q!=="object")throw Error("[hyper-frame] THREE not found on window. Make sure to import and expose Three.js on window in your sketch.");return q}function x(q,Q){if(typeof document>"u")throw Error("mountThreeSketch cannot run outside a browser environment");let G=Q||{},J=E(),M=w({target:G.target,containerClassName:G.containerClassName||"hypertool-three-sketch"}),K=M.element,$=M.createdInternally,Y=new J.Scene,X=G.camera||{},V=X.type||"perspective",Z;if(V==="perspective")Z=new J.PerspectiveCamera(X.fov||75,window.innerWidth/window.innerHeight,X.near||0.1,X.far||1000);else{let W=window.innerWidth/window.innerHeight;Z=new J.OrthographicCamera(-W,W,1,-1,X.near||0.1,X.far||1000)}if(X.position)Z.position.set(...X.position);else Z.position.z=5;let z=G.renderer||{},D=new J.WebGLRenderer({antialias:z.antialias!==!1,alpha:z.alpha||!1,preserveDrawingBuffer:z.preserveDrawingBuffer||!1});D.setSize(K.clientWidth||window.innerWidth,K.clientHeight||window.innerHeight),D.setPixelRatio(window.devicePixelRatio),K.appendChild(D.domElement);let B=null;if(G.orbitControls){let W=window.OrbitControls||J.OrbitControls;if(W)B=new W(Z,D.domElement);else console.warn("[hyper-frame] OrbitControls not found. Make sure to import and expose it on window.")}let L={scene:Y,camera:Z,renderer:D,controls:B},U=null,F=!1;function j(){let W=K.clientWidth||window.innerWidth,v=K.clientHeight||window.innerHeight;if(Z.aspect=W/v,Z.updateProjectionMatrix(),D.setSize(W,v),q.resize)q.resize(L,{})}window.addEventListener("resize",j);function f(){if(!F)return;if(U=requestAnimationFrame(f),B)B.update();if(q.animate)q.animate(L,{});D.render(Y,Z)}if(q.setup)q.setup(L,{});if(G.onReady)G.onReady(L);function P(){if(!F)F=!0,f()}function S(){if(F=!1,U!==null)cancelAnimationFrame(U),U=null}function I(){if(S(),window.removeEventListener("resize",j),q.dispose)q.dispose();if(B)B.dispose();if(D.dispose(),K.removeChild(D.domElement),$)K.remove()}return P(),{container:K,getContext:()=>L,destroy:I,startAnimation:P,stopAnimation:S}}function C(q){let Q=N(),G=q.controls||{},J={params:{},controls:null,getThreeContext:()=>Y},M=Q.createControlPanel(q.controlDefinitions,{title:G.title,position:G.position,expanded:G.expanded,container:G.container,onChange:(X,V)=>{if(J.params=X,typeof G.onChange==="function"){let Z={key:V.key,value:V.value,event:V.event};G.onChange(Z,J)}}});J.params=M.params,J.controls=M;let K={};if(q.handlers.setup){let X=q.handlers.setup;K.setup=(V,Z)=>{X(V,J)}}if(q.handlers.animate){let X=q.handlers.animate;K.animate=(V,Z)=>{X(V,J)}}if(q.handlers.resize){let X=q.handlers.resize;K.resize=(V,Z)=>{X(V,J)}}if(q.handlers.dispose)K.dispose=q.handlers.dispose;let $=x(K,q.mount||{}),Y=$.getContext();return{params:M.params,controls:M,context:J,threeContext:Y,destroy(){$.destroy()},getInstance(){return $.getContext()}}}function m(q){return _(function(){try{return E(),!0}catch(G){return!1}},q,"THREE constructor")}async function d(q){if(typeof window>"u")throw Error("[hyper-frame] window is not available");let Q=q.readiness||{},G=typeof Q.maxAttempts==="number"?Q.maxAttempts:600;return await m(G),await T(G),C({controlDefinitions:q.controlDefinitions,handlers:q.handlers,controls:q.controls,mount:q.mount})}export{d as startThreeSketch,h as startP5Sketch,C as runThreeSketch,H as runP5Sketch,x as mountThreeSketch,A as mountP5Sketch};

//# debugId=76B38852BF03781564756E2164756E21
